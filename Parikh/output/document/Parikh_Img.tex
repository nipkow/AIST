%
\begin{isabellebody}%
\setisabellecontext{Parikh{\isacharunderscore}{\kern0pt}Img}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Parikh images%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Parikh{\isacharunderscore}{\kern0pt}Img\isanewline
\ \ \isakeywordTWO{imports}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}Reg{\isacharunderscore}{\kern0pt}Lang{\isacharunderscore}{\kern0pt}Exp{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Multiset{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Definition and basic lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The Parikh vector of a finite word describes how often each symbol of the alphabet occurs in the word.
We represent parikh vectors by multisets. The Parikh image of a language \isa{L}, denoted by \isa{{\isasymPsi}\ L},
is then the set of Parikh vectors of all words in the language.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}vec\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isasymequiv}\ mset{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ multiset\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymPsi}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}{\isasymPsi}\ L\ {\isasymequiv}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbackquote}{\kern0pt}\ L{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isasymunion}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymunion}\ {\isasymPsi}\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}L\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymUnion}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}L\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Star{\isacharunderscore}{\kern0pt}pow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}m\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isasymexists}n{\isachardot}{\kern0pt}\ m\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isachardot}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{2}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{1}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ add{\isachardot}{\kern0pt}commute\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Monotonicity properties%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ C{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}{\isasymPsi}\ B\ {\isasymsubseteq}\ {\isasymPsi}\ D{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Orderings{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}A\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}B\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}upd{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ A\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ B\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ v\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}A\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}B\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ A\ i{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ B\ i{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ rule{\isacharcolon}{\kern0pt}\ rlexp{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharprime}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ vars{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ SUP{\isacharunderscore}{\kern0pt}mono{\isacharprime}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$\Psi \; (A \cup B)^* = \Psi \; A^* B^*$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This property is claimed by Pilling in \cite{Pilling} and will be needed later.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymand}\ parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isasymunion}\ B\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{1}}{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}\ {\isasymand}\isanewline
\ \ \ \ \ \ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ i{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isasymle}\ n\ {\isasymand}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ Suc\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Suc\ i\ {\isasymle}\ Suc\ n{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Suc{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}le\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ i{\isacharunderscore}{\kern0pt}intro\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}n{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i{\isasymle}n{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ {\isachardoublequoteopen}i{\isasymle}n\ {\isasymand}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ star\ A\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ j\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordTWO{and}\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i{\isacharplus}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ lang{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}add\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$\Psi \; (E^* F)^* = \Psi \; \left(\{\varepsilon\} \cup E^* F^* F\right)$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This property (where $\varepsilon$ denotes the empty word) is claimed by
Pilling as well \cite{Pilling}; we will use it later.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ conc{\isacharunderscore}{\kern0pt}assoc\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}idemp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}F\ {\isasymsubseteq}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ star{\isacharunderscore}{\kern0pt}def\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}ord{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{using}\isamarkupfalse%
\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}comm\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ le{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}iff\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left\ sup{\isachardot}{\kern0pt}cobounded{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{A homogeneous-like property for regular functions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ x\ {\isacharequal}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Var\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ False\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}star{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Now we can prove the desired homogeneous-like property which will become useful later:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}L\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}L\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}f{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}of\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Extension of Arden's lemma to Parikh images%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isachardot}{\kern0pt}orderE\ sup{\isachardot}{\kern0pt}orderI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}prems\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}UNION{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ X{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Equivalence class of languages with identical Parikh image%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
For a given language \isa{L}, we define the equivalence class of all languages with identical Parikh
image:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ lang\ set{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ L\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}L{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymPsi}\ L{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ L{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Union{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ a\ \isakeywordTWO{where}\ a{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ a\ {\isasymin}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ L\ \isakeywordTWO{where}\ L{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ L\ {\isasymand}\ L\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ L\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}intro\ L{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ subseteq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}subseteq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ a\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A\ \isakeywordONE{have}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymin}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}b{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ b\ \isakeywordTWO{where}\ b{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/studium/semester_7/semantik/homeworks/AIST/Parikh/Parikh_Img.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%32=7%:%
%:%46=10%:%
%:%58=12%:%
%:%59=13%:%
%:%60=14%:%
%:%62=16%:%
%:%63=16%:%
%:%64=17%:%
%:%65=18%:%
%:%66=19%:%
%:%67=19%:%
%:%68=20%:%
%:%69=21%:%
%:%70=22%:%
%:%71=22%:%
%:%74=23%:%
%:%78=23%:%
%:%79=23%:%
%:%84=23%:%
%:%87=24%:%
%:%88=25%:%
%:%89=25%:%
%:%92=26%:%
%:%96=26%:%
%:%97=26%:%
%:%102=26%:%
%:%105=27%:%
%:%106=28%:%
%:%107=28%:%
%:%114=29%:%
%:%115=29%:%
%:%116=30%:%
%:%117=30%:%
%:%118=31%:%
%:%119=31%:%
%:%120=31%:%
%:%121=31%:%
%:%122=32%:%
%:%123=32%:%
%:%124=32%:%
%:%125=32%:%
%:%126=32%:%
%:%127=33%:%
%:%133=33%:%
%:%136=34%:%
%:%137=35%:%
%:%138=35%:%
%:%141=36%:%
%:%145=36%:%
%:%146=36%:%
%:%147=36%:%
%:%152=36%:%
%:%155=37%:%
%:%156=38%:%
%:%157=38%:%
%:%164=39%:%
%:%165=39%:%
%:%166=40%:%
%:%167=40%:%
%:%168=41%:%
%:%169=42%:%
%:%170=42%:%
%:%171=42%:%
%:%172=43%:%
%:%173=43%:%
%:%174=43%:%
%:%175=44%:%
%:%176=44%:%
%:%177=44%:%
%:%178=45%:%
%:%193=48%:%
%:%203=50%:%
%:%204=50%:%
%:%207=51%:%
%:%211=51%:%
%:%212=51%:%
%:%213=51%:%
%:%218=51%:%
%:%221=52%:%
%:%222=53%:%
%:%223=53%:%
%:%226=54%:%
%:%230=54%:%
%:%231=54%:%
%:%232=54%:%
%:%237=54%:%
%:%240=55%:%
%:%241=56%:%
%:%242=56%:%
%:%245=57%:%
%:%249=57%:%
%:%250=57%:%
%:%255=57%:%
%:%258=58%:%
%:%259=59%:%
%:%260=59%:%
%:%263=60%:%
%:%267=60%:%
%:%268=60%:%
%:%273=60%:%
%:%276=61%:%
%:%277=62%:%
%:%278=62%:%
%:%279=63%:%
%:%280=64%:%
%:%281=65%:%
%:%284=66%:%
%:%288=66%:%
%:%289=66%:%
%:%290=66%:%
%:%295=66%:%
%:%298=67%:%
%:%299=68%:%
%:%300=68%:%
%:%303=69%:%
%:%307=69%:%
%:%308=69%:%
%:%313=69%:%
%:%316=70%:%
%:%317=71%:%
%:%318=71%:%
%:%321=72%:%
%:%325=72%:%
%:%326=72%:%
%:%331=72%:%
%:%334=73%:%
%:%335=74%:%
%:%336=74%:%
%:%339=75%:%
%:%343=75%:%
%:%344=75%:%
%:%349=75%:%
%:%352=76%:%
%:%353=77%:%
%:%354=78%:%
%:%355=78%:%
%:%356=79%:%
%:%357=80%:%
%:%364=81%:%
%:%365=81%:%
%:%366=82%:%
%:%367=82%:%
%:%368=83%:%
%:%369=83%:%
%:%370=84%:%
%:%371=84%:%
%:%372=84%:%
%:%373=84%:%
%:%374=84%:%
%:%375=85%:%
%:%376=85%:%
%:%377=85%:%
%:%378=85%:%
%:%379=85%:%
%:%380=86%:%
%:%381=86%:%
%:%382=86%:%
%:%383=86%:%
%:%384=86%:%
%:%385=86%:%
%:%386=87%:%
%:%387=87%:%
%:%388=87%:%
%:%389=87%:%
%:%390=87%:%
%:%391=88%:%
%:%392=88%:%
%:%393=88%:%
%:%394=88%:%
%:%395=88%:%
%:%396=88%:%
%:%397=89%:%
%:%403=89%:%
%:%406=90%:%
%:%407=91%:%
%:%408=91%:%
%:%409=92%:%
%:%410=93%:%
%:%413=94%:%
%:%417=94%:%
%:%418=94%:%
%:%419=94%:%
%:%424=94%:%
%:%427=95%:%
%:%428=96%:%
%:%429=97%:%
%:%430=97%:%
%:%431=98%:%
%:%432=99%:%
%:%439=100%:%
%:%440=100%:%
%:%441=100%:%
%:%442=101%:%
%:%443=101%:%
%:%444=102%:%
%:%445=102%:%
%:%446=102%:%
%:%447=103%:%
%:%448=104%:%
%:%449=104%:%
%:%450=104%:%
%:%451=105%:%
%:%452=105%:%
%:%453=105%:%
%:%454=105%:%
%:%455=106%:%
%:%456=106%:%
%:%457=107%:%
%:%458=107%:%
%:%459=108%:%
%:%460=108%:%
%:%461=108%:%
%:%462=109%:%
%:%463=109%:%
%:%464=109%:%
%:%465=110%:%
%:%466=110%:%
%:%467=110%:%
%:%468=110%:%
%:%469=111%:%
%:%470=111%:%
%:%475=111%:%
%:%478=112%:%
%:%479=113%:%
%:%480=113%:%
%:%481=114%:%
%:%482=115%:%
%:%485=116%:%
%:%489=116%:%
%:%490=116%:%
%:%491=116%:%
%:%496=116%:%
%:%499=117%:%
%:%500=118%:%
%:%501=118%:%
%:%502=119%:%
%:%503=120%:%
%:%506=121%:%
%:%510=121%:%
%:%511=121%:%
%:%512=121%:%
%:%517=121%:%
%:%520=122%:%
%:%521=123%:%
%:%522=124%:%
%:%523=124%:%
%:%524=125%:%
%:%525=126%:%
%:%532=127%:%
%:%533=127%:%
%:%534=127%:%
%:%535=128%:%
%:%536=128%:%
%:%537=129%:%
%:%538=129%:%
%:%539=129%:%
%:%540=130%:%
%:%541=130%:%
%:%542=130%:%
%:%543=131%:%
%:%544=131%:%
%:%545=131%:%
%:%546=131%:%
%:%547=132%:%
%:%548=132%:%
%:%553=132%:%
%:%556=133%:%
%:%557=134%:%
%:%558=134%:%
%:%559=135%:%
%:%560=136%:%
%:%563=137%:%
%:%567=137%:%
%:%568=137%:%
%:%569=137%:%
%:%583=141%:%
%:%595=143%:%
%:%597=145%:%
%:%598=145%:%
%:%599=146%:%
%:%600=147%:%
%:%607=148%:%
%:%608=148%:%
%:%609=148%:%
%:%610=149%:%
%:%611=149%:%
%:%612=150%:%
%:%613=150%:%
%:%614=150%:%
%:%615=150%:%
%:%616=151%:%
%:%617=151%:%
%:%618=152%:%
%:%619=152%:%
%:%620=153%:%
%:%621=153%:%
%:%622=153%:%
%:%623=154%:%
%:%624=154%:%
%:%625=154%:%
%:%626=155%:%
%:%627=155%:%
%:%628=155%:%
%:%629=155%:%
%:%630=156%:%
%:%631=156%:%
%:%632=157%:%
%:%633=157%:%
%:%634=157%:%
%:%635=157%:%
%:%636=157%:%
%:%637=158%:%
%:%638=158%:%
%:%639=158%:%
%:%640=158%:%
%:%641=159%:%
%:%642=159%:%
%:%643=159%:%
%:%644=160%:%
%:%645=160%:%
%:%646=160%:%
%:%647=161%:%
%:%648=161%:%
%:%649=161%:%
%:%650=161%:%
%:%651=162%:%
%:%652=162%:%
%:%653=162%:%
%:%654=163%:%
%:%655=163%:%
%:%656=164%:%
%:%657=164%:%
%:%658=164%:%
%:%659=165%:%
%:%660=165%:%
%:%661=166%:%
%:%662=166%:%
%:%663=167%:%
%:%664=167%:%
%:%665=167%:%
%:%666=168%:%
%:%667=168%:%
%:%668=169%:%
%:%669=169%:%
%:%670=169%:%
%:%671=170%:%
%:%672=170%:%
%:%673=170%:%
%:%674=171%:%
%:%675=171%:%
%:%676=171%:%
%:%677=171%:%
%:%678=172%:%
%:%679=172%:%
%:%680=173%:%
%:%681=173%:%
%:%682=174%:%
%:%683=174%:%
%:%684=174%:%
%:%685=174%:%
%:%686=175%:%
%:%687=175%:%
%:%688=175%:%
%:%689=176%:%
%:%690=176%:%
%:%691=176%:%
%:%692=177%:%
%:%693=177%:%
%:%694=177%:%
%:%695=178%:%
%:%696=178%:%
%:%697=179%:%
%:%698=179%:%
%:%699=180%:%
%:%700=180%:%
%:%701=180%:%
%:%702=180%:%
%:%703=181%:%
%:%704=181%:%
%:%705=182%:%
%:%706=182%:%
%:%707=182%:%
%:%708=182%:%
%:%709=182%:%
%:%710=183%:%
%:%716=183%:%
%:%719=184%:%
%:%720=185%:%
%:%721=185%:%
%:%722=186%:%
%:%723=187%:%
%:%730=188%:%
%:%731=188%:%
%:%732=189%:%
%:%733=189%:%
%:%734=189%:%
%:%735=190%:%
%:%736=190%:%
%:%737=190%:%
%:%738=190%:%
%:%739=191%:%
%:%740=191%:%
%:%741=191%:%
%:%742=191%:%
%:%743=192%:%
%:%744=192%:%
%:%745=192%:%
%:%746=193%:%
%:%747=193%:%
%:%748=193%:%
%:%749=194%:%
%:%750=194%:%
%:%751=194%:%
%:%752=194%:%
%:%753=194%:%
%:%754=195%:%
%:%755=195%:%
%:%756=195%:%
%:%757=195%:%
%:%758=196%:%
%:%759=196%:%
%:%760=196%:%
%:%761=197%:%
%:%762=197%:%
%:%763=197%:%
%:%764=198%:%
%:%765=198%:%
%:%766=198%:%
%:%767=198%:%
%:%768=199%:%
%:%769=199%:%
%:%770=199%:%
%:%771=199%:%
%:%772=200%:%
%:%773=200%:%
%:%774=200%:%
%:%775=200%:%
%:%776=201%:%
%:%777=201%:%
%:%778=201%:%
%:%779=201%:%
%:%780=201%:%
%:%781=202%:%
%:%787=202%:%
%:%790=203%:%
%:%791=204%:%
%:%792=204%:%
%:%793=205%:%
%:%794=206%:%
%:%801=207%:%
%:%802=207%:%
%:%803=208%:%
%:%804=208%:%
%:%805=208%:%
%:%806=209%:%
%:%807=209%:%
%:%808=209%:%
%:%809=210%:%
%:%810=210%:%
%:%811=210%:%
%:%812=210%:%
%:%813=211%:%
%:%814=211%:%
%:%815=211%:%
%:%816=211%:%
%:%817=211%:%
%:%818=212%:%
%:%819=212%:%
%:%820=212%:%
%:%821=212%:%
%:%822=212%:%
%:%823=213%:%
%:%824=213%:%
%:%825=213%:%
%:%826=213%:%
%:%827=213%:%
%:%828=214%:%
%:%829=214%:%
%:%830=214%:%
%:%831=214%:%
%:%832=214%:%
%:%833=215%:%
%:%834=215%:%
%:%835=215%:%
%:%836=215%:%
%:%837=215%:%
%:%838=216%:%
%:%844=216%:%
%:%847=217%:%
%:%848=218%:%
%:%849=219%:%
%:%850=219%:%
%:%857=220%:%
%:%858=220%:%
%:%859=221%:%
%:%860=221%:%
%:%861=221%:%
%:%862=221%:%
%:%863=222%:%
%:%864=222%:%
%:%865=222%:%
%:%866=222%:%
%:%867=223%:%
%:%882=227%:%
%:%894=229%:%
%:%895=230%:%
%:%897=233%:%
%:%898=233%:%
%:%905=234%:%
%:%906=234%:%
%:%907=235%:%
%:%908=235%:%
%:%909=236%:%
%:%910=236%:%
%:%911=236%:%
%:%912=237%:%
%:%913=237%:%
%:%914=237%:%
%:%915=238%:%
%:%916=238%:%
%:%917=238%:%
%:%918=239%:%
%:%919=239%:%
%:%920=240%:%
%:%921=240%:%
%:%922=240%:%
%:%923=240%:%
%:%924=241%:%
%:%925=241%:%
%:%930=241%:%
%:%933=242%:%
%:%934=243%:%
%:%935=243%:%
%:%942=244%:%
%:%943=244%:%
%:%944=245%:%
%:%945=245%:%
%:%946=246%:%
%:%947=246%:%
%:%948=247%:%
%:%949=247%:%
%:%950=247%:%
%:%951=247%:%
%:%952=247%:%
%:%953=248%:%
%:%954=248%:%
%:%955=248%:%
%:%956=248%:%
%:%957=249%:%
%:%958=249%:%
%:%959=249%:%
%:%960=249%:%
%:%961=250%:%
%:%962=250%:%
%:%963=250%:%
%:%964=251%:%
%:%965=251%:%
%:%966=251%:%
%:%967=252%:%
%:%968=252%:%
%:%969=253%:%
%:%970=253%:%
%:%971=253%:%
%:%972=254%:%
%:%973=254%:%
%:%974=254%:%
%:%975=255%:%
%:%976=255%:%
%:%977=256%:%
%:%983=256%:%
%:%986=257%:%
%:%987=258%:%
%:%988=258%:%
%:%995=259%:%
%:%996=259%:%
%:%997=260%:%
%:%998=260%:%
%:%999=261%:%
%:%1000=261%:%
%:%1001=262%:%
%:%1002=262%:%
%:%1003=262%:%
%:%1004=263%:%
%:%1005=263%:%
%:%1006=264%:%
%:%1007=264%:%
%:%1008=264%:%
%:%1009=265%:%
%:%1010=265%:%
%:%1011=265%:%
%:%1012=266%:%
%:%1013=266%:%
%:%1014=267%:%
%:%1015=267%:%
%:%1016=267%:%
%:%1017=268%:%
%:%1018=268%:%
%:%1019=268%:%
%:%1020=269%:%
%:%1021=269%:%
%:%1022=270%:%
%:%1028=270%:%
%:%1031=271%:%
%:%1032=272%:%
%:%1033=272%:%
%:%1034=273%:%
%:%1041=274%:%
%:%1042=274%:%
%:%1043=275%:%
%:%1044=275%:%
%:%1045=276%:%
%:%1046=276%:%
%:%1047=277%:%
%:%1048=277%:%
%:%1049=277%:%
%:%1050=278%:%
%:%1051=278%:%
%:%1052=278%:%
%:%1053=279%:%
%:%1054=279%:%
%:%1055=279%:%
%:%1056=279%:%
%:%1057=280%:%
%:%1058=280%:%
%:%1059=281%:%
%:%1060=281%:%
%:%1061=282%:%
%:%1062=282%:%
%:%1063=283%:%
%:%1064=283%:%
%:%1065=283%:%
%:%1066=283%:%
%:%1067=283%:%
%:%1068=284%:%
%:%1069=284%:%
%:%1070=284%:%
%:%1071=284%:%
%:%1072=284%:%
%:%1073=285%:%
%:%1074=285%:%
%:%1075=286%:%
%:%1076=286%:%
%:%1077=287%:%
%:%1078=287%:%
%:%1079=287%:%
%:%1080=287%:%
%:%1081=288%:%
%:%1082=288%:%
%:%1083=288%:%
%:%1084=288%:%
%:%1085=289%:%
%:%1086=289%:%
%:%1087=290%:%
%:%1093=290%:%
%:%1096=291%:%
%:%1097=292%:%
%:%1098=292%:%
%:%1105=293%:%
%:%1106=293%:%
%:%1107=294%:%
%:%1108=294%:%
%:%1109=294%:%
%:%1110=294%:%
%:%1111=295%:%
%:%1112=295%:%
%:%1113=296%:%
%:%1114=296%:%
%:%1115=296%:%
%:%1116=297%:%
%:%1117=297%:%
%:%1118=297%:%
%:%1119=298%:%
%:%1120=298%:%
%:%1121=298%:%
%:%1122=299%:%
%:%1123=299%:%
%:%1124=300%:%
%:%1125=300%:%
%:%1126=300%:%
%:%1127=300%:%
%:%1128=300%:%
%:%1129=301%:%
%:%1135=301%:%
%:%1138=302%:%
%:%1139=303%:%
%:%1140=303%:%
%:%1147=304%:%
%:%1148=304%:%
%:%1149=305%:%
%:%1150=305%:%
%:%1151=306%:%
%:%1152=306%:%
%:%1153=306%:%
%:%1154=307%:%
%:%1155=307%:%
%:%1156=308%:%
%:%1157=308%:%
%:%1158=309%:%
%:%1159=309%:%
%:%1160=310%:%
%:%1175=314%:%
%:%1185=316%:%
%:%1186=316%:%
%:%1187=317%:%
%:%1188=318%:%
%:%1195=319%:%
%:%1196=319%:%
%:%1197=319%:%
%:%1198=320%:%
%:%1199=320%:%
%:%1200=321%:%
%:%1201=321%:%
%:%1202=322%:%
%:%1203=322%:%
%:%1204=323%:%
%:%1205=323%:%
%:%1206=324%:%
%:%1207=324%:%
%:%1208=324%:%
%:%1209=324%:%
%:%1210=325%:%
%:%1211=325%:%
%:%1212=326%:%
%:%1213=326%:%
%:%1214=327%:%
%:%1215=327%:%
%:%1216=327%:%
%:%1217=328%:%
%:%1218=328%:%
%:%1219=328%:%
%:%1220=328%:%
%:%1221=329%:%
%:%1222=329%:%
%:%1223=330%:%
%:%1224=330%:%
%:%1225=331%:%
%:%1226=331%:%
%:%1227=332%:%
%:%1228=332%:%
%:%1229=332%:%
%:%1230=332%:%
%:%1231=333%:%
%:%1232=333%:%
%:%1233=333%:%
%:%1234=333%:%
%:%1235=334%:%
%:%1236=334%:%
%:%1237=335%:%
%:%1238=335%:%
%:%1239=336%:%
%:%1240=336%:%
%:%1241=336%:%
%:%1242=337%:%
%:%1243=338%:%
%:%1244=338%:%
%:%1245=339%:%
%:%1246=339%:%
%:%1247=339%:%
%:%1248=339%:%
%:%1249=340%:%
%:%1250=340%:%
%:%1251=341%:%
%:%1252=341%:%
%:%1253=342%:%
%:%1254=342%:%
%:%1255=342%:%
%:%1256=343%:%
%:%1257=344%:%
%:%1258=344%:%
%:%1259=345%:%
%:%1260=345%:%
%:%1261=345%:%
%:%1262=346%:%
%:%1263=346%:%
%:%1264=347%:%
%:%1265=347%:%
%:%1266=347%:%
%:%1267=348%:%
%:%1268=348%:%
%:%1269=349%:%
%:%1270=349%:%
%:%1271=349%:%
%:%1272=349%:%
%:%1273=350%:%
%:%1274=350%:%
%:%1275=351%:%
%:%1276=351%:%
%:%1277=352%:%
%:%1278=352%:%
%:%1279=352%:%
%:%1280=353%:%
%:%1281=353%:%
%:%1282=353%:%
%:%1283=354%:%
%:%1284=354%:%
%:%1285=354%:%
%:%1286=354%:%
%:%1287=355%:%
%:%1288=355%:%
%:%1289=356%:%
%:%1290=356%:%
%:%1291=356%:%
%:%1292=356%:%
%:%1293=357%:%
%:%1303=359%:%
%:%1305=361%:%
%:%1306=361%:%
%:%1307=362%:%
%:%1308=363%:%
%:%1315=364%:%
%:%1316=364%:%
%:%1317=365%:%
%:%1318=365%:%
%:%1319=366%:%
%:%1320=366%:%
%:%1321=366%:%
%:%1322=366%:%
%:%1323=367%:%
%:%1324=367%:%
%:%1325=367%:%
%:%1326=368%:%
%:%1327=368%:%
%:%1328=368%:%
%:%1329=368%:%
%:%1330=369%:%
%:%1331=369%:%
%:%1332=369%:%
%:%1333=369%:%
%:%1334=369%:%
%:%1335=370%:%
%:%1336=370%:%
%:%1337=370%:%
%:%1338=370%:%
%:%1339=371%:%
%:%1354=374%:%
%:%1364=376%:%
%:%1365=376%:%
%:%1366=377%:%
%:%1367=378%:%
%:%1374=379%:%
%:%1375=379%:%
%:%1376=379%:%
%:%1377=380%:%
%:%1378=380%:%
%:%1379=381%:%
%:%1380=381%:%
%:%1381=381%:%
%:%1382=381%:%
%:%1383=382%:%
%:%1384=382%:%
%:%1385=383%:%
%:%1386=383%:%
%:%1387=384%:%
%:%1388=384%:%
%:%1389=384%:%
%:%1390=385%:%
%:%1391=385%:%
%:%1392=386%:%
%:%1393=386%:%
%:%1394=386%:%
%:%1395=386%:%
%:%1396=387%:%
%:%1397=387%:%
%:%1398=388%:%
%:%1399=388%:%
%:%1400=388%:%
%:%1401=388%:%
%:%1402=388%:%
%:%1403=389%:%
%:%1404=389%:%
%:%1405=389%:%
%:%1406=389%:%
%:%1407=390%:%
%:%1413=390%:%
%:%1416=391%:%
%:%1417=392%:%
%:%1418=392%:%
%:%1419=393%:%
%:%1420=394%:%
%:%1427=395%:%
%:%1428=395%:%
%:%1429=396%:%
%:%1430=396%:%
%:%1431=397%:%
%:%1432=397%:%
%:%1433=398%:%
%:%1434=398%:%
%:%1435=398%:%
%:%1436=399%:%
%:%1437=399%:%
%:%1438=399%:%
%:%1439=400%:%
%:%1440=400%:%
%:%1441=400%:%
%:%1442=400%:%
%:%1443=401%:%
%:%1444=401%:%
%:%1445=401%:%
%:%1446=401%:%
%:%1447=401%:%
%:%1448=402%:%
%:%1463=405%:%
%:%1475=407%:%
%:%1476=408%:%
%:%1478=410%:%
%:%1479=410%:%
%:%1480=411%:%
%:%1481=412%:%
%:%1482=413%:%
%:%1483=413%:%
%:%1490=414%:%
%:%1491=414%:%
%:%1492=415%:%
%:%1493=415%:%
%:%1494=416%:%
%:%1495=416%:%
%:%1496=417%:%
%:%1497=417%:%
%:%1498=417%:%
%:%1499=418%:%
%:%1500=418%:%
%:%1501=419%:%
%:%1502=419%:%
%:%1503=420%:%
%:%1504=420%:%
%:%1505=421%:%
%:%1506=421%:%
%:%1507=422%:%
%:%1508=422%:%
%:%1509=422%:%
%:%1510=423%:%
%:%1511=423%:%
%:%1512=423%:%
%:%1513=424%:%
%:%1514=424%:%
%:%1515=424%:%
%:%1516=425%:%
%:%1517=425%:%
%:%1518=425%:%
%:%1519=426%:%
%:%1520=426%:%
%:%1521=426%:%
%:%1522=426%:%
%:%1523=426%:%
%:%1524=427%:%
%:%1525=427%:%
%:%1526=427%:%
%:%1527=427%:%
%:%1528=427%:%
%:%1529=428%:%
%:%1530=428%:%
%:%1531=429%:%
%:%1537=429%:%
%:%1540=430%:%
%:%1541=431%:%
%:%1542=431%:%
%:%1543=432%:%
%:%1544=433%:%
%:%1551=434%:%
%:%1552=434%:%
%:%1553=435%:%
%:%1554=435%:%
%:%1555=436%:%
%:%1556=436%:%
%:%1557=437%:%
%:%1558=437%:%
%:%1559=437%:%
%:%1560=438%:%
%:%1561=438%:%
%:%1562=438%:%
%:%1563=439%:%
%:%1564=439%:%
%:%1565=439%:%
%:%1566=439%:%
%:%1567=439%:%
%:%1568=440%:%
%:%1569=440%:%
%:%1570=440%:%
%:%1571=441%:%
%:%1572=441%:%
%:%1573=441%:%
%:%1574=442%:%
%:%1575=442%:%
%:%1576=442%:%
%:%1577=442%:%
%:%1578=443%:%
%:%1579=443%:%
%:%1580=443%:%
%:%1581=443%:%
%:%1582=443%:%
%:%1583=444%:%
%:%1584=444%:%
%:%1585=444%:%
%:%1586=444%:%
%:%1587=445%:%
%:%1588=445%:%
%:%1589=445%:%
%:%1590=445%:%
%:%1591=445%:%
%:%1592=446%:%
%:%1598=446%:%
%:%1603=447%:%
%:%1608=448%:%
