%
\begin{isabellebody}%
\setisabellecontext{Parikh{\isacharunderscore}{\kern0pt}Img}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Parikh images%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Parikh{\isacharunderscore}{\kern0pt}Img\isanewline
\ \ \isakeywordTWO{imports}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}Reg{\isacharunderscore}{\kern0pt}Lang{\isacharunderscore}{\kern0pt}Exp{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Multiset{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Definition and basic lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The Parikh vector of a finite word describes how often each symbol of the alphabet occurs in the word.
We represent parikh vectors by multisets. The Parikh image of a language \isa{L}, denoted by \isa{{\isasymPsi}\ L},
is then the set of Parikh vectors of all words in the language.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}vec\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isasymequiv}\ mset{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ multiset\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymPsi}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}{\isasymPsi}\ L\ {\isasymequiv}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbackquote}{\kern0pt}\ L{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isasymunion}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymunion}\ {\isasymPsi}\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}L\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymUnion}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}L\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{2}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{1}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ add{\isachardot}{\kern0pt}commute\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Monotonicity properties%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ C{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}{\isasymPsi}\ B\ {\isasymsubseteq}\ {\isasymPsi}\ D{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Orderings{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}A\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}B\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}use\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordTWO{in}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}upd{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ A\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ B\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ v\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f\ rule{\isacharcolon}{\kern0pt}\ rlexp{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharprime}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ vars{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ SUP{\isacharunderscore}{\kern0pt}mono{\isacharprime}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$\Psi \; (A \cup B)^* = \Psi \; A^* B^*$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
\label{sec:parikh_img_star}%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
This property is claimed by Pilling in \cite{Pilling} and will be needed later.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymand}\ parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isasymunion}\ B\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{1}}{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}\ {\isasymand}\isanewline
\ \ \ \ \ \ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ i{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isasymle}\ n\ {\isasymand}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ Suc\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Suc\ i\ {\isasymle}\ Suc\ n{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Suc{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}le\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ i{\isacharunderscore}{\kern0pt}intro\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}n{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i{\isasymle}n{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ {\isachardoublequoteopen}i{\isasymle}n\ {\isasymand}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ star\ A\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ j\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordTWO{and}\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i{\isacharplus}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ lang{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}add\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$\Psi \; (E^* F)^* = \Psi \; \left(\{\varepsilon\} \cup E^* F^* F\right)$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
\label{sec:parikh_img_star2}%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
This property (where $\varepsilon$ denotes the empty word) is claimed by
Pilling as well \cite{Pilling}; we will use it later.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ conc{\isacharunderscore}{\kern0pt}assoc\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}idemp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}F\ {\isasymsubseteq}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ star{\isacharunderscore}{\kern0pt}def\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}ord{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{using}\isamarkupfalse%
\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}comm\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ le{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}iff\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left\ sup{\isachardot}{\kern0pt}cobounded{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{A homogeneous-like property for regular language expressions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
\label{sec:rlexp_homogeneous}%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ x\ {\isacharequal}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Var\ assms\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ False\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isachardot}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}star{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Now we can prove the desired homogeneous-like property which will become useful later.
Notably this property slightly differs from the property claimed in \cite{Pilling}. However, our
property is easier to prove formally and it suffices for the rest of the proof.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}L\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}L\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}upd{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}f{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}of\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Extension of Arden's lemma to Parikh images%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
\label{sec:parikh_arden}%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isachardot}{\kern0pt}orderE\ sup{\isachardot}{\kern0pt}orderI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}prems\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}UNION{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ X{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Equivalence class of languages with identical Parikh image%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
\label{sec:parikh_eq_class}%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
For a given language \isa{L}, we define the equivalence class of all languages with identical Parikh
image:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ lang\ set{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ L\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}L{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymPsi}\ L{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ L{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Union{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ a\ \isakeywordTWO{where}\ a{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ a\ {\isasymin}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ L\ \isakeywordTWO{where}\ L{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ L\ {\isasymand}\ L\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ L\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}intro\ L{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ subseteq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}subseteq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ a\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A\ \isakeywordONE{have}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymin}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}b{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ b\ \isakeywordTWO{where}\ b{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/studium/semester_7/semantik/homeworks/AIST/Parikh/Parikh_Img.thy%:%
%:%11=3%:%
%:%27=5%:%
%:%28=5%:%
%:%29=6%:%
%:%30=7%:%
%:%31=8%:%
%:%32=9%:%
%:%46=12%:%
%:%58=14%:%
%:%59=15%:%
%:%60=16%:%
%:%62=18%:%
%:%63=18%:%
%:%64=19%:%
%:%65=20%:%
%:%66=21%:%
%:%67=21%:%
%:%68=22%:%
%:%69=23%:%
%:%70=24%:%
%:%71=24%:%
%:%74=25%:%
%:%78=25%:%
%:%79=25%:%
%:%84=25%:%
%:%87=26%:%
%:%88=27%:%
%:%89=27%:%
%:%92=28%:%
%:%96=28%:%
%:%97=28%:%
%:%102=28%:%
%:%105=29%:%
%:%106=30%:%
%:%107=30%:%
%:%110=31%:%
%:%114=31%:%
%:%115=31%:%
%:%116=31%:%
%:%121=31%:%
%:%124=32%:%
%:%125=33%:%
%:%126=33%:%
%:%133=34%:%
%:%134=34%:%
%:%135=35%:%
%:%136=35%:%
%:%137=36%:%
%:%138=37%:%
%:%139=37%:%
%:%140=37%:%
%:%141=38%:%
%:%142=38%:%
%:%143=38%:%
%:%144=39%:%
%:%145=39%:%
%:%146=39%:%
%:%147=40%:%
%:%162=43%:%
%:%172=45%:%
%:%173=45%:%
%:%176=46%:%
%:%180=46%:%
%:%181=46%:%
%:%182=46%:%
%:%187=46%:%
%:%190=47%:%
%:%191=48%:%
%:%192=48%:%
%:%195=49%:%
%:%199=49%:%
%:%200=49%:%
%:%205=49%:%
%:%208=50%:%
%:%209=51%:%
%:%210=51%:%
%:%213=52%:%
%:%217=52%:%
%:%218=52%:%
%:%223=52%:%
%:%226=53%:%
%:%227=54%:%
%:%228=54%:%
%:%229=55%:%
%:%230=56%:%
%:%231=57%:%
%:%234=58%:%
%:%238=58%:%
%:%239=58%:%
%:%240=58%:%
%:%245=58%:%
%:%248=59%:%
%:%249=60%:%
%:%250=60%:%
%:%253=61%:%
%:%257=61%:%
%:%258=61%:%
%:%263=61%:%
%:%266=62%:%
%:%267=63%:%
%:%268=63%:%
%:%271=64%:%
%:%275=64%:%
%:%276=64%:%
%:%281=64%:%
%:%284=65%:%
%:%285=66%:%
%:%286=66%:%
%:%289=67%:%
%:%293=67%:%
%:%294=67%:%
%:%299=67%:%
%:%302=68%:%
%:%303=69%:%
%:%304=70%:%
%:%305=70%:%
%:%306=71%:%
%:%307=72%:%
%:%314=73%:%
%:%315=73%:%
%:%316=74%:%
%:%317=74%:%
%:%318=75%:%
%:%319=75%:%
%:%320=76%:%
%:%321=76%:%
%:%322=76%:%
%:%323=76%:%
%:%324=76%:%
%:%325=77%:%
%:%326=77%:%
%:%327=77%:%
%:%328=77%:%
%:%329=77%:%
%:%330=78%:%
%:%331=78%:%
%:%332=78%:%
%:%333=78%:%
%:%334=78%:%
%:%335=78%:%
%:%336=79%:%
%:%337=79%:%
%:%338=79%:%
%:%339=79%:%
%:%340=79%:%
%:%341=80%:%
%:%342=80%:%
%:%343=80%:%
%:%344=80%:%
%:%345=80%:%
%:%346=80%:%
%:%347=81%:%
%:%353=81%:%
%:%356=82%:%
%:%357=83%:%
%:%358=83%:%
%:%359=84%:%
%:%360=85%:%
%:%363=86%:%
%:%367=86%:%
%:%368=86%:%
%:%369=86%:%
%:%374=86%:%
%:%377=87%:%
%:%378=88%:%
%:%379=89%:%
%:%380=89%:%
%:%381=90%:%
%:%382=91%:%
%:%389=92%:%
%:%390=92%:%
%:%391=93%:%
%:%392=93%:%
%:%393=94%:%
%:%394=94%:%
%:%395=94%:%
%:%396=95%:%
%:%397=96%:%
%:%398=96%:%
%:%399=96%:%
%:%400=97%:%
%:%401=97%:%
%:%402=97%:%
%:%403=97%:%
%:%404=98%:%
%:%405=98%:%
%:%406=99%:%
%:%407=99%:%
%:%408=100%:%
%:%409=100%:%
%:%410=100%:%
%:%411=101%:%
%:%412=101%:%
%:%413=101%:%
%:%414=102%:%
%:%415=102%:%
%:%416=102%:%
%:%417=102%:%
%:%418=103%:%
%:%419=103%:%
%:%424=103%:%
%:%427=104%:%
%:%428=105%:%
%:%429=105%:%
%:%430=106%:%
%:%431=107%:%
%:%434=108%:%
%:%438=108%:%
%:%439=108%:%
%:%440=108%:%
%:%445=108%:%
%:%448=109%:%
%:%449=110%:%
%:%450=110%:%
%:%451=111%:%
%:%452=112%:%
%:%459=113%:%
%:%460=113%:%
%:%461=113%:%
%:%462=114%:%
%:%463=114%:%
%:%464=115%:%
%:%465=115%:%
%:%466=115%:%
%:%467=116%:%
%:%468=116%:%
%:%469=116%:%
%:%470=117%:%
%:%471=117%:%
%:%472=117%:%
%:%473=117%:%
%:%474=118%:%
%:%475=118%:%
%:%480=118%:%
%:%483=119%:%
%:%484=120%:%
%:%485=120%:%
%:%486=121%:%
%:%487=122%:%
%:%490=123%:%
%:%494=123%:%
%:%495=123%:%
%:%496=123%:%
%:%510=127%:%
%:%522=129%:%
%:%526=130%:%
%:%528=132%:%
%:%529=132%:%
%:%530=133%:%
%:%531=134%:%
%:%538=135%:%
%:%539=135%:%
%:%540=135%:%
%:%541=136%:%
%:%542=136%:%
%:%543=137%:%
%:%544=137%:%
%:%545=137%:%
%:%546=137%:%
%:%547=138%:%
%:%548=138%:%
%:%549=139%:%
%:%550=139%:%
%:%551=140%:%
%:%552=140%:%
%:%553=140%:%
%:%554=141%:%
%:%555=141%:%
%:%556=141%:%
%:%557=142%:%
%:%558=142%:%
%:%559=142%:%
%:%560=142%:%
%:%561=143%:%
%:%562=143%:%
%:%563=144%:%
%:%564=144%:%
%:%565=144%:%
%:%566=144%:%
%:%567=144%:%
%:%568=145%:%
%:%569=145%:%
%:%570=145%:%
%:%571=145%:%
%:%572=146%:%
%:%573=146%:%
%:%574=146%:%
%:%575=147%:%
%:%576=147%:%
%:%577=147%:%
%:%578=148%:%
%:%579=148%:%
%:%580=148%:%
%:%581=148%:%
%:%582=149%:%
%:%583=149%:%
%:%584=149%:%
%:%585=150%:%
%:%586=150%:%
%:%587=151%:%
%:%588=151%:%
%:%589=151%:%
%:%590=152%:%
%:%591=152%:%
%:%592=153%:%
%:%593=153%:%
%:%594=154%:%
%:%595=154%:%
%:%596=154%:%
%:%597=155%:%
%:%598=155%:%
%:%599=156%:%
%:%600=156%:%
%:%601=156%:%
%:%602=157%:%
%:%603=157%:%
%:%604=157%:%
%:%605=158%:%
%:%606=158%:%
%:%607=158%:%
%:%608=158%:%
%:%609=159%:%
%:%610=159%:%
%:%611=160%:%
%:%612=160%:%
%:%613=161%:%
%:%614=161%:%
%:%615=161%:%
%:%616=161%:%
%:%617=162%:%
%:%618=162%:%
%:%619=162%:%
%:%620=163%:%
%:%621=163%:%
%:%622=163%:%
%:%623=164%:%
%:%624=164%:%
%:%625=164%:%
%:%626=165%:%
%:%627=165%:%
%:%628=166%:%
%:%629=166%:%
%:%630=167%:%
%:%631=167%:%
%:%632=167%:%
%:%633=167%:%
%:%634=168%:%
%:%635=168%:%
%:%636=169%:%
%:%637=169%:%
%:%638=169%:%
%:%639=169%:%
%:%640=169%:%
%:%641=170%:%
%:%647=170%:%
%:%650=171%:%
%:%651=172%:%
%:%652=172%:%
%:%653=173%:%
%:%654=174%:%
%:%661=175%:%
%:%662=175%:%
%:%663=176%:%
%:%664=176%:%
%:%665=176%:%
%:%666=177%:%
%:%667=177%:%
%:%668=177%:%
%:%669=177%:%
%:%670=178%:%
%:%671=178%:%
%:%672=178%:%
%:%673=178%:%
%:%674=179%:%
%:%675=179%:%
%:%676=179%:%
%:%677=180%:%
%:%678=180%:%
%:%679=180%:%
%:%680=181%:%
%:%681=181%:%
%:%682=181%:%
%:%683=181%:%
%:%684=181%:%
%:%685=182%:%
%:%686=182%:%
%:%687=182%:%
%:%688=182%:%
%:%689=183%:%
%:%690=183%:%
%:%691=183%:%
%:%692=184%:%
%:%693=184%:%
%:%694=184%:%
%:%695=185%:%
%:%696=185%:%
%:%697=185%:%
%:%698=185%:%
%:%699=186%:%
%:%700=186%:%
%:%701=186%:%
%:%702=186%:%
%:%703=187%:%
%:%704=187%:%
%:%705=187%:%
%:%706=187%:%
%:%707=188%:%
%:%708=188%:%
%:%709=188%:%
%:%710=188%:%
%:%711=188%:%
%:%712=189%:%
%:%718=189%:%
%:%721=190%:%
%:%722=191%:%
%:%723=191%:%
%:%724=192%:%
%:%725=193%:%
%:%732=194%:%
%:%733=194%:%
%:%734=195%:%
%:%735=195%:%
%:%736=195%:%
%:%737=196%:%
%:%738=196%:%
%:%739=196%:%
%:%740=197%:%
%:%741=197%:%
%:%742=197%:%
%:%743=197%:%
%:%744=198%:%
%:%745=198%:%
%:%746=198%:%
%:%747=198%:%
%:%748=198%:%
%:%749=199%:%
%:%750=199%:%
%:%751=199%:%
%:%752=199%:%
%:%753=199%:%
%:%754=200%:%
%:%755=200%:%
%:%756=200%:%
%:%757=200%:%
%:%758=200%:%
%:%759=201%:%
%:%760=201%:%
%:%761=201%:%
%:%762=201%:%
%:%763=201%:%
%:%764=202%:%
%:%765=202%:%
%:%766=202%:%
%:%767=202%:%
%:%768=202%:%
%:%769=203%:%
%:%775=203%:%
%:%778=204%:%
%:%779=205%:%
%:%780=205%:%
%:%787=206%:%
%:%788=206%:%
%:%789=207%:%
%:%790=207%:%
%:%791=207%:%
%:%792=207%:%
%:%793=208%:%
%:%794=208%:%
%:%795=208%:%
%:%796=208%:%
%:%797=209%:%
%:%812=213%:%
%:%824=215%:%
%:%828=216%:%
%:%829=217%:%
%:%831=220%:%
%:%832=220%:%
%:%839=221%:%
%:%840=221%:%
%:%841=222%:%
%:%842=222%:%
%:%843=223%:%
%:%844=223%:%
%:%845=223%:%
%:%846=224%:%
%:%847=224%:%
%:%848=224%:%
%:%849=225%:%
%:%850=225%:%
%:%851=225%:%
%:%852=226%:%
%:%853=226%:%
%:%854=227%:%
%:%855=227%:%
%:%856=227%:%
%:%857=227%:%
%:%858=228%:%
%:%859=228%:%
%:%864=228%:%
%:%867=229%:%
%:%868=230%:%
%:%869=230%:%
%:%876=231%:%
%:%877=231%:%
%:%878=232%:%
%:%879=232%:%
%:%880=233%:%
%:%881=233%:%
%:%882=234%:%
%:%883=234%:%
%:%884=234%:%
%:%885=234%:%
%:%886=234%:%
%:%887=235%:%
%:%888=235%:%
%:%889=235%:%
%:%890=235%:%
%:%891=236%:%
%:%892=236%:%
%:%893=236%:%
%:%894=236%:%
%:%895=237%:%
%:%896=237%:%
%:%897=237%:%
%:%898=238%:%
%:%899=238%:%
%:%900=238%:%
%:%901=239%:%
%:%902=239%:%
%:%903=240%:%
%:%904=240%:%
%:%905=240%:%
%:%906=241%:%
%:%907=241%:%
%:%908=241%:%
%:%909=242%:%
%:%910=242%:%
%:%911=243%:%
%:%917=243%:%
%:%920=244%:%
%:%921=245%:%
%:%922=245%:%
%:%929=246%:%
%:%930=246%:%
%:%931=247%:%
%:%932=247%:%
%:%933=248%:%
%:%934=248%:%
%:%935=249%:%
%:%936=249%:%
%:%937=249%:%
%:%938=250%:%
%:%939=250%:%
%:%940=251%:%
%:%941=251%:%
%:%942=251%:%
%:%943=252%:%
%:%944=252%:%
%:%945=252%:%
%:%946=253%:%
%:%947=253%:%
%:%948=254%:%
%:%949=254%:%
%:%950=254%:%
%:%951=255%:%
%:%952=255%:%
%:%953=255%:%
%:%954=256%:%
%:%955=256%:%
%:%956=257%:%
%:%962=257%:%
%:%965=258%:%
%:%966=259%:%
%:%967=259%:%
%:%968=260%:%
%:%975=261%:%
%:%976=261%:%
%:%977=262%:%
%:%978=262%:%
%:%979=263%:%
%:%980=263%:%
%:%981=264%:%
%:%982=264%:%
%:%983=264%:%
%:%984=265%:%
%:%985=265%:%
%:%986=265%:%
%:%987=266%:%
%:%988=266%:%
%:%989=266%:%
%:%990=266%:%
%:%991=267%:%
%:%992=267%:%
%:%993=268%:%
%:%994=268%:%
%:%995=269%:%
%:%996=269%:%
%:%997=270%:%
%:%998=270%:%
%:%999=270%:%
%:%1000=270%:%
%:%1001=270%:%
%:%1002=271%:%
%:%1003=271%:%
%:%1004=271%:%
%:%1005=271%:%
%:%1006=271%:%
%:%1007=272%:%
%:%1008=272%:%
%:%1009=273%:%
%:%1010=273%:%
%:%1011=274%:%
%:%1012=274%:%
%:%1013=274%:%
%:%1014=274%:%
%:%1015=275%:%
%:%1016=275%:%
%:%1017=275%:%
%:%1018=275%:%
%:%1019=276%:%
%:%1020=276%:%
%:%1021=277%:%
%:%1027=277%:%
%:%1030=278%:%
%:%1031=279%:%
%:%1032=279%:%
%:%1039=280%:%
%:%1040=280%:%
%:%1041=281%:%
%:%1042=281%:%
%:%1043=281%:%
%:%1044=281%:%
%:%1045=282%:%
%:%1046=282%:%
%:%1047=283%:%
%:%1048=283%:%
%:%1049=283%:%
%:%1050=284%:%
%:%1051=284%:%
%:%1052=284%:%
%:%1053=285%:%
%:%1054=285%:%
%:%1055=285%:%
%:%1056=286%:%
%:%1057=286%:%
%:%1058=287%:%
%:%1059=287%:%
%:%1060=287%:%
%:%1061=287%:%
%:%1062=287%:%
%:%1063=288%:%
%:%1069=288%:%
%:%1072=289%:%
%:%1073=290%:%
%:%1074=290%:%
%:%1081=291%:%
%:%1082=291%:%
%:%1083=292%:%
%:%1084=292%:%
%:%1085=293%:%
%:%1086=293%:%
%:%1087=293%:%
%:%1088=294%:%
%:%1089=294%:%
%:%1090=295%:%
%:%1091=295%:%
%:%1092=296%:%
%:%1093=296%:%
%:%1094=297%:%
%:%1109=301%:%
%:%1121=303%:%
%:%1123=305%:%
%:%1124=305%:%
%:%1125=306%:%
%:%1126=307%:%
%:%1133=308%:%
%:%1134=308%:%
%:%1135=309%:%
%:%1136=309%:%
%:%1137=310%:%
%:%1138=310%:%
%:%1139=311%:%
%:%1140=311%:%
%:%1141=312%:%
%:%1142=312%:%
%:%1143=313%:%
%:%1144=313%:%
%:%1145=313%:%
%:%1146=313%:%
%:%1147=314%:%
%:%1148=314%:%
%:%1149=315%:%
%:%1150=315%:%
%:%1151=316%:%
%:%1152=316%:%
%:%1153=316%:%
%:%1154=317%:%
%:%1155=317%:%
%:%1156=317%:%
%:%1157=317%:%
%:%1158=318%:%
%:%1159=318%:%
%:%1160=319%:%
%:%1161=319%:%
%:%1162=320%:%
%:%1163=320%:%
%:%1164=321%:%
%:%1165=321%:%
%:%1166=321%:%
%:%1167=321%:%
%:%1168=322%:%
%:%1169=322%:%
%:%1170=322%:%
%:%1171=322%:%
%:%1172=323%:%
%:%1173=323%:%
%:%1174=324%:%
%:%1175=324%:%
%:%1176=325%:%
%:%1177=325%:%
%:%1178=325%:%
%:%1179=326%:%
%:%1180=327%:%
%:%1181=327%:%
%:%1182=328%:%
%:%1183=328%:%
%:%1184=328%:%
%:%1185=328%:%
%:%1186=329%:%
%:%1187=329%:%
%:%1188=330%:%
%:%1189=330%:%
%:%1190=331%:%
%:%1191=331%:%
%:%1192=331%:%
%:%1193=332%:%
%:%1194=333%:%
%:%1195=333%:%
%:%1196=334%:%
%:%1197=334%:%
%:%1198=334%:%
%:%1199=335%:%
%:%1200=335%:%
%:%1201=336%:%
%:%1202=336%:%
%:%1203=336%:%
%:%1204=337%:%
%:%1205=337%:%
%:%1206=338%:%
%:%1207=338%:%
%:%1208=338%:%
%:%1209=338%:%
%:%1210=339%:%
%:%1211=339%:%
%:%1212=340%:%
%:%1213=340%:%
%:%1214=341%:%
%:%1215=341%:%
%:%1216=341%:%
%:%1217=342%:%
%:%1218=342%:%
%:%1219=342%:%
%:%1220=343%:%
%:%1221=343%:%
%:%1222=343%:%
%:%1223=343%:%
%:%1224=344%:%
%:%1225=344%:%
%:%1226=345%:%
%:%1227=345%:%
%:%1228=345%:%
%:%1229=345%:%
%:%1230=346%:%
%:%1240=348%:%
%:%1241=349%:%
%:%1242=350%:%
%:%1244=351%:%
%:%1245=351%:%
%:%1246=352%:%
%:%1247=353%:%
%:%1254=354%:%
%:%1255=354%:%
%:%1256=355%:%
%:%1257=355%:%
%:%1258=356%:%
%:%1259=356%:%
%:%1260=356%:%
%:%1261=356%:%
%:%1262=357%:%
%:%1263=357%:%
%:%1264=357%:%
%:%1265=358%:%
%:%1266=358%:%
%:%1267=358%:%
%:%1268=358%:%
%:%1269=359%:%
%:%1270=359%:%
%:%1271=359%:%
%:%1272=359%:%
%:%1273=359%:%
%:%1274=360%:%
%:%1275=360%:%
%:%1276=360%:%
%:%1277=360%:%
%:%1278=361%:%
%:%1293=364%:%
%:%1305=366%:%
%:%1307=368%:%
%:%1308=368%:%
%:%1309=369%:%
%:%1310=370%:%
%:%1317=371%:%
%:%1318=371%:%
%:%1319=372%:%
%:%1320=372%:%
%:%1321=373%:%
%:%1322=373%:%
%:%1323=373%:%
%:%1324=373%:%
%:%1325=374%:%
%:%1326=374%:%
%:%1327=375%:%
%:%1328=375%:%
%:%1329=376%:%
%:%1330=376%:%
%:%1331=376%:%
%:%1332=377%:%
%:%1333=377%:%
%:%1334=378%:%
%:%1335=378%:%
%:%1336=378%:%
%:%1337=378%:%
%:%1338=379%:%
%:%1339=379%:%
%:%1340=380%:%
%:%1341=380%:%
%:%1342=380%:%
%:%1343=380%:%
%:%1344=380%:%
%:%1345=381%:%
%:%1346=381%:%
%:%1347=381%:%
%:%1348=381%:%
%:%1349=382%:%
%:%1355=382%:%
%:%1358=383%:%
%:%1359=384%:%
%:%1360=384%:%
%:%1361=385%:%
%:%1362=386%:%
%:%1369=387%:%
%:%1370=387%:%
%:%1371=388%:%
%:%1372=388%:%
%:%1373=389%:%
%:%1374=389%:%
%:%1375=390%:%
%:%1376=390%:%
%:%1377=390%:%
%:%1378=391%:%
%:%1379=391%:%
%:%1380=391%:%
%:%1381=392%:%
%:%1382=392%:%
%:%1383=392%:%
%:%1384=392%:%
%:%1385=393%:%
%:%1386=393%:%
%:%1387=393%:%
%:%1388=393%:%
%:%1389=393%:%
%:%1390=394%:%
%:%1405=397%:%
%:%1417=399%:%
%:%1421=400%:%
%:%1422=401%:%
%:%1424=403%:%
%:%1425=403%:%
%:%1426=404%:%
%:%1427=405%:%
%:%1428=406%:%
%:%1429=406%:%
%:%1436=407%:%
%:%1437=407%:%
%:%1438=408%:%
%:%1439=408%:%
%:%1440=409%:%
%:%1441=409%:%
%:%1442=410%:%
%:%1443=410%:%
%:%1444=410%:%
%:%1445=411%:%
%:%1446=411%:%
%:%1447=412%:%
%:%1448=412%:%
%:%1449=413%:%
%:%1450=413%:%
%:%1451=414%:%
%:%1452=414%:%
%:%1453=415%:%
%:%1454=415%:%
%:%1455=415%:%
%:%1456=416%:%
%:%1457=416%:%
%:%1458=416%:%
%:%1459=417%:%
%:%1460=417%:%
%:%1461=417%:%
%:%1462=418%:%
%:%1463=418%:%
%:%1464=418%:%
%:%1465=419%:%
%:%1466=419%:%
%:%1467=419%:%
%:%1468=419%:%
%:%1469=419%:%
%:%1470=420%:%
%:%1471=420%:%
%:%1472=420%:%
%:%1473=420%:%
%:%1474=420%:%
%:%1475=421%:%
%:%1476=421%:%
%:%1477=422%:%
%:%1483=422%:%
%:%1486=423%:%
%:%1487=424%:%
%:%1488=424%:%
%:%1489=425%:%
%:%1490=426%:%
%:%1497=427%:%
%:%1498=427%:%
%:%1499=428%:%
%:%1500=428%:%
%:%1501=429%:%
%:%1502=429%:%
%:%1503=430%:%
%:%1504=430%:%
%:%1505=430%:%
%:%1506=431%:%
%:%1507=431%:%
%:%1508=431%:%
%:%1509=432%:%
%:%1510=432%:%
%:%1511=432%:%
%:%1512=432%:%
%:%1513=432%:%
%:%1514=433%:%
%:%1515=433%:%
%:%1516=433%:%
%:%1517=434%:%
%:%1518=434%:%
%:%1519=434%:%
%:%1520=435%:%
%:%1521=435%:%
%:%1522=435%:%
%:%1523=435%:%
%:%1524=436%:%
%:%1525=436%:%
%:%1526=436%:%
%:%1527=436%:%
%:%1528=436%:%
%:%1529=437%:%
%:%1530=437%:%
%:%1531=437%:%
%:%1532=437%:%
%:%1533=438%:%
%:%1534=438%:%
%:%1535=438%:%
%:%1536=438%:%
%:%1537=438%:%
%:%1538=439%:%
%:%1544=439%:%
%:%1549=440%:%
%:%1554=441%:%
