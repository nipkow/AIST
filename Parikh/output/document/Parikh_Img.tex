%
\begin{isabellebody}%
\setisabellecontext{Parikh{\isacharunderscore}{\kern0pt}Img}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Parikh{\isacharunderscore}{\kern0pt}Img\isanewline
\ \ \isakeywordTWO{imports}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}Lfun{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Multiset{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Parikh image%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{abbreviation}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}vec\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isasymequiv}\ mset{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ multiset\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymPsi}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ L\ {\isasymequiv}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbackquote}{\kern0pt}\ L{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ subseteq{\isacharunderscore}{\kern0pt}comm\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}t\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}t\ lang\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}subseteq{\isacharunderscore}{\kern0pt}comm\ L{\isadigit{1}}\ L{\isadigit{2}}\ {\isasymequiv}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymsubseteq}\ {\isasymPsi}\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isasymunion}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{1}}\ {\isasymunion}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}L\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymUnion}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}L\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ B\ {\isasymLongrightarrow}\ parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isacharequal}{\kern0pt}\ B\ {\isasymLongrightarrow}\ parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Star{\isacharunderscore}{\kern0pt}pow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}m\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ {\isasymexists}n{\isachardot}{\kern0pt}\ m\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isachardot}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}m\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}L{\isadigit{2}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{1}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ add{\isachardot}{\kern0pt}commute\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ B\ {\isasymLongrightarrow}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ B\ {\isasymLongrightarrow}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ C{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ B\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ D{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ B\ {\isasymLongrightarrow}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ B\ {\isasymLongrightarrow}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ B\ {\isasymLongrightarrow}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Orderings{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}A\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}B\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}upd{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ A\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ B\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ v\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}A\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}B\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ A\ i{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ B\ i{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ rule{\isacharcolon}{\kern0pt}\ rlexp{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharprime}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ vars{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ SUP{\isacharunderscore}{\kern0pt}mono{\isacharprime}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{(E\<union>F)* and E*F* have the same Parikh image%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymand}\ parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isasymunion}\ B\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{1}}{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}\ {\isasymand}\isanewline
\ \ \ \ \ \ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ i{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isasymle}\ n\ {\isasymand}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ Suc\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Suc\ i\ {\isasymle}\ Suc\ n{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Suc{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}le\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ i{\isacharunderscore}{\kern0pt}intro\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}n{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i{\isasymle}n{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ {\isachardoublequoteopen}i{\isasymle}n\ {\isasymand}\ v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ star\ A\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ j\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordTWO{and}\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i{\isacharplus}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ lang{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}add\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{(E*F)* and {\<epsilon>} \<union> E*F*F have the same Parikh image%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ conc{\isacharunderscore}{\kern0pt}assoc\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}idemp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}F\ {\isasymsubseteq}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ star{\isacharunderscore}{\kern0pt}def\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}ord{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{using}\isamarkupfalse%
\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}comm\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ le{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}iff\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left\ sup{\isachardot}{\kern0pt}cobounded{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{A homogeneous-like property for regular functions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ x\ {\isacharequal}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Var\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ False\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}star{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}L\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}L\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}f{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}of\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}L\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}L\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}of\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}of\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}apply{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Extension of Arden's lemma to Parikh images%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isachardot}{\kern0pt}orderE\ sup{\isachardot}{\kern0pt}orderI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}prems\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ X{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ x\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}UNION{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}x\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ X{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Equivalence class of languages with same Parikh image%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ lang\ set{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ L\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}L{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Union{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ a\ \isakeywordTWO{where}\ a{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ a\ {\isasymin}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ L\ \isakeywordTWO{where}\ L{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ L\ {\isasymand}\ L\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ L\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}intro\ L{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ subseteq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}subseteq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ a\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ A\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A\ \isakeywordONE{have}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}b{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ b\ \isakeywordTWO{where}\ b{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/studium/semester_7/semantik/homeworks/AIST/Parikh/Parikh_Img.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%29=8%:%
%:%39=13%:%
%:%40=13%:%
%:%41=14%:%
%:%42=15%:%
%:%43=16%:%
%:%44=17%:%
%:%45=17%:%
%:%46=18%:%
%:%47=19%:%
%:%48=20%:%
%:%49=21%:%
%:%50=22%:%
%:%51=22%:%
%:%52=23%:%
%:%53=24%:%
%:%54=25%:%
%:%55=26%:%
%:%56=26%:%
%:%59=27%:%
%:%63=27%:%
%:%64=27%:%
%:%69=27%:%
%:%72=28%:%
%:%73=29%:%
%:%74=29%:%
%:%77=30%:%
%:%81=30%:%
%:%82=30%:%
%:%87=30%:%
%:%90=31%:%
%:%91=32%:%
%:%92=32%:%
%:%95=33%:%
%:%99=33%:%
%:%100=33%:%
%:%101=33%:%
%:%106=33%:%
%:%109=34%:%
%:%110=35%:%
%:%111=35%:%
%:%114=36%:%
%:%118=36%:%
%:%119=36%:%
%:%120=36%:%
%:%125=36%:%
%:%128=37%:%
%:%129=38%:%
%:%130=39%:%
%:%131=39%:%
%:%138=40%:%
%:%139=40%:%
%:%140=41%:%
%:%141=41%:%
%:%142=42%:%
%:%143=42%:%
%:%144=42%:%
%:%145=42%:%
%:%146=43%:%
%:%147=43%:%
%:%148=43%:%
%:%149=43%:%
%:%150=43%:%
%:%151=44%:%
%:%157=44%:%
%:%160=45%:%
%:%161=46%:%
%:%162=47%:%
%:%163=47%:%
%:%166=48%:%
%:%170=48%:%
%:%171=48%:%
%:%172=48%:%
%:%177=48%:%
%:%180=49%:%
%:%181=50%:%
%:%182=50%:%
%:%189=51%:%
%:%190=51%:%
%:%191=52%:%
%:%192=52%:%
%:%193=53%:%
%:%194=54%:%
%:%195=54%:%
%:%196=54%:%
%:%197=55%:%
%:%198=55%:%
%:%199=55%:%
%:%200=56%:%
%:%201=56%:%
%:%202=56%:%
%:%203=57%:%
%:%209=57%:%
%:%212=58%:%
%:%213=59%:%
%:%214=60%:%
%:%215=60%:%
%:%218=61%:%
%:%222=61%:%
%:%223=61%:%
%:%228=61%:%
%:%231=62%:%
%:%232=63%:%
%:%233=63%:%
%:%236=64%:%
%:%240=64%:%
%:%241=64%:%
%:%246=64%:%
%:%249=65%:%
%:%250=66%:%
%:%251=66%:%
%:%252=67%:%
%:%253=68%:%
%:%254=69%:%
%:%257=70%:%
%:%261=70%:%
%:%262=70%:%
%:%263=70%:%
%:%268=70%:%
%:%271=71%:%
%:%272=72%:%
%:%273=72%:%
%:%276=73%:%
%:%280=73%:%
%:%281=73%:%
%:%286=73%:%
%:%289=74%:%
%:%290=75%:%
%:%291=75%:%
%:%294=76%:%
%:%298=76%:%
%:%299=76%:%
%:%304=76%:%
%:%307=77%:%
%:%308=78%:%
%:%309=78%:%
%:%312=79%:%
%:%316=79%:%
%:%317=79%:%
%:%322=79%:%
%:%325=80%:%
%:%326=81%:%
%:%327=81%:%
%:%328=82%:%
%:%329=83%:%
%:%336=84%:%
%:%337=84%:%
%:%338=85%:%
%:%339=85%:%
%:%340=86%:%
%:%341=86%:%
%:%342=87%:%
%:%343=87%:%
%:%344=87%:%
%:%345=87%:%
%:%346=87%:%
%:%347=88%:%
%:%348=88%:%
%:%349=88%:%
%:%350=88%:%
%:%351=88%:%
%:%352=89%:%
%:%353=89%:%
%:%354=89%:%
%:%355=89%:%
%:%356=89%:%
%:%357=89%:%
%:%358=90%:%
%:%359=90%:%
%:%360=90%:%
%:%361=90%:%
%:%362=90%:%
%:%363=91%:%
%:%364=91%:%
%:%365=91%:%
%:%366=91%:%
%:%367=91%:%
%:%368=91%:%
%:%369=92%:%
%:%375=92%:%
%:%378=93%:%
%:%379=94%:%
%:%380=94%:%
%:%381=95%:%
%:%382=96%:%
%:%385=97%:%
%:%389=97%:%
%:%390=97%:%
%:%391=97%:%
%:%396=97%:%
%:%399=98%:%
%:%400=99%:%
%:%401=100%:%
%:%402=100%:%
%:%403=101%:%
%:%404=102%:%
%:%411=103%:%
%:%412=103%:%
%:%413=103%:%
%:%414=104%:%
%:%415=104%:%
%:%416=105%:%
%:%417=105%:%
%:%418=105%:%
%:%419=106%:%
%:%420=107%:%
%:%421=107%:%
%:%422=107%:%
%:%423=108%:%
%:%424=108%:%
%:%425=108%:%
%:%426=108%:%
%:%427=109%:%
%:%428=109%:%
%:%429=110%:%
%:%430=110%:%
%:%431=111%:%
%:%432=111%:%
%:%433=111%:%
%:%434=112%:%
%:%435=112%:%
%:%436=112%:%
%:%437=113%:%
%:%438=113%:%
%:%439=113%:%
%:%440=113%:%
%:%441=114%:%
%:%442=114%:%
%:%447=114%:%
%:%450=115%:%
%:%451=116%:%
%:%452=116%:%
%:%453=117%:%
%:%454=118%:%
%:%457=119%:%
%:%461=119%:%
%:%462=119%:%
%:%463=119%:%
%:%468=119%:%
%:%471=120%:%
%:%472=121%:%
%:%473=121%:%
%:%474=122%:%
%:%475=123%:%
%:%478=124%:%
%:%482=124%:%
%:%483=124%:%
%:%484=124%:%
%:%489=124%:%
%:%492=125%:%
%:%493=126%:%
%:%494=126%:%
%:%495=127%:%
%:%496=128%:%
%:%503=129%:%
%:%504=129%:%
%:%505=129%:%
%:%506=130%:%
%:%507=130%:%
%:%508=131%:%
%:%509=131%:%
%:%510=131%:%
%:%511=132%:%
%:%512=132%:%
%:%513=132%:%
%:%514=133%:%
%:%515=133%:%
%:%516=133%:%
%:%517=133%:%
%:%518=134%:%
%:%519=134%:%
%:%524=134%:%
%:%527=135%:%
%:%528=136%:%
%:%529=137%:%
%:%530=137%:%
%:%531=138%:%
%:%532=139%:%
%:%535=140%:%
%:%539=140%:%
%:%540=140%:%
%:%541=140%:%
%:%555=144%:%
%:%565=146%:%
%:%566=146%:%
%:%567=147%:%
%:%568=148%:%
%:%575=149%:%
%:%576=149%:%
%:%577=149%:%
%:%578=150%:%
%:%579=150%:%
%:%580=151%:%
%:%581=151%:%
%:%582=151%:%
%:%583=151%:%
%:%584=152%:%
%:%585=152%:%
%:%586=153%:%
%:%587=153%:%
%:%588=154%:%
%:%589=154%:%
%:%590=154%:%
%:%591=155%:%
%:%592=155%:%
%:%593=155%:%
%:%594=156%:%
%:%595=156%:%
%:%596=156%:%
%:%597=156%:%
%:%598=157%:%
%:%599=157%:%
%:%600=158%:%
%:%601=159%:%
%:%602=159%:%
%:%603=159%:%
%:%604=159%:%
%:%605=159%:%
%:%606=160%:%
%:%607=160%:%
%:%608=160%:%
%:%609=160%:%
%:%610=161%:%
%:%611=161%:%
%:%612=161%:%
%:%613=162%:%
%:%614=162%:%
%:%615=162%:%
%:%616=163%:%
%:%617=163%:%
%:%618=163%:%
%:%619=163%:%
%:%620=164%:%
%:%621=165%:%
%:%622=165%:%
%:%623=165%:%
%:%624=166%:%
%:%625=166%:%
%:%626=167%:%
%:%627=167%:%
%:%628=167%:%
%:%629=168%:%
%:%630=168%:%
%:%631=169%:%
%:%632=169%:%
%:%633=170%:%
%:%634=170%:%
%:%635=170%:%
%:%636=171%:%
%:%637=171%:%
%:%638=172%:%
%:%639=172%:%
%:%640=172%:%
%:%641=173%:%
%:%642=173%:%
%:%643=173%:%
%:%644=174%:%
%:%645=174%:%
%:%646=174%:%
%:%647=174%:%
%:%648=175%:%
%:%649=175%:%
%:%650=176%:%
%:%651=176%:%
%:%652=177%:%
%:%653=177%:%
%:%654=177%:%
%:%655=177%:%
%:%656=178%:%
%:%657=178%:%
%:%658=178%:%
%:%659=179%:%
%:%660=179%:%
%:%661=179%:%
%:%662=180%:%
%:%663=180%:%
%:%664=180%:%
%:%665=181%:%
%:%666=181%:%
%:%667=182%:%
%:%668=182%:%
%:%669=183%:%
%:%670=183%:%
%:%671=183%:%
%:%672=183%:%
%:%673=184%:%
%:%674=184%:%
%:%675=185%:%
%:%676=185%:%
%:%677=185%:%
%:%678=185%:%
%:%679=185%:%
%:%680=186%:%
%:%686=186%:%
%:%689=187%:%
%:%690=188%:%
%:%691=189%:%
%:%692=189%:%
%:%693=190%:%
%:%694=191%:%
%:%701=192%:%
%:%702=192%:%
%:%703=193%:%
%:%704=193%:%
%:%705=193%:%
%:%706=194%:%
%:%707=194%:%
%:%708=194%:%
%:%709=194%:%
%:%710=195%:%
%:%711=195%:%
%:%712=195%:%
%:%713=195%:%
%:%714=196%:%
%:%715=196%:%
%:%716=196%:%
%:%717=197%:%
%:%718=197%:%
%:%719=197%:%
%:%720=198%:%
%:%721=198%:%
%:%722=198%:%
%:%723=198%:%
%:%724=198%:%
%:%725=199%:%
%:%726=199%:%
%:%727=199%:%
%:%728=199%:%
%:%729=200%:%
%:%730=200%:%
%:%731=200%:%
%:%732=201%:%
%:%733=201%:%
%:%734=201%:%
%:%735=202%:%
%:%736=202%:%
%:%737=202%:%
%:%738=202%:%
%:%739=203%:%
%:%740=203%:%
%:%741=203%:%
%:%742=203%:%
%:%743=204%:%
%:%744=204%:%
%:%745=204%:%
%:%746=204%:%
%:%747=205%:%
%:%748=205%:%
%:%749=205%:%
%:%750=205%:%
%:%751=205%:%
%:%752=206%:%
%:%758=206%:%
%:%761=207%:%
%:%762=208%:%
%:%763=208%:%
%:%764=209%:%
%:%765=210%:%
%:%772=211%:%
%:%773=211%:%
%:%774=212%:%
%:%775=212%:%
%:%776=212%:%
%:%777=213%:%
%:%778=213%:%
%:%779=213%:%
%:%780=214%:%
%:%781=214%:%
%:%782=214%:%
%:%783=214%:%
%:%784=215%:%
%:%785=215%:%
%:%786=215%:%
%:%787=215%:%
%:%788=215%:%
%:%789=216%:%
%:%790=216%:%
%:%791=216%:%
%:%792=216%:%
%:%793=216%:%
%:%794=217%:%
%:%795=217%:%
%:%796=217%:%
%:%797=217%:%
%:%798=217%:%
%:%799=218%:%
%:%800=218%:%
%:%801=218%:%
%:%802=218%:%
%:%803=218%:%
%:%804=219%:%
%:%805=219%:%
%:%806=219%:%
%:%807=219%:%
%:%808=219%:%
%:%809=220%:%
%:%815=220%:%
%:%818=221%:%
%:%819=222%:%
%:%820=223%:%
%:%821=223%:%
%:%828=224%:%
%:%829=224%:%
%:%830=225%:%
%:%831=225%:%
%:%832=225%:%
%:%833=225%:%
%:%834=226%:%
%:%835=226%:%
%:%836=226%:%
%:%837=226%:%
%:%838=227%:%
%:%853=231%:%
%:%863=234%:%
%:%864=234%:%
%:%871=235%:%
%:%872=235%:%
%:%873=236%:%
%:%874=236%:%
%:%875=237%:%
%:%876=237%:%
%:%877=237%:%
%:%878=238%:%
%:%879=238%:%
%:%880=238%:%
%:%881=239%:%
%:%882=239%:%
%:%883=239%:%
%:%884=240%:%
%:%885=240%:%
%:%886=241%:%
%:%887=241%:%
%:%888=241%:%
%:%889=241%:%
%:%890=242%:%
%:%891=242%:%
%:%896=242%:%
%:%899=243%:%
%:%900=244%:%
%:%901=244%:%
%:%908=245%:%
%:%909=245%:%
%:%910=246%:%
%:%911=246%:%
%:%912=247%:%
%:%913=247%:%
%:%914=248%:%
%:%915=248%:%
%:%916=248%:%
%:%917=248%:%
%:%918=248%:%
%:%919=249%:%
%:%920=249%:%
%:%921=249%:%
%:%922=249%:%
%:%923=250%:%
%:%924=250%:%
%:%925=250%:%
%:%926=250%:%
%:%927=251%:%
%:%928=251%:%
%:%929=251%:%
%:%930=252%:%
%:%931=252%:%
%:%932=252%:%
%:%933=253%:%
%:%934=253%:%
%:%935=254%:%
%:%936=254%:%
%:%937=254%:%
%:%938=255%:%
%:%939=255%:%
%:%940=255%:%
%:%941=256%:%
%:%942=256%:%
%:%943=257%:%
%:%949=257%:%
%:%952=258%:%
%:%953=259%:%
%:%954=259%:%
%:%961=260%:%
%:%962=260%:%
%:%963=261%:%
%:%964=261%:%
%:%965=262%:%
%:%966=262%:%
%:%967=263%:%
%:%968=263%:%
%:%969=263%:%
%:%970=264%:%
%:%971=264%:%
%:%972=265%:%
%:%973=265%:%
%:%974=265%:%
%:%975=266%:%
%:%976=266%:%
%:%977=266%:%
%:%978=267%:%
%:%979=267%:%
%:%980=268%:%
%:%981=268%:%
%:%982=268%:%
%:%983=269%:%
%:%984=269%:%
%:%985=269%:%
%:%986=270%:%
%:%987=270%:%
%:%988=271%:%
%:%994=271%:%
%:%997=272%:%
%:%998=273%:%
%:%999=273%:%
%:%1000=274%:%
%:%1007=275%:%
%:%1008=275%:%
%:%1009=276%:%
%:%1010=276%:%
%:%1011=277%:%
%:%1012=277%:%
%:%1013=278%:%
%:%1014=278%:%
%:%1015=278%:%
%:%1016=279%:%
%:%1017=279%:%
%:%1018=279%:%
%:%1019=280%:%
%:%1020=280%:%
%:%1021=280%:%
%:%1022=280%:%
%:%1023=281%:%
%:%1024=281%:%
%:%1025=282%:%
%:%1026=282%:%
%:%1027=283%:%
%:%1028=283%:%
%:%1029=284%:%
%:%1030=284%:%
%:%1031=284%:%
%:%1032=284%:%
%:%1033=284%:%
%:%1034=285%:%
%:%1035=285%:%
%:%1036=285%:%
%:%1037=285%:%
%:%1038=285%:%
%:%1039=286%:%
%:%1040=286%:%
%:%1041=287%:%
%:%1042=287%:%
%:%1043=288%:%
%:%1044=288%:%
%:%1045=288%:%
%:%1046=288%:%
%:%1047=289%:%
%:%1048=289%:%
%:%1049=289%:%
%:%1050=289%:%
%:%1051=290%:%
%:%1052=290%:%
%:%1053=291%:%
%:%1059=291%:%
%:%1062=292%:%
%:%1063=293%:%
%:%1064=293%:%
%:%1071=294%:%
%:%1072=294%:%
%:%1073=295%:%
%:%1074=295%:%
%:%1075=295%:%
%:%1076=295%:%
%:%1077=296%:%
%:%1078=296%:%
%:%1079=297%:%
%:%1080=297%:%
%:%1081=297%:%
%:%1082=298%:%
%:%1083=298%:%
%:%1084=298%:%
%:%1085=299%:%
%:%1086=299%:%
%:%1087=299%:%
%:%1088=300%:%
%:%1089=300%:%
%:%1090=301%:%
%:%1091=301%:%
%:%1092=301%:%
%:%1093=301%:%
%:%1094=301%:%
%:%1095=302%:%
%:%1101=302%:%
%:%1104=303%:%
%:%1105=304%:%
%:%1106=304%:%
%:%1113=305%:%
%:%1114=305%:%
%:%1115=306%:%
%:%1116=306%:%
%:%1117=307%:%
%:%1118=307%:%
%:%1119=307%:%
%:%1120=308%:%
%:%1121=308%:%
%:%1122=309%:%
%:%1123=309%:%
%:%1124=310%:%
%:%1125=310%:%
%:%1126=311%:%
%:%1141=315%:%
%:%1151=317%:%
%:%1152=317%:%
%:%1153=318%:%
%:%1154=319%:%
%:%1161=320%:%
%:%1162=320%:%
%:%1163=320%:%
%:%1164=321%:%
%:%1165=321%:%
%:%1166=322%:%
%:%1167=322%:%
%:%1168=323%:%
%:%1169=323%:%
%:%1170=324%:%
%:%1171=324%:%
%:%1172=325%:%
%:%1173=325%:%
%:%1174=325%:%
%:%1175=325%:%
%:%1176=326%:%
%:%1177=326%:%
%:%1178=327%:%
%:%1179=327%:%
%:%1180=328%:%
%:%1181=328%:%
%:%1182=328%:%
%:%1183=329%:%
%:%1184=329%:%
%:%1185=329%:%
%:%1186=329%:%
%:%1187=330%:%
%:%1188=330%:%
%:%1189=331%:%
%:%1190=331%:%
%:%1191=332%:%
%:%1192=332%:%
%:%1193=333%:%
%:%1194=333%:%
%:%1195=333%:%
%:%1196=333%:%
%:%1197=334%:%
%:%1198=334%:%
%:%1199=334%:%
%:%1200=334%:%
%:%1201=335%:%
%:%1202=335%:%
%:%1203=336%:%
%:%1204=336%:%
%:%1205=337%:%
%:%1206=337%:%
%:%1207=337%:%
%:%1208=338%:%
%:%1209=339%:%
%:%1210=339%:%
%:%1211=340%:%
%:%1212=340%:%
%:%1213=340%:%
%:%1214=340%:%
%:%1215=341%:%
%:%1216=341%:%
%:%1217=342%:%
%:%1218=342%:%
%:%1219=343%:%
%:%1220=343%:%
%:%1221=343%:%
%:%1222=344%:%
%:%1223=345%:%
%:%1224=345%:%
%:%1225=346%:%
%:%1226=346%:%
%:%1227=346%:%
%:%1228=347%:%
%:%1229=347%:%
%:%1230=348%:%
%:%1231=348%:%
%:%1232=348%:%
%:%1233=349%:%
%:%1234=349%:%
%:%1235=350%:%
%:%1236=350%:%
%:%1237=350%:%
%:%1238=350%:%
%:%1239=351%:%
%:%1240=351%:%
%:%1241=352%:%
%:%1242=352%:%
%:%1243=353%:%
%:%1244=353%:%
%:%1245=353%:%
%:%1246=354%:%
%:%1247=354%:%
%:%1248=354%:%
%:%1249=355%:%
%:%1250=355%:%
%:%1251=355%:%
%:%1252=355%:%
%:%1253=356%:%
%:%1254=356%:%
%:%1255=357%:%
%:%1256=357%:%
%:%1257=357%:%
%:%1258=357%:%
%:%1259=358%:%
%:%1265=358%:%
%:%1268=359%:%
%:%1269=360%:%
%:%1270=360%:%
%:%1271=361%:%
%:%1272=362%:%
%:%1279=363%:%
%:%1280=363%:%
%:%1281=364%:%
%:%1282=364%:%
%:%1283=365%:%
%:%1284=365%:%
%:%1285=365%:%
%:%1286=365%:%
%:%1287=366%:%
%:%1288=366%:%
%:%1289=366%:%
%:%1290=367%:%
%:%1291=367%:%
%:%1292=367%:%
%:%1293=367%:%
%:%1294=368%:%
%:%1295=368%:%
%:%1296=368%:%
%:%1297=368%:%
%:%1298=368%:%
%:%1299=369%:%
%:%1300=369%:%
%:%1301=369%:%
%:%1302=369%:%
%:%1303=370%:%
%:%1309=370%:%
%:%1312=371%:%
%:%1313=372%:%
%:%1314=373%:%
%:%1315=373%:%
%:%1316=374%:%
%:%1317=375%:%
%:%1318=376%:%
%:%1325=377%:%
%:%1326=377%:%
%:%1327=378%:%
%:%1328=378%:%
%:%1329=379%:%
%:%1330=379%:%
%:%1331=380%:%
%:%1332=380%:%
%:%1333=380%:%
%:%1334=381%:%
%:%1335=381%:%
%:%1336=381%:%
%:%1337=382%:%
%:%1338=382%:%
%:%1339=382%:%
%:%1340=383%:%
%:%1341=383%:%
%:%1342=383%:%
%:%1343=383%:%
%:%1344=383%:%
%:%1345=384%:%
%:%1346=384%:%
%:%1347=384%:%
%:%1348=384%:%
%:%1349=385%:%
%:%1364=389%:%
%:%1374=391%:%
%:%1375=391%:%
%:%1376=392%:%
%:%1377=393%:%
%:%1384=394%:%
%:%1385=394%:%
%:%1386=394%:%
%:%1387=395%:%
%:%1388=395%:%
%:%1389=396%:%
%:%1390=396%:%
%:%1391=396%:%
%:%1392=396%:%
%:%1393=397%:%
%:%1394=397%:%
%:%1395=398%:%
%:%1396=398%:%
%:%1397=399%:%
%:%1398=399%:%
%:%1399=399%:%
%:%1400=400%:%
%:%1401=400%:%
%:%1402=401%:%
%:%1403=401%:%
%:%1404=401%:%
%:%1405=401%:%
%:%1406=402%:%
%:%1407=402%:%
%:%1408=403%:%
%:%1409=403%:%
%:%1410=403%:%
%:%1411=403%:%
%:%1412=403%:%
%:%1413=404%:%
%:%1414=404%:%
%:%1415=404%:%
%:%1416=404%:%
%:%1417=405%:%
%:%1423=405%:%
%:%1426=406%:%
%:%1427=407%:%
%:%1428=407%:%
%:%1429=408%:%
%:%1430=409%:%
%:%1437=410%:%
%:%1438=410%:%
%:%1439=411%:%
%:%1440=411%:%
%:%1441=412%:%
%:%1442=412%:%
%:%1443=413%:%
%:%1444=413%:%
%:%1445=413%:%
%:%1446=414%:%
%:%1447=414%:%
%:%1448=414%:%
%:%1449=415%:%
%:%1450=415%:%
%:%1451=415%:%
%:%1452=415%:%
%:%1453=416%:%
%:%1454=416%:%
%:%1455=416%:%
%:%1456=416%:%
%:%1457=416%:%
%:%1458=417%:%
%:%1473=420%:%
%:%1483=422%:%
%:%1484=422%:%
%:%1485=423%:%
%:%1486=424%:%
%:%1487=425%:%
%:%1488=426%:%
%:%1489=426%:%
%:%1496=427%:%
%:%1497=427%:%
%:%1498=428%:%
%:%1499=428%:%
%:%1500=429%:%
%:%1501=429%:%
%:%1502=430%:%
%:%1503=430%:%
%:%1504=430%:%
%:%1505=431%:%
%:%1506=432%:%
%:%1507=432%:%
%:%1508=433%:%
%:%1509=433%:%
%:%1510=434%:%
%:%1511=434%:%
%:%1512=435%:%
%:%1513=435%:%
%:%1514=436%:%
%:%1515=436%:%
%:%1516=436%:%
%:%1517=437%:%
%:%1518=437%:%
%:%1519=437%:%
%:%1520=438%:%
%:%1521=438%:%
%:%1522=438%:%
%:%1523=439%:%
%:%1524=439%:%
%:%1525=439%:%
%:%1526=440%:%
%:%1527=440%:%
%:%1528=440%:%
%:%1529=440%:%
%:%1530=440%:%
%:%1531=441%:%
%:%1532=441%:%
%:%1533=441%:%
%:%1534=441%:%
%:%1535=441%:%
%:%1536=442%:%
%:%1537=442%:%
%:%1538=443%:%
%:%1544=443%:%
%:%1547=444%:%
%:%1548=445%:%
%:%1549=446%:%
%:%1550=446%:%
%:%1551=447%:%
%:%1552=448%:%
%:%1559=449%:%
%:%1560=449%:%
%:%1561=450%:%
%:%1562=450%:%
%:%1563=451%:%
%:%1564=451%:%
%:%1565=452%:%
%:%1566=452%:%
%:%1567=452%:%
%:%1568=453%:%
%:%1569=453%:%
%:%1570=453%:%
%:%1571=454%:%
%:%1572=454%:%
%:%1573=454%:%
%:%1574=454%:%
%:%1575=454%:%
%:%1576=455%:%
%:%1577=455%:%
%:%1578=455%:%
%:%1579=456%:%
%:%1580=456%:%
%:%1581=456%:%
%:%1582=457%:%
%:%1583=457%:%
%:%1584=457%:%
%:%1585=457%:%
%:%1586=458%:%
%:%1587=458%:%
%:%1588=458%:%
%:%1589=458%:%
%:%1590=458%:%
%:%1591=459%:%
%:%1592=459%:%
%:%1593=459%:%
%:%1594=459%:%
%:%1595=460%:%
%:%1596=460%:%
%:%1597=460%:%
%:%1598=460%:%
%:%1599=460%:%
%:%1600=461%:%
%:%1606=461%:%
%:%1609=462%:%
%:%1612=463%:%
%:%1617=464%:%
