%
\begin{isabellebody}%
\setisabellecontext{Parikh{\isacharunderscore}{\kern0pt}Img}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Parikh images%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Parikh{\isacharunderscore}{\kern0pt}Img\isanewline
\ \ \isakeywordTWO{imports}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}Reg{\isacharunderscore}{\kern0pt}Lang{\isacharunderscore}{\kern0pt}Exp{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}HOL{\isacharminus}{\kern0pt}Library{\isachardot}{\kern0pt}Multiset{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Definition and basic lemmas%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The Parikh vector of a finite word describes how often each symbol of the alphabet occurs in the word.
We represent parikh vectors by multisets. The Parikh image of a language \isa{L}, denoted by \isa{{\isasymPsi}\ L},
is then the set of Parikh vectors of all words in the language.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}vec\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isasymequiv}\ mset{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ multiset\ set{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}{\isachardoublequoteopen}{\isasymPsi}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}{\isasymPsi}\ L\ {\isasymequiv}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbackquote}{\kern0pt}\ L{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isasymunion}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymunion}\ {\isasymPsi}\ L{\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}L\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymUnion}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}L\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ I{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{1}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}L{\isadigit{2}}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ L{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}\ m{\isadigit{1}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{2}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ {\isacharbraceleft}{\kern0pt}\ m{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ m{\isadigit{1}}\ {\isacharbar}{\kern0pt}\ m{\isadigit{1}}\ m{\isadigit{2}}{\isachardot}{\kern0pt}\ m{\isadigit{1}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{1}}\ {\isasymand}\ m{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ L{\isadigit{2}}\ {\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ add{\isachardot}{\kern0pt}commute\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{1}}{\isacharbrackright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharbrackleft}{\kern0pt}of\ L{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Monotonicity properties%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ C{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}{\isasymPsi}\ B\ {\isasymsubseteq}\ {\isasymPsi}\ D{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ D{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ C{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}C\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B\ {\isasymLongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Orderings{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}iff\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}A\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}B\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{1}}{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ A\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ B\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}use\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isakeywordTWO{in}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}upd{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ A\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ B\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ v\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ assms\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f\ rule{\isacharcolon}{\kern0pt}\ rlexp{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharprime}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ vars{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ SUP{\isacharunderscore}{\kern0pt}mono{\isacharprime}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymin}\ vars\ f{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$\Psi \; (A \cup B)^* = \Psi \; A^* B^*$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This property is claimed by Pilling in \cite{Pilling} and will be needed later.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymand}\ parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isacharequal}{\kern0pt}\ w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isasymunion}\ B\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isadigit{1}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{1}}{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}v{\isadigit{2}}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ w{\isadigit{2}}\ {\isasymand}\isanewline
\ \ \ \ \ \ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ i{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}i\ {\isasymle}\ n\ {\isasymand}\ w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ Suc\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Suc\ i\ {\isasymle}\ Suc\ n{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n\ {\isacharminus}{\kern0pt}\ Suc\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc{\isacharunderscore}{\kern0pt}i{\isacharunderscore}{\kern0pt}valid\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharparenleft}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Suc{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}le\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ i{\isacharunderscore}{\kern0pt}intro\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ i{\isacharunderscore}{\kern0pt}intro\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{using}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}n{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i\ {\isasymle}\ n{\isachardot}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}union{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}i{\isasymle}n{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ \isakeywordTWO{where}\ {\isachardoublequoteopen}i{\isasymle}n\ {\isasymand}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}n{\isacharminus}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ star\ A{\isachardoublequoteclose}\ \isakeywordTWO{and}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ w\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ w\ {\isasymin}\ star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w{\isadigit{1}}\ w{\isadigit{2}}\ \isakeywordTWO{where}\ w{\isacharunderscore}{\kern0pt}decomp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isacharequal}{\kern0pt}w{\isadigit{1}}{\isacharat}{\kern0pt}w{\isadigit{2}}\ {\isasymand}\ w{\isadigit{1}}\ {\isasymin}\ star\ A\ {\isasymand}\ w{\isadigit{2}}\ {\isasymin}\ star\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ i\ j\ \isakeywordTWO{where}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordTWO{and}\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w{\isadigit{1}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ w{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w{\isadigit{2}}\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ j{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ langpow{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isadigit{1}}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}union\ w{\isacharunderscore}{\kern0pt}decomp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}i{\isacharplus}{\kern0pt}j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ lang{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}add\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$\Psi \; (E^* F)^* = \Psi \; \left(\{\varepsilon\} \cup E^* F^* F\right)$%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This property (where $\varepsilon$ denotes the empty word) is claimed by
Pilling as well \cite{Pilling}; we will use it later.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ conc{\isacharunderscore}{\kern0pt}assoc\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}comm\ lang{\isacharunderscore}{\kern0pt}pow{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ B\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ Sup{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ rangeI\ subset{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ {\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}pow{\isadigit{2}}\ v{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}n\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UnCI\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}idemp{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}F\ {\isasymsubseteq}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ star{\isacharunderscore}{\kern0pt}def\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ inf{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}ord{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{using}\isamarkupfalse%
\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}comm\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{1}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}{\isacharunderscore}{\kern0pt}aux{\isadigit{2}}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ F\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ E\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ F{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ le{\isacharunderscore}{\kern0pt}sup{\isacharunderscore}{\kern0pt}iff\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left\ sup{\isachardot}{\kern0pt}cobounded{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{A homogeneous-like property for regular functions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ x\ {\isacharequal}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ Z{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Var\ assms\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Nil{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}star\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ subsetI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ False\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ concI{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}Nil{\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Union\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isachardot}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f\ g{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}subset{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ g\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}star{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}star\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ Y\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharparenleft}{\kern0pt}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Now we can prove the desired homogeneous-like property which will become useful later.
Notably this property slightly differs from the property claimed in \cite{Pilling}. However, our
property is easier to prove formally and it suffices for the rest of the proof.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ z{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ f{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}L\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}L\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}upd{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}f{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ y\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}of\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}R{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ z\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Extension of Arden's lemma to Parikh images%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isachardot}{\kern0pt}orderE\ sup{\isachardot}{\kern0pt}orderI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}prems\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ X\ {\isasymunion}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ X{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}star\ A\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}UNION{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}UNION{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ n\ \isakeywordTWO{where}\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}A\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymPsi}\ X{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Equivalence class of languages with identical Parikh image%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
For a given language \isa{L}, we define the equivalence class of all languages with identical Parikh
image:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ lang\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ lang\ set{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ L\ {\isasymequiv}\ {\isacharbraceleft}{\kern0pt}L{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymPsi}\ L{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ L{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Union{\isacharunderscore}{\kern0pt}upper\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ a\ \isakeywordTWO{where}\ a{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isacharequal}{\kern0pt}\ v\ {\isasymand}\ a\ {\isasymin}\ {\isacharquery}{\kern0pt}A{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ L\ \isakeywordTWO{where}\ L{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ L\ {\isasymand}\ L\ {\isasymin}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ L\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}intro\ L{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isasymin}\ {\isasymPsi}\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ subseteq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}subseteq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ B{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ B{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}A\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ a\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isasymin}\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ A\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A\ \isakeywordONE{have}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymin}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}b{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ b\ \isakeywordTWO{where}\ b{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}vec\ b\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}vec\ a\ {\isasymand}\ b\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ vec{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}B{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}a{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ B{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}a\ {\isasymin}\ {\isacharquery}{\kern0pt}B{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/studium/semester_7/semantik/homeworks/AIST/Parikh/Parikh_Img.thy%:%
%:%11=1%:%
%:%27=3%:%
%:%28=3%:%
%:%29=4%:%
%:%30=5%:%
%:%31=6%:%
%:%32=7%:%
%:%46=10%:%
%:%58=12%:%
%:%59=13%:%
%:%60=14%:%
%:%62=16%:%
%:%63=16%:%
%:%64=17%:%
%:%65=18%:%
%:%66=19%:%
%:%67=19%:%
%:%68=20%:%
%:%69=21%:%
%:%70=22%:%
%:%71=22%:%
%:%74=23%:%
%:%78=23%:%
%:%79=23%:%
%:%84=23%:%
%:%87=24%:%
%:%88=25%:%
%:%89=25%:%
%:%92=26%:%
%:%96=26%:%
%:%97=26%:%
%:%102=26%:%
%:%105=27%:%
%:%106=28%:%
%:%107=28%:%
%:%110=29%:%
%:%114=29%:%
%:%115=29%:%
%:%116=29%:%
%:%121=29%:%
%:%124=30%:%
%:%125=31%:%
%:%126=31%:%
%:%133=32%:%
%:%134=32%:%
%:%135=33%:%
%:%136=33%:%
%:%137=34%:%
%:%138=35%:%
%:%139=35%:%
%:%140=35%:%
%:%141=36%:%
%:%142=36%:%
%:%143=36%:%
%:%144=37%:%
%:%145=37%:%
%:%146=37%:%
%:%147=38%:%
%:%162=41%:%
%:%172=43%:%
%:%173=43%:%
%:%176=44%:%
%:%180=44%:%
%:%181=44%:%
%:%182=44%:%
%:%187=44%:%
%:%190=45%:%
%:%191=46%:%
%:%192=46%:%
%:%195=47%:%
%:%199=47%:%
%:%200=47%:%
%:%205=47%:%
%:%208=48%:%
%:%209=49%:%
%:%210=49%:%
%:%213=50%:%
%:%217=50%:%
%:%218=50%:%
%:%223=50%:%
%:%226=51%:%
%:%227=52%:%
%:%228=52%:%
%:%229=53%:%
%:%230=54%:%
%:%231=55%:%
%:%234=56%:%
%:%238=56%:%
%:%239=56%:%
%:%240=56%:%
%:%245=56%:%
%:%248=57%:%
%:%249=58%:%
%:%250=58%:%
%:%253=59%:%
%:%257=59%:%
%:%258=59%:%
%:%263=59%:%
%:%266=60%:%
%:%267=61%:%
%:%268=61%:%
%:%271=62%:%
%:%275=62%:%
%:%276=62%:%
%:%281=62%:%
%:%284=63%:%
%:%285=64%:%
%:%286=64%:%
%:%289=65%:%
%:%293=65%:%
%:%294=65%:%
%:%299=65%:%
%:%302=66%:%
%:%303=67%:%
%:%304=68%:%
%:%305=68%:%
%:%306=69%:%
%:%307=70%:%
%:%314=71%:%
%:%315=71%:%
%:%316=72%:%
%:%317=72%:%
%:%318=73%:%
%:%319=73%:%
%:%320=74%:%
%:%321=74%:%
%:%322=74%:%
%:%323=74%:%
%:%324=74%:%
%:%325=75%:%
%:%326=75%:%
%:%327=75%:%
%:%328=75%:%
%:%329=75%:%
%:%330=76%:%
%:%331=76%:%
%:%332=76%:%
%:%333=76%:%
%:%334=76%:%
%:%335=76%:%
%:%336=77%:%
%:%337=77%:%
%:%338=77%:%
%:%339=77%:%
%:%340=77%:%
%:%341=78%:%
%:%342=78%:%
%:%343=78%:%
%:%344=78%:%
%:%345=78%:%
%:%346=78%:%
%:%347=79%:%
%:%353=79%:%
%:%356=80%:%
%:%357=81%:%
%:%358=81%:%
%:%359=82%:%
%:%360=83%:%
%:%363=84%:%
%:%367=84%:%
%:%368=84%:%
%:%369=84%:%
%:%374=84%:%
%:%377=85%:%
%:%378=86%:%
%:%379=87%:%
%:%380=87%:%
%:%381=88%:%
%:%382=89%:%
%:%389=90%:%
%:%390=90%:%
%:%391=91%:%
%:%392=91%:%
%:%393=92%:%
%:%394=92%:%
%:%395=92%:%
%:%396=93%:%
%:%397=94%:%
%:%398=94%:%
%:%399=94%:%
%:%400=95%:%
%:%401=95%:%
%:%402=95%:%
%:%403=95%:%
%:%404=96%:%
%:%405=96%:%
%:%406=97%:%
%:%407=97%:%
%:%408=98%:%
%:%409=98%:%
%:%410=98%:%
%:%411=99%:%
%:%412=99%:%
%:%413=99%:%
%:%414=100%:%
%:%415=100%:%
%:%416=100%:%
%:%417=100%:%
%:%418=101%:%
%:%419=101%:%
%:%424=101%:%
%:%427=102%:%
%:%428=103%:%
%:%429=103%:%
%:%430=104%:%
%:%431=105%:%
%:%434=106%:%
%:%438=106%:%
%:%439=106%:%
%:%440=106%:%
%:%445=106%:%
%:%448=107%:%
%:%449=108%:%
%:%450=108%:%
%:%451=109%:%
%:%452=110%:%
%:%459=111%:%
%:%460=111%:%
%:%461=111%:%
%:%462=112%:%
%:%463=112%:%
%:%464=113%:%
%:%465=113%:%
%:%466=113%:%
%:%467=114%:%
%:%468=114%:%
%:%469=114%:%
%:%470=115%:%
%:%471=115%:%
%:%472=115%:%
%:%473=115%:%
%:%474=116%:%
%:%475=116%:%
%:%480=116%:%
%:%483=117%:%
%:%484=118%:%
%:%485=118%:%
%:%486=119%:%
%:%487=120%:%
%:%490=121%:%
%:%494=121%:%
%:%495=121%:%
%:%496=121%:%
%:%510=125%:%
%:%522=127%:%
%:%524=129%:%
%:%525=129%:%
%:%526=130%:%
%:%527=131%:%
%:%534=132%:%
%:%535=132%:%
%:%536=132%:%
%:%537=133%:%
%:%538=133%:%
%:%539=134%:%
%:%540=134%:%
%:%541=134%:%
%:%542=134%:%
%:%543=135%:%
%:%544=135%:%
%:%545=136%:%
%:%546=136%:%
%:%547=137%:%
%:%548=137%:%
%:%549=137%:%
%:%550=138%:%
%:%551=138%:%
%:%552=138%:%
%:%553=139%:%
%:%554=139%:%
%:%555=139%:%
%:%556=139%:%
%:%557=140%:%
%:%558=140%:%
%:%559=141%:%
%:%560=141%:%
%:%561=141%:%
%:%562=141%:%
%:%563=141%:%
%:%564=142%:%
%:%565=142%:%
%:%566=142%:%
%:%567=142%:%
%:%568=143%:%
%:%569=143%:%
%:%570=143%:%
%:%571=144%:%
%:%572=144%:%
%:%573=144%:%
%:%574=145%:%
%:%575=145%:%
%:%576=145%:%
%:%577=145%:%
%:%578=146%:%
%:%579=146%:%
%:%580=146%:%
%:%581=147%:%
%:%582=147%:%
%:%583=148%:%
%:%584=148%:%
%:%585=148%:%
%:%586=149%:%
%:%587=149%:%
%:%588=150%:%
%:%589=150%:%
%:%590=151%:%
%:%591=151%:%
%:%592=151%:%
%:%593=152%:%
%:%594=152%:%
%:%595=153%:%
%:%596=153%:%
%:%597=153%:%
%:%598=154%:%
%:%599=154%:%
%:%600=154%:%
%:%601=155%:%
%:%602=155%:%
%:%603=155%:%
%:%604=155%:%
%:%605=156%:%
%:%606=156%:%
%:%607=157%:%
%:%608=157%:%
%:%609=158%:%
%:%610=158%:%
%:%611=158%:%
%:%612=158%:%
%:%613=159%:%
%:%614=159%:%
%:%615=159%:%
%:%616=160%:%
%:%617=160%:%
%:%618=160%:%
%:%619=161%:%
%:%620=161%:%
%:%621=161%:%
%:%622=162%:%
%:%623=162%:%
%:%624=163%:%
%:%625=163%:%
%:%626=164%:%
%:%627=164%:%
%:%628=164%:%
%:%629=164%:%
%:%630=165%:%
%:%631=165%:%
%:%632=166%:%
%:%633=166%:%
%:%634=166%:%
%:%635=166%:%
%:%636=166%:%
%:%637=167%:%
%:%643=167%:%
%:%646=168%:%
%:%647=169%:%
%:%648=169%:%
%:%649=170%:%
%:%650=171%:%
%:%657=172%:%
%:%658=172%:%
%:%659=173%:%
%:%660=173%:%
%:%661=173%:%
%:%662=174%:%
%:%663=174%:%
%:%664=174%:%
%:%665=174%:%
%:%666=175%:%
%:%667=175%:%
%:%668=175%:%
%:%669=175%:%
%:%670=176%:%
%:%671=176%:%
%:%672=176%:%
%:%673=177%:%
%:%674=177%:%
%:%675=177%:%
%:%676=178%:%
%:%677=178%:%
%:%678=178%:%
%:%679=178%:%
%:%680=178%:%
%:%681=179%:%
%:%682=179%:%
%:%683=179%:%
%:%684=179%:%
%:%685=180%:%
%:%686=180%:%
%:%687=180%:%
%:%688=181%:%
%:%689=181%:%
%:%690=181%:%
%:%691=182%:%
%:%692=182%:%
%:%693=182%:%
%:%694=182%:%
%:%695=183%:%
%:%696=183%:%
%:%697=183%:%
%:%698=183%:%
%:%699=184%:%
%:%700=184%:%
%:%701=184%:%
%:%702=184%:%
%:%703=185%:%
%:%704=185%:%
%:%705=185%:%
%:%706=185%:%
%:%707=185%:%
%:%708=186%:%
%:%714=186%:%
%:%717=187%:%
%:%718=188%:%
%:%719=188%:%
%:%720=189%:%
%:%721=190%:%
%:%728=191%:%
%:%729=191%:%
%:%730=192%:%
%:%731=192%:%
%:%732=192%:%
%:%733=193%:%
%:%734=193%:%
%:%735=193%:%
%:%736=194%:%
%:%737=194%:%
%:%738=194%:%
%:%739=194%:%
%:%740=195%:%
%:%741=195%:%
%:%742=195%:%
%:%743=195%:%
%:%744=195%:%
%:%745=196%:%
%:%746=196%:%
%:%747=196%:%
%:%748=196%:%
%:%749=196%:%
%:%750=197%:%
%:%751=197%:%
%:%752=197%:%
%:%753=197%:%
%:%754=197%:%
%:%755=198%:%
%:%756=198%:%
%:%757=198%:%
%:%758=198%:%
%:%759=198%:%
%:%760=199%:%
%:%761=199%:%
%:%762=199%:%
%:%763=199%:%
%:%764=199%:%
%:%765=200%:%
%:%771=200%:%
%:%774=201%:%
%:%775=202%:%
%:%776=202%:%
%:%783=203%:%
%:%784=203%:%
%:%785=204%:%
%:%786=204%:%
%:%787=204%:%
%:%788=204%:%
%:%789=205%:%
%:%790=205%:%
%:%791=205%:%
%:%792=205%:%
%:%793=206%:%
%:%808=210%:%
%:%820=212%:%
%:%821=213%:%
%:%823=216%:%
%:%824=216%:%
%:%831=217%:%
%:%832=217%:%
%:%833=218%:%
%:%834=218%:%
%:%835=219%:%
%:%836=219%:%
%:%837=219%:%
%:%838=220%:%
%:%839=220%:%
%:%840=220%:%
%:%841=221%:%
%:%842=221%:%
%:%843=221%:%
%:%844=222%:%
%:%845=222%:%
%:%846=223%:%
%:%847=223%:%
%:%848=223%:%
%:%849=223%:%
%:%850=224%:%
%:%851=224%:%
%:%856=224%:%
%:%859=225%:%
%:%860=226%:%
%:%861=226%:%
%:%868=227%:%
%:%869=227%:%
%:%870=228%:%
%:%871=228%:%
%:%872=229%:%
%:%873=229%:%
%:%874=230%:%
%:%875=230%:%
%:%876=230%:%
%:%877=230%:%
%:%878=230%:%
%:%879=231%:%
%:%880=231%:%
%:%881=231%:%
%:%882=231%:%
%:%883=232%:%
%:%884=232%:%
%:%885=232%:%
%:%886=232%:%
%:%887=233%:%
%:%888=233%:%
%:%889=233%:%
%:%890=234%:%
%:%891=234%:%
%:%892=234%:%
%:%893=235%:%
%:%894=235%:%
%:%895=236%:%
%:%896=236%:%
%:%897=236%:%
%:%898=237%:%
%:%899=237%:%
%:%900=237%:%
%:%901=238%:%
%:%902=238%:%
%:%903=239%:%
%:%909=239%:%
%:%912=240%:%
%:%913=241%:%
%:%914=241%:%
%:%921=242%:%
%:%922=242%:%
%:%923=243%:%
%:%924=243%:%
%:%925=244%:%
%:%926=244%:%
%:%927=245%:%
%:%928=245%:%
%:%929=245%:%
%:%930=246%:%
%:%931=246%:%
%:%932=247%:%
%:%933=247%:%
%:%934=247%:%
%:%935=248%:%
%:%936=248%:%
%:%937=248%:%
%:%938=249%:%
%:%939=249%:%
%:%940=250%:%
%:%941=250%:%
%:%942=250%:%
%:%943=251%:%
%:%944=251%:%
%:%945=251%:%
%:%946=252%:%
%:%947=252%:%
%:%948=253%:%
%:%954=253%:%
%:%957=254%:%
%:%958=255%:%
%:%959=255%:%
%:%960=256%:%
%:%967=257%:%
%:%968=257%:%
%:%969=258%:%
%:%970=258%:%
%:%971=259%:%
%:%972=259%:%
%:%973=260%:%
%:%974=260%:%
%:%975=260%:%
%:%976=261%:%
%:%977=261%:%
%:%978=261%:%
%:%979=262%:%
%:%980=262%:%
%:%981=262%:%
%:%982=262%:%
%:%983=263%:%
%:%984=263%:%
%:%985=264%:%
%:%986=264%:%
%:%987=265%:%
%:%988=265%:%
%:%989=266%:%
%:%990=266%:%
%:%991=266%:%
%:%992=266%:%
%:%993=266%:%
%:%994=267%:%
%:%995=267%:%
%:%996=267%:%
%:%997=267%:%
%:%998=267%:%
%:%999=268%:%
%:%1000=268%:%
%:%1001=269%:%
%:%1002=269%:%
%:%1003=270%:%
%:%1004=270%:%
%:%1005=270%:%
%:%1006=270%:%
%:%1007=271%:%
%:%1008=271%:%
%:%1009=271%:%
%:%1010=271%:%
%:%1011=272%:%
%:%1012=272%:%
%:%1013=273%:%
%:%1019=273%:%
%:%1022=274%:%
%:%1023=275%:%
%:%1024=275%:%
%:%1031=276%:%
%:%1032=276%:%
%:%1033=277%:%
%:%1034=277%:%
%:%1035=277%:%
%:%1036=277%:%
%:%1037=278%:%
%:%1038=278%:%
%:%1039=279%:%
%:%1040=279%:%
%:%1041=279%:%
%:%1042=280%:%
%:%1043=280%:%
%:%1044=280%:%
%:%1045=281%:%
%:%1046=281%:%
%:%1047=281%:%
%:%1048=282%:%
%:%1049=282%:%
%:%1050=283%:%
%:%1051=283%:%
%:%1052=283%:%
%:%1053=283%:%
%:%1054=283%:%
%:%1055=284%:%
%:%1061=284%:%
%:%1064=285%:%
%:%1065=286%:%
%:%1066=286%:%
%:%1073=287%:%
%:%1074=287%:%
%:%1075=288%:%
%:%1076=288%:%
%:%1077=289%:%
%:%1078=289%:%
%:%1079=289%:%
%:%1080=290%:%
%:%1081=290%:%
%:%1082=291%:%
%:%1083=291%:%
%:%1084=292%:%
%:%1085=292%:%
%:%1086=293%:%
%:%1101=297%:%
%:%1111=299%:%
%:%1112=299%:%
%:%1113=300%:%
%:%1114=301%:%
%:%1121=302%:%
%:%1122=302%:%
%:%1123=303%:%
%:%1124=303%:%
%:%1125=304%:%
%:%1126=304%:%
%:%1127=305%:%
%:%1128=305%:%
%:%1129=306%:%
%:%1130=306%:%
%:%1131=307%:%
%:%1132=307%:%
%:%1133=307%:%
%:%1134=307%:%
%:%1135=308%:%
%:%1136=308%:%
%:%1137=309%:%
%:%1138=309%:%
%:%1139=310%:%
%:%1140=310%:%
%:%1141=310%:%
%:%1142=311%:%
%:%1143=311%:%
%:%1144=311%:%
%:%1145=311%:%
%:%1146=312%:%
%:%1147=312%:%
%:%1148=313%:%
%:%1149=313%:%
%:%1150=314%:%
%:%1151=314%:%
%:%1152=315%:%
%:%1153=315%:%
%:%1154=315%:%
%:%1155=315%:%
%:%1156=316%:%
%:%1157=316%:%
%:%1158=316%:%
%:%1159=316%:%
%:%1160=317%:%
%:%1161=317%:%
%:%1162=318%:%
%:%1163=318%:%
%:%1164=319%:%
%:%1165=319%:%
%:%1166=319%:%
%:%1167=320%:%
%:%1168=321%:%
%:%1169=321%:%
%:%1170=322%:%
%:%1171=322%:%
%:%1172=322%:%
%:%1173=322%:%
%:%1174=323%:%
%:%1175=323%:%
%:%1176=324%:%
%:%1177=324%:%
%:%1178=325%:%
%:%1179=325%:%
%:%1180=325%:%
%:%1181=326%:%
%:%1182=327%:%
%:%1183=327%:%
%:%1184=328%:%
%:%1185=328%:%
%:%1186=328%:%
%:%1187=329%:%
%:%1188=329%:%
%:%1189=330%:%
%:%1190=330%:%
%:%1191=330%:%
%:%1192=331%:%
%:%1193=331%:%
%:%1194=332%:%
%:%1195=332%:%
%:%1196=332%:%
%:%1197=332%:%
%:%1198=333%:%
%:%1199=333%:%
%:%1200=334%:%
%:%1201=334%:%
%:%1202=335%:%
%:%1203=335%:%
%:%1204=335%:%
%:%1205=336%:%
%:%1206=336%:%
%:%1207=336%:%
%:%1208=337%:%
%:%1209=337%:%
%:%1210=337%:%
%:%1211=337%:%
%:%1212=338%:%
%:%1213=338%:%
%:%1214=339%:%
%:%1215=339%:%
%:%1216=339%:%
%:%1217=339%:%
%:%1218=340%:%
%:%1228=342%:%
%:%1229=343%:%
%:%1230=344%:%
%:%1232=345%:%
%:%1233=345%:%
%:%1234=346%:%
%:%1235=347%:%
%:%1242=348%:%
%:%1243=348%:%
%:%1244=349%:%
%:%1245=349%:%
%:%1246=350%:%
%:%1247=350%:%
%:%1248=350%:%
%:%1249=350%:%
%:%1250=351%:%
%:%1251=351%:%
%:%1252=351%:%
%:%1253=352%:%
%:%1254=352%:%
%:%1255=352%:%
%:%1256=352%:%
%:%1257=353%:%
%:%1258=353%:%
%:%1259=353%:%
%:%1260=353%:%
%:%1261=353%:%
%:%1262=354%:%
%:%1263=354%:%
%:%1264=354%:%
%:%1265=354%:%
%:%1266=355%:%
%:%1281=358%:%
%:%1291=360%:%
%:%1292=360%:%
%:%1293=361%:%
%:%1294=362%:%
%:%1301=363%:%
%:%1302=363%:%
%:%1303=364%:%
%:%1304=364%:%
%:%1305=365%:%
%:%1306=365%:%
%:%1307=365%:%
%:%1308=365%:%
%:%1309=366%:%
%:%1310=366%:%
%:%1311=367%:%
%:%1312=367%:%
%:%1313=368%:%
%:%1314=368%:%
%:%1315=368%:%
%:%1316=369%:%
%:%1317=369%:%
%:%1318=370%:%
%:%1319=370%:%
%:%1320=370%:%
%:%1321=370%:%
%:%1322=371%:%
%:%1323=371%:%
%:%1324=372%:%
%:%1325=372%:%
%:%1326=372%:%
%:%1327=372%:%
%:%1328=372%:%
%:%1329=373%:%
%:%1330=373%:%
%:%1331=373%:%
%:%1332=373%:%
%:%1333=374%:%
%:%1339=374%:%
%:%1342=375%:%
%:%1343=376%:%
%:%1344=376%:%
%:%1345=377%:%
%:%1346=378%:%
%:%1353=379%:%
%:%1354=379%:%
%:%1355=380%:%
%:%1356=380%:%
%:%1357=381%:%
%:%1358=381%:%
%:%1359=382%:%
%:%1360=382%:%
%:%1361=382%:%
%:%1362=383%:%
%:%1363=383%:%
%:%1364=383%:%
%:%1365=384%:%
%:%1366=384%:%
%:%1367=384%:%
%:%1368=384%:%
%:%1369=385%:%
%:%1370=385%:%
%:%1371=385%:%
%:%1372=385%:%
%:%1373=385%:%
%:%1374=386%:%
%:%1389=389%:%
%:%1401=391%:%
%:%1402=392%:%
%:%1404=394%:%
%:%1405=394%:%
%:%1406=395%:%
%:%1407=396%:%
%:%1408=397%:%
%:%1409=397%:%
%:%1416=398%:%
%:%1417=398%:%
%:%1418=399%:%
%:%1419=399%:%
%:%1420=400%:%
%:%1421=400%:%
%:%1422=401%:%
%:%1423=401%:%
%:%1424=401%:%
%:%1425=402%:%
%:%1426=402%:%
%:%1427=403%:%
%:%1428=403%:%
%:%1429=404%:%
%:%1430=404%:%
%:%1431=405%:%
%:%1432=405%:%
%:%1433=406%:%
%:%1434=406%:%
%:%1435=406%:%
%:%1436=407%:%
%:%1437=407%:%
%:%1438=407%:%
%:%1439=408%:%
%:%1440=408%:%
%:%1441=408%:%
%:%1442=409%:%
%:%1443=409%:%
%:%1444=409%:%
%:%1445=410%:%
%:%1446=410%:%
%:%1447=410%:%
%:%1448=410%:%
%:%1449=410%:%
%:%1450=411%:%
%:%1451=411%:%
%:%1452=411%:%
%:%1453=411%:%
%:%1454=411%:%
%:%1455=412%:%
%:%1456=412%:%
%:%1457=413%:%
%:%1463=413%:%
%:%1466=414%:%
%:%1467=415%:%
%:%1468=415%:%
%:%1469=416%:%
%:%1470=417%:%
%:%1477=418%:%
%:%1478=418%:%
%:%1479=419%:%
%:%1480=419%:%
%:%1481=420%:%
%:%1482=420%:%
%:%1483=421%:%
%:%1484=421%:%
%:%1485=421%:%
%:%1486=422%:%
%:%1487=422%:%
%:%1488=422%:%
%:%1489=423%:%
%:%1490=423%:%
%:%1491=423%:%
%:%1492=423%:%
%:%1493=423%:%
%:%1494=424%:%
%:%1495=424%:%
%:%1496=424%:%
%:%1497=425%:%
%:%1498=425%:%
%:%1499=425%:%
%:%1500=426%:%
%:%1501=426%:%
%:%1502=426%:%
%:%1503=426%:%
%:%1504=427%:%
%:%1505=427%:%
%:%1506=427%:%
%:%1507=427%:%
%:%1508=427%:%
%:%1509=428%:%
%:%1510=428%:%
%:%1511=428%:%
%:%1512=428%:%
%:%1513=429%:%
%:%1514=429%:%
%:%1515=429%:%
%:%1516=429%:%
%:%1517=429%:%
%:%1518=430%:%
%:%1524=430%:%
%:%1529=431%:%
%:%1534=432%:%
