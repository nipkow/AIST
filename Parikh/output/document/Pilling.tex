%
\begin{isabellebody}%
\setisabellecontext{Pilling}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Pilling\isanewline
\ \ \isakeywordTWO{imports}\ \isanewline
\ \ \ \ {\isachardoublequoteopen}CFG{\isachardot}{\kern0pt}CFL{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Lfun{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Parikh{\isacharunderscore}{\kern0pt}Img{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Eq{\isacharunderscore}{\kern0pt}Sys{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Regular{\isacharminus}{\kern0pt}Sets{\isachardot}{\kern0pt}Regular{\isacharunderscore}{\kern0pt}Exp{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
We prove Parikh's theorem, closely following Pilling's proof (TODO: citation). The rough
idea is as follows: Each CFG can be interpreted as a system of equations. Pilling shows that
there is a regular solution to this system if one applies the Parikh image on both sides of each
equation (in the following, we will call this modified system of equations the "commutative system
of equations") and that this solution is furthermore minimal. Since the CFL minimally solves
the commutative system of equations as well (see Eq_Sys.thy for a proof), the Parikh image of the
CFL and the regular solution must be identical, proving Parikh's theorem.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Special representation of regular language expressions%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
To each regular language expression and variable \isa{x} corresponds a second regular language
expression with the same Parikh image and of the form \isa{p\ {\isasymunion}\ q\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ Var\ x} (see equation 3 in Pilling's paper)
where p does not depend on x. We call regular language expressions of this form "bipartite regular
language expressions":%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f\ {\isasymequiv}\ {\isasymexists}p\ q{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ p\ {\isasymand}\ reg{\isacharunderscore}{\kern0pt}eval\ q\ {\isasymand}\isanewline
\ \ \ \ f\ {\isacharequal}{\kern0pt}\ Union\ p\ {\isacharparenleft}{\kern0pt}Concat\ q\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ x\ {\isasymnotin}\ vars\ p{\isachardoublequoteclose}%
\begin{isamarkuptext}%
All bipartite regular language expressions evaluate to regular languages:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f\ {\isasymLongrightarrow}\ reg{\isacharunderscore}{\kern0pt}eval\ f{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
For each reg_eval regular language expression and variable \isa{x}, there exists a bipartite
regular language expression with identical Parikh image and almost identical set of variables.
We first prove some auxiliary lemmas%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Variable{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isacharparenleft}{\kern0pt}Const\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Const\ {\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ emptyset{\isacharunderscore}{\kern0pt}regular\ epsilon{\isacharunderscore}{\kern0pt}regular\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordTWO{for}\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ valuation{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ True\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ True\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Const\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ emptyset{\isacharunderscore}{\kern0pt}regular\ epsilon{\isacharunderscore}{\kern0pt}regular\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordTWO{for}\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ valuation{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ False\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Var\ y{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Const{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}regular{\isacharunderscore}{\kern0pt}lang\ l{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Const\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ assms\ emptyset{\isacharunderscore}{\kern0pt}regular\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordTWO{for}\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ valuation{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Const\ l{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\ \isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Union{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{1}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Union\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Union\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ f{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{1}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ f{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ p{\isadigit{1}}\ q{\isadigit{1}}\ p{\isadigit{2}}\ q{\isadigit{2}}\ \isakeywordTWO{where}\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ p{\isadigit{1}}\ {\isasymand}\ reg{\isacharunderscore}{\kern0pt}eval\ q{\isadigit{1}}\ {\isasymand}\isanewline
\ \ \ \ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Union\ p{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}Concat\ q{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}y\ {\isasymin}\ vars\ p{\isadigit{1}}{\isachardot}{\kern0pt}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ p{\isadigit{2}}\ {\isasymand}\ reg{\isacharunderscore}{\kern0pt}eval\ q{\isadigit{2}}\ {\isasymand}\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Union\ p{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}Concat\ q{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}y\ {\isasymin}\ vars\ p{\isadigit{2}}{\isachardot}{\kern0pt}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isacharparenleft}{\kern0pt}Union\ p{\isadigit{1}}\ p{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Union\ q{\isadigit{1}}\ q{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Union\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ v\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ f{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ f{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ sup{\isacharunderscore}{\kern0pt}assoc\ sup{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ f{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Union\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Concat{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{1}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ f{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{1}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ f{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f{\isadigit{2}}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ p{\isadigit{1}}\ q{\isadigit{1}}\ p{\isadigit{2}}\ q{\isadigit{2}}\ \isakeywordTWO{where}\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ p{\isadigit{1}}\ {\isasymand}\ reg{\isacharunderscore}{\kern0pt}eval\ q{\isadigit{1}}\ {\isasymand}\isanewline
\ \ \ \ f{\isadigit{1}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Union\ p{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}Concat\ q{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}y\ {\isasymin}\ vars\ p{\isadigit{1}}{\isachardot}{\kern0pt}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ p{\isadigit{2}}\ {\isasymand}\ reg{\isacharunderscore}{\kern0pt}eval\ q{\isadigit{2}}\ {\isasymand}\ f{\isadigit{2}}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Union\ p{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}Concat\ q{\isadigit{2}}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}y\ {\isasymin}\ vars\ p{\isadigit{2}}{\isachardot}{\kern0pt}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isacharparenleft}{\kern0pt}Concat\ q{\isadigit{1}}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}\ q{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Union\ {\isacharparenleft}{\kern0pt}Concat\ p{\isadigit{1}}\ q{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ q{\isadigit{1}}\ p{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isacharparenleft}{\kern0pt}Concat\ p{\isadigit{1}}\ p{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharquery}{\kern0pt}q{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}subst{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{2}}\ v\ {\isasymunion}\ eval\ q{\isadigit{2}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ f{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}eval\ p{\isadigit{1}}\ v\ {\isasymunion}\ eval\ q{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro\ f{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v\ {\isasymunion}\ eval\ q{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ f{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{2}}\ v\ {\isasymunion}\ eval\ q{\isadigit{2}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isasymunion}\ eval\ q{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{2}}\ v\ {\isasymunion}\ eval\ q{\isadigit{2}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ f{\isadigit{2}}{\isacharunderscore}{\kern0pt}subst\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ ccfv{\isacharunderscore}{\kern0pt}threshold{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ p{\isadigit{2}}\ v\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q{\isadigit{2}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ eval\ q{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ p{\isadigit{2}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x\ {\isasymunion}\ eval\ q{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q{\isadigit{2}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}z{\isadigit{3}}{\isacharparenright}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ p{\isadigit{2}}\ v\ {\isasymunion}\ {\isacharparenleft}{\kern0pt}eval\ p{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q{\isadigit{2}}\ v\ {\isasymunion}\isanewline
\ \ \ \ \ \ \ \ eval\ q{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ p{\isadigit{2}}\ v\ {\isasymunion}\ eval\ q{\isadigit{1}}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q{\isadigit{2}}\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ Un{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ f{\isadigit{1}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ f{\isadigit{2}}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ p{\isadigit{1}}{\isacharunderscore}{\kern0pt}q{\isadigit{1}}{\isacharunderscore}{\kern0pt}intro\ p{\isadigit{2}}{\isacharunderscore}{\kern0pt}q{\isadigit{2}}{\isacharunderscore}{\kern0pt}intro\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharquery}{\kern0pt}f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Concat\ f{\isadigit{1}}\ f{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Star{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ f{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ p\ q\ \isakeywordTWO{where}\ p{\isacharunderscore}{\kern0pt}q{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ p\ {\isasymand}\ reg{\isacharunderscore}{\kern0pt}eval\ q\ {\isasymand}\isanewline
\ \ \ \ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Union\ p\ {\isacharparenleft}{\kern0pt}Concat\ q\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}y\ {\isasymin}\ vars\ p{\isachardot}{\kern0pt}\ y\ {\isasymnoteq}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}q{\isacharunderscore}{\kern0pt}new\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Concat\ {\isacharparenleft}{\kern0pt}Star\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ {\isacharparenleft}{\kern0pt}Concat\ q\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ {\isacharparenleft}{\kern0pt}Concat\ q\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}f{\isacharunderscore}{\kern0pt}new\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Union\ {\isacharparenleft}{\kern0pt}Star\ p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharquery}{\kern0pt}q{\isacharunderscore}{\kern0pt}new\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}f{\isacharunderscore}{\kern0pt}new\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ p\ v\ {\isasymunion}\ eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}eq\ p{\isacharunderscore}{\kern0pt}q{\isacharunderscore}{\kern0pt}intro\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{5}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ star\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ Un{\isacharunderscore}{\kern0pt}commute\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}comm\ star{\isacharunderscore}{\kern0pt}idemp\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}star{\isadigit{2}}\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}left\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ star\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}f{\isacharunderscore}{\kern0pt}new\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}f{\isacharunderscore}{\kern0pt}new\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ {\isacharquery}{\kern0pt}f{\isacharunderscore}{\kern0pt}new{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}q{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ f{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ p{\isacharunderscore}{\kern0pt}q{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharquery}{\kern0pt}f{\isacharunderscore}{\kern0pt}new\ {\isacharequal}{\kern0pt}\ vars\ {\isacharparenleft}{\kern0pt}Star\ f{\isacharparenright}{\kern0pt}\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The actual lemma:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ f\ {\isasymLongrightarrow}\isanewline
\ \ \ \ {\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}s{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ s{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ f\ rule{\isacharcolon}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ uu{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Variable\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}regular{\isacharunderscore}{\kern0pt}lang\ l{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Const{\isacharbrackleft}{\kern0pt}OF\ this{\isacharbrackright}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ g\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ g\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Union{\isacharbrackleft}{\kern0pt}OF\ this{\isacharbrackright}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{4}}\ f\ g{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ g\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ g\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Concat{\isacharbrackleft}{\kern0pt}OF\ this{\isacharbrackright}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{5}}\ f{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}f{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ f{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ f{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ f\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ f{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}Star{\isacharbrackleft}{\kern0pt}OF\ this{\isacharbrackright}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Minimal solution%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
We show that any commutative system of equations has some minimal solution which is reg_eval%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Minimal solution for a single equation%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
We first prove that every bipartite regular language expression for the variable \isa{x} has
some minimal solution which is reg_eval%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{locale}\isamarkupfalse%
\ single{\isacharunderscore}{\kern0pt}bipartite{\isacharunderscore}{\kern0pt}eq\ {\isacharequal}{\kern0pt}\isanewline
\ \ \isakeywordTWO{fixes}\ x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{fixes}\ p\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ rlexp{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{fixes}\ q\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ rlexp{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{assumes}\ p{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ \ \ \ \ \ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{assumes}\ q{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ \ \ \ \ \ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{assumes}\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isasymnotin}\ vars\ p{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\begin{isamarkuptext}%
The equation%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}eq\ {\isasymequiv}\ Union\ p\ {\isacharparenleft}{\kern0pt}Concat\ q\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The solution%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}sol\ {\isasymequiv}\ Concat\ {\isacharparenleft}{\kern0pt}Star\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ p{\isachardoublequoteclose}%
\begin{isamarkuptext}%
\isa{sol} is a reg_eval regular language expression%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}reg\ q{\isacharunderscore}{\kern0pt}reg\ \isakeywordONE{have}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}update\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}reg\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ sol{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
\isa{sol} contains only variables which also appear in the equation and it does not contain \isa{x}%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}vars{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}vars\ sol\ {\isasymsubseteq}\ vars\ eq\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}upd\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ p{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}subst{\isacharunderscore}{\kern0pt}q\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}subst\ {\isacharquery}{\kern0pt}upd\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}p\ \isakeywordONE{have}\isamarkupfalse%
\ vars{\isacharunderscore}{\kern0pt}p{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}vars\ p\ {\isasymsubseteq}\ vars\ eq\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharquery}{\kern0pt}subst{\isacharunderscore}{\kern0pt}q\ {\isasymsubseteq}\ vars\ eq\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ y\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}q{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ vars\ {\isacharquery}{\kern0pt}subst{\isacharunderscore}{\kern0pt}q{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ vars{\isacharunderscore}{\kern0pt}subst\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ y{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ y{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}q{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y{\isacharprime}{\kern0pt}\ {\isasymin}\ vars\ q{\isachardoublequoteclose}\ \isakeywordTWO{and}\ y{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}y{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}y\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}upd\ y{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymin}\ vars\ eq\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}y{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}y{\isacharprime}{\kern0pt}\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}p\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ y{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}q\ y{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}y{\isacharprime}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}p\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
\isa{sol} is a partial solution of the equation%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq\ x\ eq\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ x\ {\isacharequal}{\kern0pt}\ eval\ sol\ v{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}r\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}subst\ {\isacharparenleft}{\kern0pt}Var\ {\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}upd\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ sol{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}q{\isacharunderscore}{\kern0pt}subst\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}subst\ {\isacharquery}{\kern0pt}upd\ q{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}eq{\isacharunderscore}{\kern0pt}subst\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}subst\ {\isacharquery}{\kern0pt}upd\ eq{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ homogeneous{\isacharunderscore}{\kern0pt}app{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}q{\isacharunderscore}{\kern0pt}subst\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ {\isacharquery}{\kern0pt}r{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}r{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}homogeneous\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}p\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharquery}{\kern0pt}upd\ p{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ eval\ p\ v{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}subst{\isacharbrackleft}{\kern0pt}of\ p{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}eq{\isacharunderscore}{\kern0pt}subst\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p\ v\ {\isasymunion}\ eval\ {\isacharquery}{\kern0pt}q{\isacharunderscore}{\kern0pt}subst\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ sol\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p\ v\ {\isasymunion}\ eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ {\isacharquery}{\kern0pt}r{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}r{\isacharparenright}{\kern0pt}\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ sol\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ homogeneous{\isacharunderscore}{\kern0pt}app\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}refl\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isachardot}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}r\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ {\isacharquery}{\kern0pt}r\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}r\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ p\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isasymunion}\isanewline
\ \ \ \ \ \ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}r\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}r\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ p\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}commut\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}star\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharcomma}{\kern0pt}\ best{\isacharparenright}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}comm{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}star\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}r\ v{\isacharparenright}{\kern0pt}\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ eval\ p\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ star{\isacharunderscore}{\kern0pt}unfold{\isacharunderscore}{\kern0pt}left\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}Un{\isacharunderscore}{\kern0pt}distrib{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ conc{\isacharunderscore}{\kern0pt}assoc\ conc{\isacharunderscore}{\kern0pt}epsilon{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Un\ sup{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharquery}{\kern0pt}eq{\isacharunderscore}{\kern0pt}subst\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ x{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isacharequal}{\kern0pt}\ v{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ sol\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}triv\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ eq\ v\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ sol{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ eq{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}eq{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ x\ eq\ v{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ argo\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The equation does not have any partial solution smaller than \isa{sol}%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}minimal{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ is{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ \ \ \ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ x\ eq\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sol{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}s{\isacharcolon}{\kern0pt}\ \ \ \ {\isachardoublequoteopen}v\ x\ {\isacharequal}{\kern0pt}\ eval\ sol{\isacharprime}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ sol\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}sol\ sol{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}s\ \isakeywordONE{have}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}sol{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ q\ v\ {\isacharat}{\kern0pt}{\isacharat}{\kern0pt}\ v\ x\ {\isasymunion}\ eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ q{\isacharparenright}{\kern0pt}\ p{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}arden\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}sol{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ p\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ q{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ q\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}upd\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}triv\ subst{\isacharunderscore}{\kern0pt}id{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Star\ q{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}star{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ sol\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}Concat\ {\isacharparenleft}{\kern0pt}Star\ q{\isacharparenright}{\kern0pt}\ p{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}conc{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}subset\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
In summary, \isa{sol} is a minimal partial solution and it is reg_eval%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ sol\ {\isasymand}\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ x\ eq\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}reg\ sol{\isacharunderscore}{\kern0pt}vars\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}minimal\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
Every equation (not necessarily bipartite) has some minimal partial solution which is reg_eval%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ eq{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ eq{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isasymexists}sol{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ sol\ {\isasymand}\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ x\ eq\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharbrackleft}{\kern0pt}OF\ eq{\isacharunderscore}{\kern0pt}reg{\isacharbrackright}{\kern0pt}\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ eq{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTWO{where}\ eq{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bipart{\isacharunderscore}{\kern0pt}rlexp\ x\ eq{\isacharprime}{\kern0pt}\ {\isasymand}\ vars\ eq{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ eq\ {\isasymunion}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ eq\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ eq{\isacharprime}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ p\ q\isanewline
\ \ \ \ \isakeywordTWO{where}\ p{\isacharunderscore}{\kern0pt}q{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ p\ {\isasymand}\ reg{\isacharunderscore}{\kern0pt}eval\ q\ {\isasymand}\ eq{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Union\ p\ {\isacharparenleft}{\kern0pt}Concat\ q\ {\isacharparenleft}{\kern0pt}Var\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ x\ {\isasymnotin}\ vars\ p{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bipart{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}sol\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Concat\ {\isacharparenleft}{\kern0pt}Star\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ q{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ p{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ p{\isacharunderscore}{\kern0pt}q{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}prop{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ {\isacharquery}{\kern0pt}sol\ {\isasymand}\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ x\ eq{\isacharprime}{\kern0pt}\ {\isacharquery}{\kern0pt}sol{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ single{\isacharunderscore}{\kern0pt}bipartite{\isacharunderscore}{\kern0pt}eq{\isachardot}{\kern0pt}sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{unfolding}\isamarkupfalse%
\ single{\isacharunderscore}{\kern0pt}bipartite{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ eq{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ x\ eq\ {\isacharquery}{\kern0pt}sol{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}prop\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Minimal solution of the whole system of equations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
Now, we will prove that the whole commutative system of equations has some minimal solution
which is regular. For this purpose, we will show by induction that the first \isa{r} equations have
some minimal partial solution which is reg_eval.
First, we show the centerpiece of the induction step: If a reg_eval and minimal partial solution
\isa{sols} exists for the first \isa{r} equations and furthermore a reg_eval and minimal partial solution
\isa{sol{\isacharunderscore}{\kern0pt}r} exists for the \isa{r}-th equation, then there exists a reg_eval and minimal partial solution
for the first \isa{Suc\ r} equations as well.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{locale}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}induction{\isacharunderscore}{\kern0pt}step\ {\isacharequal}{\kern0pt}\isanewline
\ \ \isakeywordTWO{fixes}\ r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\ \ \ \ \isakeywordTWO{and}\ sys\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ sols\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{and}\ sol{\isacharunderscore}{\kern0pt}r\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ rlexp{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{assumes}\ eqs{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ \ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sys{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ \ \ \ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ r{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ \ \ \ \ \ {\isachardoublequoteopen}r\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sols{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ r\ sys\ sols{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sols{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ \ \ \ \ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ r\ {\isacharparenleft}{\kern0pt}subst{\isacharunderscore}{\kern0pt}sys\ sols\ sys\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ sol{\isacharunderscore}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ \ \ \ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ sol{\isacharunderscore}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\begin{isamarkuptext}%
Substitute the partial solutions for the first \isa{r} equations into the system of equations:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}sys{\isacharprime}{\kern0pt}\ {\isasymequiv}\ subst{\isacharunderscore}{\kern0pt}sys\ sols\ sys{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The solution for the first \isa{Suc\ r} equations. We retrieve it by substituting the partial
solution of the \isa{r}-th equation into the partial solutions for the first \isa{r} equations:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}sols{\isacharprime}{\kern0pt}\ {\isasymequiv}\ {\isasymlambda}i{\isachardot}{\kern0pt}\ subst\ {\isacharparenleft}{\kern0pt}Var{\isacharparenleft}{\kern0pt}r\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ sol{\isacharunderscore}{\kern0pt}r{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}sols{\isacharprime}{\kern0pt}\ r\ {\isacharequal}{\kern0pt}\ sol{\isacharunderscore}{\kern0pt}r{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
All regular language expressions in \isa{sols{\isacharprime}{\kern0pt}} are still reg_eval%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}i{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}reg\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}reg\ \isakeywordONE{using}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}update\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
\isa{sols{\isacharprime}{\kern0pt}} is a partial solution of the first \isa{Suc\ r} equations%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}Suc\ r{\isacharparenright}{\kern0pt}\ sys{\isacharparenright}{\kern0pt}\ sols{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}sols{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}{\kern0pt}\ v\ x\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}r\ s{\isacharunderscore}{\kern0pt}sols{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ r\ {\isacharequal}{\kern0pt}\ eval\ sol{\isacharunderscore}{\kern0pt}r\ v{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}sols{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}sols{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v\ x\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ x{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}sols\ x{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}idem{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}sys{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharparenleft}{\kern0pt}take\ r\ sys{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}y{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ y{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isasymlambda}y{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ y{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ r{\isacharunderscore}{\kern0pt}valid\ Suc{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}lessD\ subst{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}subst{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ s{\isacharunderscore}{\kern0pt}sols\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ eval{\isacharunderscore}{\kern0pt}vars{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ s{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}r\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}sys\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}Suc\ r{\isacharparenright}{\kern0pt}\ sys{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ less{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
There is no partial solution of the first \isa{Suc\ r} equations which is smaller than \isa{sols{\isacharprime}{\kern0pt}}%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}min{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}sols{\isadigit{2}}\ v{\isadigit{2}}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ v{\isadigit{2}}\ x\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}Suc\ r{\isacharparenright}{\kern0pt}\ sys{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v{\isadigit{2}}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI\ {\isacharbar}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ sols{\isadigit{2}}\ v{\isadigit{2}}\ i\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ as{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ v{\isadigit{2}}\ x\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymand}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}Suc\ r{\isacharparenright}{\kern0pt}\ sys{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharparenleft}{\kern0pt}take\ r\ sys{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ as\ sols{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}s{\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v{\isadigit{2}}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}sys\ {\isacharbang}{\kern0pt}\ r{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ r{\isacharunderscore}{\kern0pt}valid\ Suc{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}lessD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}s{\isadigit{2}}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sys\ {\isacharbang}{\kern0pt}\ r{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ as\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ r\ {\isacharparenleft}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}valid\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ as\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}min{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ sol{\isacharunderscore}{\kern0pt}r\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v{\isadigit{2}}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}v{\isadigit{2}}{\isacharparenleft}{\kern0pt}r\ {\isacharcolon}{\kern0pt}{\isacharequal}{\kern0pt}\ eval\ sol{\isacharunderscore}{\kern0pt}r\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}min\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v{\isadigit{2}}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}s{\isadigit{2}}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ v{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}v{\isadigit{2}}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ substitution{\isacharunderscore}{\kern0pt}lemma{\isacharunderscore}{\kern0pt}update{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ f{\isacharequal}{\kern0pt}{\isachardoublequoteopen}sols\ i{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sols\ i{\isachardoublequoteclose}\ {\isacharquery}{\kern0pt}v{\isacharprime}{\kern0pt}\ v{\isadigit{2}}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isasymge}\ Suc\ r{\isachardot}{\kern0pt}\ sols{\isacharprime}{\kern0pt}\ i\ {\isacharequal}{\kern0pt}\ Var\ i{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
No partial solution for one of the first \isa{Suc\ r} equations depends on the variable \isa{r} or 
smaller variables or on variables which do not occur in the equation system%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}{\kern0pt}\ Suc\ r{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymge}\ Suc\ r\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}{\kern0pt}\ r{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymge}\ r\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ vars{\isacharunderscore}{\kern0pt}sols{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymge}\ r\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ empty{\isacharunderscore}{\kern0pt}iff\ insert{\isacharunderscore}{\kern0pt}iff\ leI\ vars{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sys{\isacharunderscore}{\kern0pt}valid\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}subst\ sols\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymge}\ r\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{if}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vars{\isacharunderscore}{\kern0pt}subst{\isacharbrackleft}{\kern0pt}of\ sols\ {\isachardoublequoteopen}sys\ {\isacharbang}{\kern0pt}\ i{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ that\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ UN{\isacharunderscore}{\kern0pt}E\ nth{\isacharunderscore}{\kern0pt}mem{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymge}\ r\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{if}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}valid\ that\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharparenleft}{\kern0pt}sol{\isacharunderscore}{\kern0pt}r{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ vars\ {\isacharparenleft}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}r{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ vars{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}r{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ vars\ sol{\isacharunderscore}{\kern0pt}r{\isachardot}{\kern0pt}\ x\ {\isachargreater}{\kern0pt}\ r\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ r{\isacharunderscore}{\kern0pt}valid\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ DiffE\ insertCI\ nat{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}le\ subsetD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ vars\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}r{\isacharbraceright}{\kern0pt}\ {\isasymunion}\ vars\ sol{\isacharunderscore}{\kern0pt}r{\isachardoublequoteclose}\ \isakeywordTWO{if}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vars{\isacharunderscore}{\kern0pt}subst{\isacharunderscore}{\kern0pt}upd{\isacharunderscore}{\kern0pt}upper\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isachargreater}{\kern0pt}\ r\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{if}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ vars{\isacharunderscore}{\kern0pt}sols\ that\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ r{\isacharunderscore}{\kern0pt}valid\ Suc{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq\ dual{\isacharunderscore}{\kern0pt}order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}trans{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
In summary, \isa{sols{\isacharprime}{\kern0pt}} is a minimal partial solution of the first \isa{Suc\ r} equations%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharparenleft}{\kern0pt}Suc\ r{\isacharparenright}{\kern0pt}\ sys\ sols{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isakeywordONE{using}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}min\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}gt{\isacharunderscore}{\kern0pt}r\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}leq{\isacharunderscore}{\kern0pt}r\isanewline
\ \ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The centerpiece of the induction step: There exists a reg_eval and minimal partial solution
for the first \isa{Suc\ r} equations%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}r{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymexists}sols{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharparenleft}{\kern0pt}Suc\ r{\isacharparenright}{\kern0pt}\ sys\ sols{\isacharprime}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}reg\ sols{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{by}\isamarkupfalse%
\ blast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
The actual induction proof: For every \isa{r}, there exists a reg_eval and minimal partial
solution of the first \isa{r} equations%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ eqs{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ \ \ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sys{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ r{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ \ \ {\isachardoublequoteopen}r\ {\isasymle}\ length\ sys{\isachardoublequoteclose}\ \ \ \isanewline
\ \ \ \ \isakeywordTWO{shows}\ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymexists}sols{\isachardot}{\kern0pt}\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ r\ sys\ sols\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ r{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharparenleft}{\kern0pt}take\ {\isadigit{0}}\ sys{\isacharparenright}{\kern0pt}\ Var{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ r{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ sols\ \isakeywordTWO{where}\ sols{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ r\ sys\ sols\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}subst{\isacharunderscore}{\kern0pt}sys\ sols\ sys{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ eqs{\isacharunderscore}{\kern0pt}reg\ Suc{\isachardot}{\kern0pt}prems\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}intro\ Suc{\isachardot}{\kern0pt}prems\ \isakeywordONE{have}\isamarkupfalse%
\ sys{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}eval{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sys\ {\isacharbang}{\kern0pt}\ r{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}subst{\isacharbrackleft}{\kern0pt}of\ r\ sys{\isacharbrackright}{\kern0pt}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}r\ \isakeywordTWO{where}\ sol{\isacharunderscore}{\kern0pt}r{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ sol{\isacharunderscore}{\kern0pt}r\ {\isasymand}\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ r\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}sys{\isacharprime}{\kern0pt}\ {\isacharbang}{\kern0pt}\ r{\isacharparenright}{\kern0pt}\ sol{\isacharunderscore}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Suc\ sols{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}induction{\isacharunderscore}{\kern0pt}step\ r\ sys\ sols\ sol{\isacharunderscore}{\kern0pt}r{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}induction{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}induction{\isacharunderscore}{\kern0pt}step{\isachardot}{\kern0pt}exists{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}r{\isacharbrackleft}{\kern0pt}OF\ this{\isacharbrackright}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
As a consequence of the induction proof, there exists a regular and minimal (non-partial)
solution for the whole system of equations%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}sys{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ eqs{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ \ \ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sys{\isacharunderscore}{\kern0pt}valid{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymexists}sols{\isachardot}{\kern0pt}\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sols\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ regular{\isacharunderscore}{\kern0pt}lang\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ eqs{\isacharunderscore}{\kern0pt}reg\ sys{\isacharunderscore}{\kern0pt}valid\ \isakeywordONE{have}\isamarkupfalse%
\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isasymexists}sols{\isachardot}{\kern0pt}\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharparenleft}{\kern0pt}length\ sys{\isacharparenright}{\kern0pt}\ sys\ sols\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}aux\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ sols\ \isakeywordTWO{where}\isanewline
\ \ \ \ sols{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharparenleft}{\kern0pt}length\ sys{\isacharparenright}{\kern0pt}\ sys\ sols\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}const{\isacharunderscore}{\kern0pt}rlexp\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{if}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ that\ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ equals{\isadigit{0}}I\ leD{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}l{\isachardot}{\kern0pt}\ regular{\isacharunderscore}{\kern0pt}lang\ l\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{if}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ that\ const{\isacharunderscore}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}regular{\isacharunderscore}{\kern0pt}lang\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ ls\ \isakeywordTWO{where}\ ls{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardot}{\kern0pt}\ regular{\isacharunderscore}{\kern0pt}lang\ {\isacharparenleft}{\kern0pt}ls\ i{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ ls\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}i{\isachardot}{\kern0pt}\ if\ i\ {\isacharless}{\kern0pt}\ length\ sys\ then\ ls\ i\ else\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ ls{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ ls{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardot}{\kern0pt}\ regular{\isacharunderscore}{\kern0pt}lang\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isasymge}\ length\ sys{\isachardot}{\kern0pt}\ {\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}\ i\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ ls{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}regular{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}regular{\isacharunderscore}{\kern0pt}lang\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ i\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ lang{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ ls{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ sols{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ {\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ linorder{\isacharunderscore}{\kern0pt}not{\isacharunderscore}{\kern0pt}less\ nless{\isacharunderscore}{\kern0pt}le\ take{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}iff{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}sol{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isacharprime}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ sol{\isacharprime}{\kern0pt}\ x\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ as{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}sol{\isacharunderscore}{\kern0pt}rlexps\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}i{\isachardot}{\kern0pt}\ Const\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ as\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharparenleft}{\kern0pt}take\ {\isacharparenleft}{\kern0pt}length\ sys{\isacharparenright}{\kern0pt}\ sys{\isacharparenright}{\kern0pt}\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sol{\isacharprime}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}sol{\isacharunderscore}{\kern0pt}rlexps\ x{\isacharparenright}{\kern0pt}\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordTWO{for}\ x\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ sols{\isacharunderscore}{\kern0pt}intro\ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}smt\ {\isacharparenleft}{\kern0pt}verit{\isacharparenright}{\kern0pt}\ empty{\isacharunderscore}{\kern0pt}subsetI\ eval{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ ls{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ {\isacharquery}{\kern0pt}ls{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ ls{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}regular\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Parikh's theorem%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isakeywordONE{theorem}\isamarkupfalse%
\ Parikh{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}CFL\ {\isacharparenleft}{\kern0pt}TYPE{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ L\ {\isasymLongrightarrow}\ {\isasymexists}L{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ regular{\isacharunderscore}{\kern0pt}lang\ L{\isacharprime}{\kern0pt}\ {\isasymand}\ parikh{\isacharunderscore}{\kern0pt}img\ L\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ L{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}CFL\ {\isacharparenleft}{\kern0pt}TYPE{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ L{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ P\ \isakeywordTWO{and}\ S{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}n\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}L\ {\isacharequal}{\kern0pt}\ Lang\ P\ S\ {\isasymand}\ finite\ P{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ CFL{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}S\ {\isasymin}\ Nts\ P{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}Nts\ exists{\isacharunderscore}{\kern0pt}bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ {\isasymgamma}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}\ {\isasymgamma}\ {\isasymgamma}{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isanewline
\ \ \ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}sol\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}i{\isachardot}{\kern0pt}\ if\ i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}\ then\ Lang{\isacharunderscore}{\kern0pt}lfp\ P\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}\ else\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ True\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymgamma}{\isacharprime}{\kern0pt}\ S\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymgamma}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ S{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ S{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Lang{\isacharunderscore}{\kern0pt}lfp{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}Lang\ \isakeywordONE{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Lang\ P\ S\ {\isacharequal}{\kern0pt}\ {\isacharquery}{\kern0pt}sol\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isanewline
\ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ CFG{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}sys{\isachardot}{\kern0pt}CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ sys\isanewline
\ \ \ \ \ \ \isakeywordTWO{where}\ sys{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ {\isacharquery}{\kern0pt}sol{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}comm\ \isakeywordONE{have}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ {\isacharquery}{\kern0pt}sol{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ sys{\isacharunderscore}{\kern0pt}intro\ exists{\isacharunderscore}{\kern0pt}minimal{\isacharunderscore}{\kern0pt}reg{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}sys\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ sol{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\isanewline
\ \ \ \ \ \ sol{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isacharprime}{\kern0pt}\ {\isasymand}\ regular{\isacharunderscore}{\kern0pt}lang\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}unique\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}sol\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ S{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ sol{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ Nts{\isacharunderscore}{\kern0pt}Lhss{\isacharunderscore}{\kern0pt}Rhs{\isacharunderscore}{\kern0pt}Nts\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}S\ {\isasymnotin}\ Lhss\ P{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ Lang{\isacharunderscore}{\kern0pt}empty{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}notin{\isacharunderscore}{\kern0pt}Lhss{\isacharbrackleft}{\kern0pt}OF\ this{\isacharbrackright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ lang{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/studium/semester_7/semantik/homeworks/AIST/Parikh/Pilling.thy%:%
%:%10=1%:%
%:%11=1%:%
%:%12=2%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%16=6%:%
%:%17=7%:%
%:%18=8%:%
%:%27=11%:%
%:%28=12%:%
%:%29=13%:%
%:%30=14%:%
%:%31=15%:%
%:%32=16%:%
%:%33=17%:%
%:%42=20%:%
%:%54=22%:%
%:%55=23%:%
%:%56=24%:%
%:%57=25%:%
%:%59=26%:%
%:%60=26%:%
%:%61=27%:%
%:%64=31%:%
%:%66=32%:%
%:%67=32%:%
%:%70=33%:%
%:%74=33%:%
%:%75=33%:%
%:%76=33%:%
%:%85=36%:%
%:%86=37%:%
%:%87=38%:%
%:%89=40%:%
%:%90=40%:%
%:%91=41%:%
%:%98=42%:%
%:%99=42%:%
%:%100=43%:%
%:%101=43%:%
%:%102=44%:%
%:%103=44%:%
%:%104=45%:%
%:%105=45%:%
%:%106=45%:%
%:%107=46%:%
%:%108=46%:%
%:%109=46%:%
%:%110=46%:%
%:%111=47%:%
%:%112=47%:%
%:%113=47%:%
%:%114=47%:%
%:%115=47%:%
%:%116=48%:%
%:%117=48%:%
%:%118=48%:%
%:%119=48%:%
%:%120=48%:%
%:%121=49%:%
%:%122=49%:%
%:%123=49%:%
%:%124=49%:%
%:%125=50%:%
%:%126=50%:%
%:%127=51%:%
%:%128=51%:%
%:%129=52%:%
%:%130=52%:%
%:%131=53%:%
%:%132=53%:%
%:%133=53%:%
%:%134=54%:%
%:%135=54%:%
%:%136=54%:%
%:%137=54%:%
%:%138=55%:%
%:%139=55%:%
%:%140=55%:%
%:%141=55%:%
%:%142=55%:%
%:%143=56%:%
%:%144=56%:%
%:%145=56%:%
%:%146=56%:%
%:%147=57%:%
%:%148=57%:%
%:%149=57%:%
%:%150=57%:%
%:%151=58%:%
%:%157=58%:%
%:%160=59%:%
%:%161=60%:%
%:%162=60%:%
%:%163=61%:%
%:%164=62%:%
%:%165=63%:%
%:%172=64%:%
%:%173=64%:%
%:%174=65%:%
%:%175=65%:%
%:%176=66%:%
%:%177=66%:%
%:%178=67%:%
%:%179=67%:%
%:%180=67%:%
%:%181=67%:%
%:%182=68%:%
%:%183=68%:%
%:%184=68%:%
%:%185=68%:%
%:%186=69%:%
%:%187=69%:%
%:%188=69%:%
%:%189=69%:%
%:%190=70%:%
%:%191=70%:%
%:%192=70%:%
%:%193=70%:%
%:%194=71%:%
%:%200=71%:%
%:%203=72%:%
%:%204=73%:%
%:%205=73%:%
%:%206=74%:%
%:%207=75%:%
%:%208=76%:%
%:%209=77%:%
%:%210=78%:%
%:%211=79%:%
%:%218=80%:%
%:%219=80%:%
%:%220=81%:%
%:%221=81%:%
%:%222=81%:%
%:%223=82%:%
%:%224=83%:%
%:%225=84%:%
%:%226=85%:%
%:%227=85%:%
%:%228=86%:%
%:%229=86%:%
%:%230=86%:%
%:%231=87%:%
%:%232=88%:%
%:%233=89%:%
%:%234=89%:%
%:%235=89%:%
%:%236=90%:%
%:%237=91%:%
%:%238=91%:%
%:%239=92%:%
%:%240=92%:%
%:%241=92%:%
%:%242=92%:%
%:%243=92%:%
%:%244=93%:%
%:%245=93%:%
%:%246=93%:%
%:%247=94%:%
%:%248=94%:%
%:%249=95%:%
%:%250=95%:%
%:%251=96%:%
%:%252=96%:%
%:%253=96%:%
%:%254=97%:%
%:%255=97%:%
%:%256=97%:%
%:%257=98%:%
%:%258=98%:%
%:%259=98%:%
%:%260=98%:%
%:%261=99%:%
%:%267=99%:%
%:%270=100%:%
%:%271=101%:%
%:%272=101%:%
%:%273=102%:%
%:%274=103%:%
%:%275=104%:%
%:%276=105%:%
%:%277=106%:%
%:%278=107%:%
%:%285=108%:%
%:%286=108%:%
%:%287=109%:%
%:%288=109%:%
%:%289=109%:%
%:%290=110%:%
%:%291=111%:%
%:%292=112%:%
%:%293=113%:%
%:%294=113%:%
%:%295=114%:%
%:%296=114%:%
%:%297=114%:%
%:%298=115%:%
%:%299=116%:%
%:%300=117%:%
%:%301=117%:%
%:%302=117%:%
%:%303=118%:%
%:%304=119%:%
%:%305=119%:%
%:%306=120%:%
%:%307=120%:%
%:%308=121%:%
%:%309=122%:%
%:%310=122%:%
%:%311=123%:%
%:%312=123%:%
%:%313=124%:%
%:%314=124%:%
%:%315=125%:%
%:%316=125%:%
%:%317=126%:%
%:%318=126%:%
%:%319=126%:%
%:%320=127%:%
%:%321=128%:%
%:%322=128%:%
%:%323=129%:%
%:%324=129%:%
%:%325=130%:%
%:%326=130%:%
%:%327=131%:%
%:%328=131%:%
%:%329=131%:%
%:%330=132%:%
%:%331=132%:%
%:%332=133%:%
%:%333=133%:%
%:%334=133%:%
%:%335=134%:%
%:%336=135%:%
%:%337=135%:%
%:%338=135%:%
%:%339=136%:%
%:%340=136%:%
%:%341=136%:%
%:%342=137%:%
%:%343=138%:%
%:%344=138%:%
%:%345=138%:%
%:%346=139%:%
%:%347=139%:%
%:%348=139%:%
%:%349=140%:%
%:%350=141%:%
%:%351=141%:%
%:%352=142%:%
%:%353=142%:%
%:%354=142%:%
%:%355=143%:%
%:%356=143%:%
%:%357=144%:%
%:%358=144%:%
%:%359=144%:%
%:%360=144%:%
%:%361=145%:%
%:%362=145%:%
%:%363=146%:%
%:%364=146%:%
%:%365=146%:%
%:%366=146%:%
%:%367=146%:%
%:%368=146%:%
%:%369=147%:%
%:%370=147%:%
%:%371=147%:%
%:%372=148%:%
%:%373=148%:%
%:%374=148%:%
%:%375=149%:%
%:%376=149%:%
%:%377=149%:%
%:%378=149%:%
%:%379=150%:%
%:%385=150%:%
%:%388=151%:%
%:%389=152%:%
%:%390=152%:%
%:%391=153%:%
%:%392=154%:%
%:%393=155%:%
%:%394=156%:%
%:%401=157%:%
%:%402=157%:%
%:%403=158%:%
%:%404=158%:%
%:%405=158%:%
%:%406=159%:%
%:%407=159%:%
%:%408=160%:%
%:%409=160%:%
%:%410=160%:%
%:%411=161%:%
%:%412=161%:%
%:%413=161%:%
%:%414=162%:%
%:%415=163%:%
%:%416=163%:%
%:%417=164%:%
%:%418=164%:%
%:%419=165%:%
%:%420=166%:%
%:%421=166%:%
%:%422=167%:%
%:%423=167%:%
%:%424=168%:%
%:%425=168%:%
%:%426=169%:%
%:%427=169%:%
%:%428=170%:%
%:%429=170%:%
%:%430=171%:%
%:%431=171%:%
%:%432=172%:%
%:%433=172%:%
%:%434=172%:%
%:%435=173%:%
%:%436=173%:%
%:%437=173%:%
%:%438=174%:%
%:%439=174%:%
%:%440=174%:%
%:%441=175%:%
%:%442=176%:%
%:%443=176%:%
%:%444=177%:%
%:%445=177%:%
%:%446=177%:%
%:%447=178%:%
%:%448=178%:%
%:%449=179%:%
%:%450=179%:%
%:%451=179%:%
%:%452=180%:%
%:%453=181%:%
%:%454=181%:%
%:%455=181%:%
%:%456=182%:%
%:%457=182%:%
%:%458=182%:%
%:%459=183%:%
%:%460=183%:%
%:%461=184%:%
%:%462=184%:%
%:%463=184%:%
%:%464=184%:%
%:%465=185%:%
%:%466=185%:%
%:%467=185%:%
%:%468=185%:%
%:%469=186%:%
%:%470=186%:%
%:%471=187%:%
%:%472=187%:%
%:%473=187%:%
%:%474=187%:%
%:%475=187%:%
%:%476=187%:%
%:%477=188%:%
%:%478=188%:%
%:%479=188%:%
%:%480=188%:%
%:%481=188%:%
%:%482=189%:%
%:%483=189%:%
%:%484=189%:%
%:%485=189%:%
%:%486=190%:%
%:%496=192%:%
%:%498=193%:%
%:%499=193%:%
%:%501=195%:%
%:%508=196%:%
%:%509=196%:%
%:%510=197%:%
%:%511=197%:%
%:%512=198%:%
%:%513=198%:%
%:%514=198%:%
%:%515=198%:%
%:%516=199%:%
%:%517=199%:%
%:%518=200%:%
%:%519=200%:%
%:%520=201%:%
%:%521=201%:%
%:%522=201%:%
%:%523=201%:%
%:%524=202%:%
%:%525=202%:%
%:%526=202%:%
%:%527=202%:%
%:%528=203%:%
%:%529=203%:%
%:%530=204%:%
%:%531=204%:%
%:%532=205%:%
%:%533=205%:%
%:%534=205%:%
%:%535=206%:%
%:%536=207%:%
%:%537=207%:%
%:%538=208%:%
%:%539=208%:%
%:%540=208%:%
%:%541=208%:%
%:%542=209%:%
%:%543=209%:%
%:%544=210%:%
%:%545=210%:%
%:%546=211%:%
%:%547=211%:%
%:%548=211%:%
%:%549=212%:%
%:%550=213%:%
%:%551=213%:%
%:%552=214%:%
%:%553=214%:%
%:%554=214%:%
%:%555=214%:%
%:%556=215%:%
%:%557=215%:%
%:%558=216%:%
%:%559=216%:%
%:%560=217%:%
%:%561=217%:%
%:%562=217%:%
%:%563=218%:%
%:%564=218%:%
%:%565=219%:%
%:%566=219%:%
%:%567=219%:%
%:%568=219%:%
%:%569=220%:%
%:%584=223%:%
%:%596=225%:%
%:%605=228%:%
%:%617=232%:%
%:%618=233%:%
%:%620=235%:%
%:%621=235%:%
%:%622=236%:%
%:%623=237%:%
%:%624=238%:%
%:%625=239%:%
%:%626=240%:%
%:%627=241%:%
%:%628=242%:%
%:%630=244%:%
%:%632=245%:%
%:%633=245%:%
%:%635=247%:%
%:%637=248%:%
%:%638=248%:%
%:%640=251%:%
%:%642=252%:%
%:%643=252%:%
%:%650=253%:%
%:%651=253%:%
%:%652=254%:%
%:%653=254%:%
%:%654=254%:%
%:%655=255%:%
%:%656=255%:%
%:%657=255%:%
%:%658=256%:%
%:%659=256%:%
%:%660=256%:%
%:%661=256%:%
%:%662=257%:%
%:%672=260%:%
%:%674=261%:%
%:%675=261%:%
%:%682=262%:%
%:%683=262%:%
%:%684=263%:%
%:%685=263%:%
%:%686=264%:%
%:%687=264%:%
%:%688=265%:%
%:%689=265%:%
%:%690=265%:%
%:%691=265%:%
%:%692=266%:%
%:%693=267%:%
%:%694=267%:%
%:%695=268%:%
%:%696=268%:%
%:%697=269%:%
%:%698=269%:%
%:%699=270%:%
%:%700=270%:%
%:%701=271%:%
%:%702=271%:%
%:%703=271%:%
%:%704=272%:%
%:%705=272%:%
%:%706=272%:%
%:%707=273%:%
%:%708=273%:%
%:%709=274%:%
%:%710=274%:%
%:%711=275%:%
%:%712=275%:%
%:%713=276%:%
%:%714=276%:%
%:%715=276%:%
%:%716=276%:%
%:%717=277%:%
%:%718=277%:%
%:%719=278%:%
%:%720=278%:%
%:%721=279%:%
%:%722=279%:%
%:%723=279%:%
%:%724=279%:%
%:%725=280%:%
%:%726=280%:%
%:%727=281%:%
%:%728=281%:%
%:%729=282%:%
%:%730=282%:%
%:%731=282%:%
%:%732=282%:%
%:%733=283%:%
%:%743=286%:%
%:%745=287%:%
%:%746=287%:%
%:%753=288%:%
%:%754=288%:%
%:%755=288%:%
%:%756=289%:%
%:%757=289%:%
%:%758=290%:%
%:%759=290%:%
%:%760=291%:%
%:%761=292%:%
%:%762=292%:%
%:%763=293%:%
%:%764=293%:%
%:%765=294%:%
%:%766=294%:%
%:%767=295%:%
%:%768=295%:%
%:%769=296%:%
%:%770=297%:%
%:%771=297%:%
%:%772=298%:%
%:%773=298%:%
%:%774=298%:%
%:%775=299%:%
%:%776=300%:%
%:%777=300%:%
%:%778=300%:%
%:%779=300%:%
%:%780=300%:%
%:%781=301%:%
%:%782=301%:%
%:%783=301%:%
%:%784=302%:%
%:%785=302%:%
%:%786=303%:%
%:%787=303%:%
%:%788=303%:%
%:%789=304%:%
%:%790=304%:%
%:%791=304%:%
%:%792=305%:%
%:%793=305%:%
%:%794=305%:%
%:%795=306%:%
%:%796=307%:%
%:%797=307%:%
%:%798=308%:%
%:%799=308%:%
%:%800=308%:%
%:%801=309%:%
%:%802=310%:%
%:%803=310%:%
%:%804=310%:%
%:%805=311%:%
%:%806=311%:%
%:%807=311%:%
%:%808=312%:%
%:%809=312%:%
%:%810=313%:%
%:%811=313%:%
%:%812=314%:%
%:%813=314%:%
%:%814=314%:%
%:%815=314%:%
%:%816=314%:%
%:%817=315%:%
%:%818=316%:%
%:%819=316%:%
%:%820=316%:%
%:%821=316%:%
%:%822=316%:%
%:%823=317%:%
%:%824=317%:%
%:%825=317%:%
%:%826=318%:%
%:%827=318%:%
%:%828=318%:%
%:%829=319%:%
%:%830=319%:%
%:%831=319%:%
%:%832=319%:%
%:%833=319%:%
%:%834=320%:%
%:%844=323%:%
%:%846=324%:%
%:%847=324%:%
%:%848=325%:%
%:%849=326%:%
%:%850=327%:%
%:%857=328%:%
%:%858=328%:%
%:%859=329%:%
%:%860=329%:%
%:%861=329%:%
%:%862=330%:%
%:%863=330%:%
%:%864=330%:%
%:%865=331%:%
%:%866=331%:%
%:%867=331%:%
%:%868=332%:%
%:%869=332%:%
%:%870=332%:%
%:%871=333%:%
%:%872=334%:%
%:%873=334%:%
%:%874=334%:%
%:%875=334%:%
%:%876=335%:%
%:%877=335%:%
%:%878=335%:%
%:%879=336%:%
%:%880=336%:%
%:%881=336%:%
%:%882=337%:%
%:%883=337%:%
%:%884=337%:%
%:%885=338%:%
%:%886=338%:%
%:%887=338%:%
%:%888=339%:%
%:%889=339%:%
%:%890=339%:%
%:%891=340%:%
%:%892=340%:%
%:%893=340%:%
%:%894=341%:%
%:%895=342%:%
%:%896=342%:%
%:%897=342%:%
%:%898=342%:%
%:%899=343%:%
%:%909=345%:%
%:%911=346%:%
%:%912=346%:%
%:%913=347%:%
%:%916=348%:%
%:%920=348%:%
%:%921=348%:%
%:%922=349%:%
%:%923=349%:%
%:%924=350%:%
%:%925=350%:%
%:%930=350%:%
%:%933=351%:%
%:%934=352%:%
%:%937=355%:%
%:%939=356%:%
%:%940=356%:%
%:%941=357%:%
%:%942=358%:%
%:%949=359%:%
%:%950=359%:%
%:%951=360%:%
%:%952=360%:%
%:%953=360%:%
%:%954=361%:%
%:%955=362%:%
%:%956=362%:%
%:%957=363%:%
%:%958=363%:%
%:%959=363%:%
%:%960=364%:%
%:%961=365%:%
%:%962=365%:%
%:%963=365%:%
%:%964=366%:%
%:%965=367%:%
%:%966=367%:%
%:%967=368%:%
%:%968=368%:%
%:%969=368%:%
%:%970=369%:%
%:%971=369%:%
%:%972=369%:%
%:%973=369%:%
%:%974=370%:%
%:%975=370%:%
%:%976=370%:%
%:%977=371%:%
%:%978=371%:%
%:%979=371%:%
%:%980=372%:%
%:%981=372%:%
%:%982=372%:%
%:%983=372%:%
%:%984=373%:%
%:%999=376%:%
%:%1011=378%:%
%:%1012=379%:%
%:%1013=380%:%
%:%1014=381%:%
%:%1015=382%:%
%:%1016=383%:%
%:%1017=384%:%
%:%1019=386%:%
%:%1020=386%:%
%:%1021=387%:%
%:%1022=388%:%
%:%1023=389%:%
%:%1024=390%:%
%:%1025=391%:%
%:%1026=392%:%
%:%1027=393%:%
%:%1028=394%:%
%:%1029=395%:%
%:%1030=396%:%
%:%1031=397%:%
%:%1032=398%:%
%:%1034=401%:%
%:%1036=402%:%
%:%1037=402%:%
%:%1039=404%:%
%:%1040=405%:%
%:%1042=406%:%
%:%1043=406%:%
%:%1044=407%:%
%:%1045=408%:%
%:%1046=409%:%
%:%1047=409%:%
%:%1050=410%:%
%:%1054=410%:%
%:%1055=410%:%
%:%1056=410%:%
%:%1057=410%:%
%:%1066=413%:%
%:%1068=414%:%
%:%1069=414%:%
%:%1072=415%:%
%:%1076=415%:%
%:%1077=415%:%
%:%1078=415%:%
%:%1079=415%:%
%:%1088=418%:%
%:%1090=419%:%
%:%1091=419%:%
%:%1098=420%:%
%:%1099=420%:%
%:%1100=420%:%
%:%1101=421%:%
%:%1102=421%:%
%:%1103=422%:%
%:%1104=422%:%
%:%1105=423%:%
%:%1106=424%:%
%:%1107=424%:%
%:%1108=424%:%
%:%1109=424%:%
%:%1110=425%:%
%:%1111=425%:%
%:%1112=425%:%
%:%1113=426%:%
%:%1114=426%:%
%:%1115=426%:%
%:%1116=427%:%
%:%1117=427%:%
%:%1118=427%:%
%:%1119=428%:%
%:%1120=428%:%
%:%1121=428%:%
%:%1122=429%:%
%:%1123=430%:%
%:%1124=430%:%
%:%1125=431%:%
%:%1126=431%:%
%:%1127=432%:%
%:%1128=432%:%
%:%1129=433%:%
%:%1130=433%:%
%:%1131=433%:%
%:%1132=434%:%
%:%1133=434%:%
%:%1134=435%:%
%:%1135=435%:%
%:%1136=435%:%
%:%1137=436%:%
%:%1138=436%:%
%:%1139=436%:%
%:%1140=437%:%
%:%1141=437%:%
%:%1142=437%:%
%:%1143=438%:%
%:%1144=438%:%
%:%1145=438%:%
%:%1146=439%:%
%:%1156=441%:%
%:%1158=442%:%
%:%1159=442%:%
%:%1161=444%:%
%:%1168=445%:%
%:%1169=445%:%
%:%1170=446%:%
%:%1171=446%:%
%:%1172=447%:%
%:%1173=447%:%
%:%1174=448%:%
%:%1175=449%:%
%:%1176=449%:%
%:%1177=449%:%
%:%1178=449%:%
%:%1179=449%:%
%:%1180=450%:%
%:%1181=450%:%
%:%1182=450%:%
%:%1183=451%:%
%:%1184=451%:%
%:%1185=451%:%
%:%1186=452%:%
%:%1187=453%:%
%:%1188=453%:%
%:%1189=454%:%
%:%1190=454%:%
%:%1191=454%:%
%:%1192=455%:%
%:%1193=455%:%
%:%1194=456%:%
%:%1195=456%:%
%:%1196=456%:%
%:%1197=457%:%
%:%1198=457%:%
%:%1199=457%:%
%:%1200=458%:%
%:%1201=458%:%
%:%1202=458%:%
%:%1203=459%:%
%:%1204=459%:%
%:%1205=459%:%
%:%1206=459%:%
%:%1207=460%:%
%:%1208=460%:%
%:%1209=460%:%
%:%1210=461%:%
%:%1211=461%:%
%:%1212=461%:%
%:%1213=462%:%
%:%1214=463%:%
%:%1215=463%:%
%:%1216=464%:%
%:%1217=464%:%
%:%1218=464%:%
%:%1219=464%:%
%:%1220=465%:%
%:%1221=465%:%
%:%1222=465%:%
%:%1223=466%:%
%:%1224=466%:%
%:%1225=466%:%
%:%1226=467%:%
%:%1232=467%:%
%:%1235=468%:%
%:%1236=469%:%
%:%1237=470%:%
%:%1238=470%:%
%:%1241=471%:%
%:%1245=471%:%
%:%1246=471%:%
%:%1247=471%:%
%:%1248=471%:%
%:%1257=474%:%
%:%1258=475%:%
%:%1260=476%:%
%:%1261=476%:%
%:%1268=477%:%
%:%1269=477%:%
%:%1270=478%:%
%:%1271=478%:%
%:%1272=478%:%
%:%1273=479%:%
%:%1274=479%:%
%:%1275=479%:%
%:%1276=480%:%
%:%1277=480%:%
%:%1278=480%:%
%:%1279=481%:%
%:%1280=481%:%
%:%1281=481%:%
%:%1282=482%:%
%:%1283=482%:%
%:%1284=482%:%
%:%1285=483%:%
%:%1286=483%:%
%:%1287=483%:%
%:%1288=484%:%
%:%1289=484%:%
%:%1290=484%:%
%:%1291=485%:%
%:%1292=485%:%
%:%1293=485%:%
%:%1294=485%:%
%:%1295=486%:%
%:%1296=486%:%
%:%1297=486%:%
%:%1298=486%:%
%:%1299=487%:%
%:%1300=487%:%
%:%1301=487%:%
%:%1302=488%:%
%:%1303=488%:%
%:%1304=488%:%
%:%1305=489%:%
%:%1306=489%:%
%:%1307=489%:%
%:%1308=490%:%
%:%1309=490%:%
%:%1310=491%:%
%:%1311=491%:%
%:%1312=491%:%
%:%1313=492%:%
%:%1314=492%:%
%:%1315=492%:%
%:%1316=493%:%
%:%1317=493%:%
%:%1318=493%:%
%:%1319=494%:%
%:%1320=494%:%
%:%1321=494%:%
%:%1322=495%:%
%:%1323=495%:%
%:%1324=495%:%
%:%1325=495%:%
%:%1326=496%:%
%:%1336=499%:%
%:%1338=500%:%
%:%1339=500%:%
%:%1342=501%:%
%:%1346=501%:%
%:%1347=501%:%
%:%1348=502%:%
%:%1349=502%:%
%:%1350=503%:%
%:%1351=503%:%
%:%1360=506%:%
%:%1361=507%:%
%:%1363=508%:%
%:%1364=508%:%
%:%1365=509%:%
%:%1368=510%:%
%:%1372=510%:%
%:%1373=510%:%
%:%1374=510%:%
%:%1379=510%:%
%:%1382=511%:%
%:%1383=512%:%
%:%1386=515%:%
%:%1387=516%:%
%:%1389=517%:%
%:%1390=517%:%
%:%1391=518%:%
%:%1392=519%:%
%:%1393=520%:%
%:%1394=521%:%
%:%1401=522%:%
%:%1402=522%:%
%:%1403=522%:%
%:%1404=523%:%
%:%1405=523%:%
%:%1406=524%:%
%:%1407=524%:%
%:%1408=525%:%
%:%1409=525%:%
%:%1410=525%:%
%:%1411=526%:%
%:%1412=526%:%
%:%1413=526%:%
%:%1414=526%:%
%:%1415=526%:%
%:%1416=527%:%
%:%1417=527%:%
%:%1418=528%:%
%:%1419=528%:%
%:%1420=529%:%
%:%1421=529%:%
%:%1422=529%:%
%:%1423=530%:%
%:%1424=530%:%
%:%1425=531%:%
%:%1426=532%:%
%:%1427=532%:%
%:%1428=533%:%
%:%1429=533%:%
%:%1430=533%:%
%:%1431=533%:%
%:%1432=534%:%
%:%1433=534%:%
%:%1434=534%:%
%:%1435=535%:%
%:%1436=535%:%
%:%1437=535%:%
%:%1438=536%:%
%:%1439=536%:%
%:%1440=536%:%
%:%1441=537%:%
%:%1442=538%:%
%:%1443=538%:%
%:%1444=538%:%
%:%1445=539%:%
%:%1446=540%:%
%:%1447=540%:%
%:%1448=540%:%
%:%1449=541%:%
%:%1450=541%:%
%:%1451=541%:%
%:%1452=542%:%
%:%1453=542%:%
%:%1454=542%:%
%:%1455=542%:%
%:%1456=543%:%
%:%1466=546%:%
%:%1467=547%:%
%:%1469=548%:%
%:%1470=548%:%
%:%1471=549%:%
%:%1472=550%:%
%:%1473=551%:%
%:%1480=552%:%
%:%1481=552%:%
%:%1482=553%:%
%:%1483=553%:%
%:%1484=553%:%
%:%1485=554%:%
%:%1486=555%:%
%:%1487=555%:%
%:%1488=555%:%
%:%1489=556%:%
%:%1490=556%:%
%:%1491=556%:%
%:%1492=557%:%
%:%1493=558%:%
%:%1494=558%:%
%:%1495=559%:%
%:%1496=559%:%
%:%1497=559%:%
%:%1498=560%:%
%:%1499=560%:%
%:%1500=560%:%
%:%1501=560%:%
%:%1502=561%:%
%:%1503=561%:%
%:%1504=561%:%
%:%1505=562%:%
%:%1506=562%:%
%:%1507=562%:%
%:%1508=563%:%
%:%1509=563%:%
%:%1510=563%:%
%:%1511=564%:%
%:%1512=564%:%
%:%1513=565%:%
%:%1514=566%:%
%:%1515=566%:%
%:%1516=567%:%
%:%1517=567%:%
%:%1518=567%:%
%:%1519=568%:%
%:%1520=569%:%
%:%1521=569%:%
%:%1522=570%:%
%:%1523=570%:%
%:%1524=570%:%
%:%1525=570%:%
%:%1526=571%:%
%:%1527=572%:%
%:%1528=572%:%
%:%1529=572%:%
%:%1530=573%:%
%:%1531=573%:%
%:%1532=574%:%
%:%1533=574%:%
%:%1534=575%:%
%:%1535=575%:%
%:%1536=575%:%
%:%1537=576%:%
%:%1538=576%:%
%:%1539=577%:%
%:%1540=577%:%
%:%1541=578%:%
%:%1542=578%:%
%:%1543=579%:%
%:%1544=580%:%
%:%1545=580%:%
%:%1546=581%:%
%:%1547=581%:%
%:%1548=581%:%
%:%1549=581%:%
%:%1550=582%:%
%:%1551=582%:%
%:%1552=582%:%
%:%1553=582%:%
%:%1554=583%:%
%:%1555=583%:%
%:%1556=583%:%
%:%1557=584%:%
%:%1558=584%:%
%:%1559=584%:%
%:%1560=585%:%
%:%1561=585%:%
%:%1562=586%:%
%:%1563=586%:%
%:%1564=587%:%
%:%1565=587%:%
%:%1566=587%:%
%:%1567=587%:%
%:%1568=587%:%
%:%1569=588%:%
%:%1570=588%:%
%:%1571=588%:%
%:%1572=588%:%
%:%1573=589%:%
%:%1588=593%:%
%:%1598=595%:%
%:%1599=595%:%
%:%1606=596%:%
%:%1607=596%:%
%:%1608=597%:%
%:%1609=597%:%
%:%1610=598%:%
%:%1611=598%:%
%:%1612=598%:%
%:%1613=598%:%
%:%1614=598%:%
%:%1615=599%:%
%:%1616=599%:%
%:%1617=600%:%
%:%1618=600%:%
%:%1619=601%:%
%:%1620=601%:%
%:%1621=602%:%
%:%1622=602%:%
%:%1623=602%:%
%:%1624=602%:%
%:%1625=603%:%
%:%1626=604%:%
%:%1627=604%:%
%:%1628=605%:%
%:%1629=605%:%
%:%1630=605%:%
%:%1631=606%:%
%:%1632=606%:%
%:%1633=606%:%
%:%1634=607%:%
%:%1635=607%:%
%:%1636=607%:%
%:%1637=607%:%
%:%1638=608%:%
%:%1639=609%:%
%:%1640=609%:%
%:%1641=609%:%
%:%1642=610%:%
%:%1643=611%:%
%:%1644=612%:%
%:%1645=612%:%
%:%1646=612%:%
%:%1647=613%:%
%:%1648=613%:%
%:%1649=613%:%
%:%1650=613%:%
%:%1651=614%:%
%:%1652=614%:%
%:%1653=614%:%
%:%1654=615%:%
%:%1655=615%:%
%:%1656=616%:%
%:%1657=616%:%
%:%1658=616%:%
%:%1659=617%:%
%:%1660=617%:%
%:%1661=618%:%
%:%1662=618%:%
%:%1663=618%:%
%:%1664=618%:%
%:%1665=619%:%
%:%1666=619%:%
%:%1667=620%:%
%:%1668=620%:%
%:%1669=621%:%
%:%1670=621%:%
%:%1671=621%:%
%:%1672=621%:%
%:%1673=622%:%
%:%1674=622%:%
%:%1675=622%:%
%:%1676=622%:%
%:%1677=623%:%
%:%1678=623%:%
%:%1679=624%:%
%:%1685=624%:%
%:%1688=625%:%
%:%1691=626%:%
%:%1696=627%:%
