%
\begin{isabellebody}%
\setisabellecontext{Reg{\isacharunderscore}{\kern0pt}Lang{\isacharunderscore}{\kern0pt}Exp{\isacharunderscore}{\kern0pt}Eqns}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Context free grammars and systems of equations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isakeywordONE{theory}\isamarkupfalse%
\ Reg{\isacharunderscore}{\kern0pt}Lang{\isacharunderscore}{\kern0pt}Exp{\isacharunderscore}{\kern0pt}Eqns\isanewline
\ \ \isakeywordTWO{imports}\isanewline
\ \ \ \ {\isachardoublequoteopen}Parikh{\isacharunderscore}{\kern0pt}Img{\isachardoublequoteclose}\isanewline
\ \ \ \ {\isachardoublequoteopen}Context{\isacharunderscore}{\kern0pt}Free{\isacharunderscore}{\kern0pt}Grammar{\isachardot}{\kern0pt}Context{\isacharunderscore}{\kern0pt}Free{\isacharunderscore}{\kern0pt}Language{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\begin{isamarkuptext}%
In this section, we will first introduce two types of systems of
equations. Then we will show that to each CFG corresponds a system of equations of the first type 
and that the language defined by the CFG is a minimal solution of this systems. Lastly we prove
some relations between the two types of systems of equations.%
\end{isamarkuptext}\isamarkuptrue%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Introduction of systems of equations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
For the first type of systems, each equation is of the form
\[X_i \supseteq r_i\]
For the second type of systems, each equation is of the form
\[\Psi \; X_i \supseteq \Psi \; r_i\]
i.e.\ the Parikh image is applied on both sides of each equation.
In both cases, we represent the whole system by a list of regular language expressions where each
of the variables \isa{X\isactrlsub {\isadigit{0}}{\isacharcomma}{\kern0pt}\ X\isactrlsub {\isadigit{1}}{\isacharcomma}{\kern0pt}\ {\isasymdots}} is identified by its integer, i.e.\ \isa{\isaconst{Var}\ \isafree{i}} denotes the variable
\isa{X\isactrlsub i}. The \isa{i}-th item of the list then represents the right-hand side \isa{r\isactrlsub i} of the \isa{i}-th equation:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ {\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ rlexp\ list{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Now we can define what it means for a valuation \isa{v} to solve a system of equations of the
first type, i.e.\ a system without Parikh images. Afterwards we characterize minimal solutions of
such a system.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ valuation\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ v\ {\isasymequiv}\ {\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ v\ {\isasymsubseteq}\ v\ i{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ valuation\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol\ {\isasymequiv}\isanewline
\ \ \ \ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}sol{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isacharprime}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ sol\ x\ {\isasymsubseteq}\ sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The previous definitions can easily be extended to the second type of systems of equations
where the Parikh image is applied on both sides of each equation:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ valuation\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ x\ eq\ v\ {\isasymequiv}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ eq\ v{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ valuation\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ v\ {\isasymequiv}\ {\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardot}{\kern0pt}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ i\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ valuation\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol\ {\isasymequiv}\isanewline
\ \ \ \ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}sol{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isacharprime}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Substitution into each equation of a system:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}sys\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}subst{\isacharunderscore}{\kern0pt}sys\ {\isasymequiv}\ map\ {\isasymcirc}\ subst{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}subst{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}subst{\isacharunderscore}{\kern0pt}sys\ s\ sys{\isacharparenright}{\kern0pt}\ {\isacharbang}{\kern0pt}\ i\ {\isacharequal}{\kern0pt}\ subst\ s\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Partial solutions of systems of equations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
We introduce partial solutions, i.e.\ solutions which might depend on one or multiple
variables. They are therefore not represented as languages, but as regular language expressions.
\isa{sol} is a partial solution of the \isa{x}-th equation if and only if it solves the equation
independently on the values of the other variables:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq\ x\ eq\ sol\ {\isasymequiv}\ {\isasymforall}v{\isachardot}{\kern0pt}\ v\ x\ {\isacharequal}{\kern0pt}\ eval\ sol\ v\ {\isasymlongrightarrow}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ x\ eq\ v{\isachardoublequoteclose}%
\begin{isamarkuptext}%
We generalize the previous definition to partial solutions of whole systems of equations:
\isa{sols} maps each variable \isa{i} to a regular language expression representing the partial solution
of the \isa{i}-th equation. \isa{sols} is then a partial solution of the whole system if it satisfies the
following predicate:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sols\ {\isasymequiv}\ {\isasymforall}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ v\ x\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols\ x{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ v{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Given the \isa{x}-th equation \isa{eq}, \isa{sol} is a minimal partial solution of this equation if and
only if
\begin{enumerate}
  \item \isa{sol} is a partial solution of \isa{eq}
  \item \isa{sol} is a proper partial solution (i.e.\ it does not depend on \isa{x}) and only
    depends on variables occurring in the equation \isa{eq}
  \item no partial solution of the equation \isa{eq} is smaller than \isa{sol}
\end{enumerate}%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ x\ eq\ sol\ {\isasymequiv}\isanewline
\ \ \ \ partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq\ x\ eq\ sol\ {\isasymand}\isanewline
\ \ \ \ vars\ sol\ {\isasymsubseteq}\ vars\ eq\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}sol{\isacharprime}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ x\ eq\ v{\isacharprime}{\kern0pt}\ {\isasymand}\ v{\isacharprime}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ eval\ sol{\isacharprime}{\kern0pt}\ v{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ sol\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Given a whole system of equations \isa{sys}, we can generalize the previous definition such that
\isa{sols} is a minimal solution (possibly dependent on the variables $X_n, X_{n+1}, \dots$) of
the first \isa{n} equations. Besides the three conditions described above, we introduce a forth
condition: \isa{sols\ i\ {\isacharequal}{\kern0pt}\ Var\ i} for \isa{i\ {\isasymge}\ n}, i.e.\ \isa{sols} assigns only spurious solutions to the
equations which are not yet solved:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ eq{\isacharunderscore}{\kern0pt}sys\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ n\ sys\ sols\ {\isasymequiv}\isanewline
\ \ \ \ solution{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ {\isacharparenleft}{\kern0pt}take\ n\ sys{\isacharparenright}{\kern0pt}\ sols\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isasymge}\ n{\isachardot}{\kern0pt}\ sols\ i\ {\isacharequal}{\kern0pt}\ Var\ i{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isacharless}{\kern0pt}\ n{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isasymge}\ n\ {\isasymand}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}sols{\isacharprime}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ v{\isacharprime}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sols{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ {\isacharparenleft}{\kern0pt}take\ n\ sys{\isacharparenright}{\kern0pt}\ v{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}i{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sols\ i{\isacharparenright}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
If the Parikh image of two equations \isa{f} and \isa{g} is identical on all valuations, then their
minimal partial solutions are identical, too:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}same{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ same{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}v{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ g\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ same{\isacharunderscore}{\kern0pt}vars{\isacharcolon}{\kern0pt}\ \ \ \ \ \ \ {\isachardoublequoteopen}vars\ f\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ g\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ minimal{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ \ \ \ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ x\ f\ sol{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq\ x\ g\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ minimal{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ sol\ {\isasymsubseteq}\ vars\ g\ {\isacharminus}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}x{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}vars\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img\ minimal{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq\ x\ g\ sol{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ partial{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ same{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img\ minimal{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}sol{\isacharprime}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm\ x\ g\ v{\isacharprime}{\kern0pt}\ {\isasymand}\ v{\isacharprime}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ eval\ sol{\isacharprime}{\kern0pt}\ v{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ sol\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}v{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ partial{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{CFLs as minimal solutions to systems of equations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
\label{sec:cfl_as_eqns_sys}%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
We show that each CFG induces a system of equations of the first type, i.e.\ without Parikh images,
such that each equation is \isa{\isaconst{reg{\isacharunderscore}{\kern0pt}eval}} and the CFG's language is the minimal solution of the system.
First, we describe how to derive the system of equations from a CFG. This requires us to fix some
bijection between the variables in the system and the non-terminals occurring in the CFG:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}n\ set\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}n{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}n\ {\isasymRightarrow}\ nat{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ bool{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var\ A\ {\isasymgamma}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isasymequiv}\ bij{\isacharunderscore}{\kern0pt}betw\ {\isasymgamma}\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}\ A\ {\isasymand}\ bij{\isacharunderscore}{\kern0pt}betw\ {\isasymgamma}{\isacharprime}{\kern0pt}\ A\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}y\ {\isasymin}\ A{\isachardot}{\kern0pt}\ {\isasymgamma}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ y{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ exists{\isacharunderscore}{\kern0pt}bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}finite\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ \ \ {\isachardoublequoteopen}{\isasymexists}{\isasymgamma}\ {\isasymgamma}{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var\ A\ {\isasymgamma}\ {\isasymgamma}{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}{\isasymgamma}{\isachardot}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}betw\ {\isasymgamma}\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}\ A{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}card{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ {\isasymgamma}\ \isakeywordTWO{where}\ {\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ {\isasymgamma}\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}\ A{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}the{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}into\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}\ {\isasymgamma}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ the{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}into{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}f\ {\isadigit{1}}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{2}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}x\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharquery}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ x{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}the{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}into{\isacharbrackleft}{\kern0pt}OF\ {\isadigit{1}}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{3}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}betw\ {\isacharquery}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}\ card\ A{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isadigit{1}}\ f{\isacharunderscore}{\kern0pt}the{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}into{\isacharunderscore}{\kern0pt}f{\isacharunderscore}{\kern0pt}bij{\isacharunderscore}{\kern0pt}betw\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{4}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}y\ {\isasymin}\ A{\isachardot}{\kern0pt}\ {\isasymgamma}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ y{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ y{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ {\isadigit{1}}\ {\isadigit{2}}\ {\isadigit{3}}\ {\isadigit{4}}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{locale}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}sys\ {\isacharequal}{\kern0pt}\isanewline
\ \ \isakeywordTWO{fixes}\ P\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}n{\isacharcomma}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ Prods{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{fixes}\ S\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}n\isanewline
\ \ \isakeywordTWO{fixes}\ {\isasymgamma}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}n{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{fixes}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}n\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{assumes}\ finite{\isacharunderscore}{\kern0pt}P{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{assumes}\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ \ {\isachardoublequoteopen}bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}\ {\isasymgamma}\ {\isasymgamma}{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeywordTWO{begin}%
\begin{isamarkuptext}%
The following definitions construct a regular language expression for a single production. This
happens step by step, i.e.\ starting with a single symbol (terminal or non-terminal) and then extending
this to a single production. The definitions closely follow the definitions \isa{\isaconst{inst{\isacharunderscore}{\kern0pt}sym}},
\isa{\isaconst{concats}} and \isa{\isaconst{inst{\isacharunderscore}{\kern0pt}syms}} in \isa{Context{\isacharunderscore}{\kern0pt}Free{\isacharunderscore}{\kern0pt}Grammar{\isachardot}{\kern0pt}Context{\isacharunderscore}{\kern0pt}Free{\isacharunderscore}{\kern0pt}Language}.%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{definition}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}n{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ sym\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}rlexp{\isacharunderscore}{\kern0pt}sym\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ s\ of\ Tm\ a\ {\isasymRightarrow}\ Const\ {\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}a{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}\ {\isacharbar}{\kern0pt}\ Nt\ A\ {\isasymRightarrow}\ Var\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}a\ rlexp\ list\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}rlexp{\isacharunderscore}{\kern0pt}concats\ fs\ {\isacharequal}{\kern0pt}\ foldr\ Concat\ fs\ {\isacharparenleft}{\kern0pt}Const\ {\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{definition}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}n{\isacharcomma}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ syms\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ rlexp{\isachardoublequoteclose}\ \isakeywordTWO{where}\isanewline
\ \ {\isachardoublequoteopen}rlexp{\isacharunderscore}{\kern0pt}syms\ w\ {\isacharequal}{\kern0pt}\ rlexp{\isacharunderscore}{\kern0pt}concats\ {\isacharparenleft}{\kern0pt}map\ rlexp{\isacharunderscore}{\kern0pt}sym\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
Now it is shown that the regular language expression constructed for a single production
is \isa{\isaconst{reg{\isacharunderscore}{\kern0pt}eval}}. Again, this happens step by step:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ s{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Tm\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}regular{\isacharunderscore}{\kern0pt}lang\ {\isacharbraceleft}{\kern0pt}{\isacharbrackleft}{\kern0pt}x{\isacharbrackright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ lang{\isachardot}{\kern0pt}simps{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}f\ {\isasymin}\ set\ fs{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ f{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}concats\ fs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ fs{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}use\ epsilon{\isacharunderscore}{\kern0pt}regular\ \isakeywordTWO{in}\ auto{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}reg{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}syms\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}reg\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}s\ {\isasymin}\ set\ w{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}reg\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ image{\isacharunderscore}{\kern0pt}iff\ list{\isachardot}{\kern0pt}set{\isacharunderscore}{\kern0pt}map{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The subsequent lemmas prove that all variables appearing in the regular language
expression of a single production correspond to non-terminals appearing in the production:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}Nt{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}s\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}vars\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharparenleft}{\kern0pt}Nt\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}Tm{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}vars\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharparenleft}{\kern0pt}Tm\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}vars{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}vars\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}concats\ fs{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}vars\ {\isacharbackquote}{\kern0pt}\ set\ fs{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ fs{\isacharparenright}{\kern0pt}\ simp{\isacharunderscore}{\kern0pt}all%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ insts{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}vars{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}vars\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}syms\ w{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ nts{\isacharunderscore}{\kern0pt}syms\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}syms\ w{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}vars\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}vars\ {\isacharbackquote}{\kern0pt}\ set\ {\isacharparenleft}{\kern0pt}map\ rlexp{\isacharunderscore}{\kern0pt}sym\ w{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ f\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\ set\ {\isacharparenleft}{\kern0pt}map\ rlexp{\isacharunderscore}{\kern0pt}sym\ w{\isacharparenright}{\kern0pt}\ {\isasymand}\ x\ {\isasymin}\ vars\ f{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ s\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isasymin}\ set\ w\ {\isasymand}\ rlexp{\isacharunderscore}{\kern0pt}sym\ s\ {\isacharequal}{\kern0pt}\ f{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}Tm\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ A\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}s\ {\isacharequal}{\kern0pt}\ Nt\ A{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ empty{\isacharunderscore}{\kern0pt}iff\ sym{\isachardot}{\kern0pt}exhaust{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}A\ {\isasymin}\ nts{\isacharunderscore}{\kern0pt}syms\ w{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ nts{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}vars{\isacharunderscore}{\kern0pt}Nt\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharparenleft}{\kern0pt}Nt\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ nts{\isacharunderscore}{\kern0pt}syms\ w{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Evaluating the regular language expression of a single production under a valuation
corresponds to instantiating the non-terminals in the production according to the valuation:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}inst{\isacharunderscore}{\kern0pt}Nt{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}v\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharparenleft}{\kern0pt}Nt\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ inst{\isacharunderscore}{\kern0pt}sym\ L\ {\isacharparenleft}{\kern0pt}Nt\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}def\ inst{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}inst{\isacharunderscore}{\kern0pt}Tm{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharparenleft}{\kern0pt}Tm\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ inst{\isacharunderscore}{\kern0pt}sym\ L\ {\isacharparenleft}{\kern0pt}Tm\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}def\ inst{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}concats{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}length\ fs\ {\isacharequal}{\kern0pt}\ length\ Ls{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ fs{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}fs\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ Ls\ {\isacharbang}{\kern0pt}\ i{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}concats\ fs{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ concats\ Ls{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{using}\isamarkupfalse%
\ assms\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ fs\ arbitrary{\isacharcolon}{\kern0pt}\ Ls{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ Nil\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}def\ concats{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Cons\ f{\isadigit{1}}\ fs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ L{\isadigit{1}}\ Lr\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Ls\ {\isacharequal}{\kern0pt}\ L{\isadigit{1}}{\isacharhash}{\kern0pt}Lr{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ length{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}conv{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Cons\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}concats\ fs{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ concats\ Lr{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ Cons{\isachardot}{\kern0pt}prems\ {\isacharasterisk}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ f{\isadigit{1}}\ v\ {\isacharequal}{\kern0pt}\ L{\isadigit{1}}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}def\ concats{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharasterisk}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}insts{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}{\isasymforall}A\ {\isasymin}\ nts{\isacharunderscore}{\kern0pt}syms\ w{\isachardot}{\kern0pt}\ v\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}syms\ w{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ inst{\isacharunderscore}{\kern0pt}syms\ L\ w{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}{\kern0pt}\ length\ w{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharparenleft}{\kern0pt}w{\isacharbang}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ inst{\isacharunderscore}{\kern0pt}sym\ L\ {\isacharparenleft}{\kern0pt}w{\isacharbang}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}sym\ {\isacharparenleft}{\kern0pt}w\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ inst{\isacharunderscore}{\kern0pt}sym\ L\ {\isacharparenleft}{\kern0pt}w\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ {\isachardoublequoteopen}w{\isacharbang}{\kern0pt}i{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Nt\ A{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}v\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ nts{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}inst{\isacharunderscore}{\kern0pt}Nt\ Nt\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Tm\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}sym{\isacharunderscore}{\kern0pt}inst{\isacharunderscore}{\kern0pt}Tm\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}def\ inst{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}concats{\isacharunderscore}{\kern0pt}concats\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ length{\isacharunderscore}{\kern0pt}map\ nth{\isacharunderscore}{\kern0pt}map{\isacharparenright}{\kern0pt}\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Each non-terminal of the CFG induces some \isa{\isaconst{reg{\isacharunderscore}{\kern0pt}eval}} equation. We do not directly construct
the equation but only prove its existence:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}lang{\isacharunderscore}{\kern0pt}rlexp{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymexists}eq{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq\ {\isasymand}\ vars\ eq\ {\isasymsubseteq}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ Nts\ P\isanewline
\ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v\ L{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ v\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ eval\ eq\ v\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}Insts\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}rlexp{\isacharunderscore}{\kern0pt}syms\ {\isacharbackquote}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Rhss\ P\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}Rhss{\isacharbrackleft}{\kern0pt}OF\ finite{\isacharunderscore}{\kern0pt}P{\isacharbrackright}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharquery}{\kern0pt}Insts{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}reg\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}f\ {\isasymin}\ {\isacharquery}{\kern0pt}Insts{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ f{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ eq\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}reg{\isacharunderscore}{\kern0pt}eval\ eq\ {\isasymand}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}vars\ {\isacharbackquote}{\kern0pt}\ {\isacharquery}{\kern0pt}Insts{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ vars\ eq\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}f\ {\isasymin}\ {\isacharquery}{\kern0pt}Insts{\isachardot}{\kern0pt}\ eval\ f\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ eval\ eq\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}regular\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}vars\ eq\ {\isasymsubseteq}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ Nts\ P{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ x\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ vars\ eq{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ f\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}f\ {\isasymin}\ {\isacharquery}{\kern0pt}Insts\ {\isasymand}\ x\ {\isasymin}\ vars\ f{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ w\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymin}\ Rhss\ P\ A\ {\isasymand}\ f\ {\isacharequal}{\kern0pt}\ rlexp{\isacharunderscore}{\kern0pt}syms\ w{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ insts{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}vars\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ nts{\isacharunderscore}{\kern0pt}syms\ w{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isasymin}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ Nts\ P{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ Nts{\isacharunderscore}{\kern0pt}def\ Rhss{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}v\ L{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ v\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ eval\ eq\ v\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ A{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI\ {\isacharbar}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ v\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ lang{\isachardoublequoteclose}\ \isakeywordTWO{and}\ L\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}n\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a\ lang{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ state{\isacharunderscore}{\kern0pt}L{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ v\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}w\ {\isasymin}\ Rhss\ P\ A{\isachardot}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}syms\ w{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ inst{\isacharunderscore}{\kern0pt}syms\ L\ w{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ w\isanewline
\ \ \ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}w\ {\isasymin}\ Rhss\ P\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ state{\isacharunderscore}{\kern0pt}L\ Nts{\isacharunderscore}{\kern0pt}nts{\isacharunderscore}{\kern0pt}syms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}A\ {\isasymin}\ nts{\isacharunderscore}{\kern0pt}syms\ w{\isachardot}{\kern0pt}\ v\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ fast\isanewline
\ \ \ \ \ \ \isakeywordONE{from}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}syms{\isacharunderscore}{\kern0pt}insts{\isacharbrackleft}{\kern0pt}OF\ this{\isacharbrackright}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}rlexp{\isacharunderscore}{\kern0pt}syms\ w{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ inst{\isacharunderscore}{\kern0pt}syms\ L\ w{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ A\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}f\ {\isasymin}\ {\isacharquery}{\kern0pt}Insts{\isachardot}{\kern0pt}\ eval\ f\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}lang{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ eq\ v\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ A{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The whole CFG induces a system of \isa{\isaconst{reg{\isacharunderscore}{\kern0pt}eval}} equations. We first define which conditions
this system should fulfill and show its existence in the second step:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}CFG{\isacharunderscore}{\kern0pt}sys\ sys\ {\isasymequiv}\isanewline
\ \ length\ sys\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}\ {\isasymand}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isasymin}\ vars\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}s\ L{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ s\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymlongrightarrow}\ eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}sys{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}sys{\isachardot}{\kern0pt}\ CFG{\isacharunderscore}{\kern0pt}sys\ sys{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}eq{\isachardot}{\kern0pt}\ vars\ eq\ {\isasymsubseteq}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ Nts\ P\ {\isasymLongrightarrow}\ {\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}lang{\isacharunderscore}{\kern0pt}rlexp\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}A{\isachardot}{\kern0pt}\ {\isasymexists}eq{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq\ {\isasymand}\ vars\ eq\ {\isasymsubseteq}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ Nts\ P\ {\isasymand}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymforall}s\ L{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ s\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ eval\ eq\ s\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ A{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isasymexists}eq{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}s\ L{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ s\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ eval\ eq\ s\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ Skolem{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}nth{\isacharbrackleft}{\kern0pt}\isakeywordTWO{where}\ P{\isacharequal}{\kern0pt}{\isachardoublequoteopen}{\isasymlambda}i\ eq{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}s\ L{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ s\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L\ A{\isacharparenright}{\kern0pt}\ {\isasymlongrightarrow}\ eval\ eq\ s\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ L\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
As we have proved that each CFG induces a system of \isa{\isaconst{reg{\isacharunderscore}{\kern0pt}eval}} equations, it remains to
show that the  CFG's language is a minimal solution of this system. The first lemma proves that
the CFG's language is a solution and the next two lemmas prove that it is minimal:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}sol\ {\isasymequiv}\ {\isasymlambda}i{\isachardot}{\kern0pt}\ if\ i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}\ then\ Lang{\isacharunderscore}{\kern0pt}lfp\ P\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}\ else\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}CFG{\isacharunderscore}{\kern0pt}sys\ sys{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ i\isanewline
\ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ argo\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}A\ {\isasymin}\ Nts\ P{\isachardot}{\kern0pt}\ sol\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ Lang{\isacharunderscore}{\kern0pt}lfp\ P\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ force\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacartoucheopen}i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ sol\ {\isacharequal}{\kern0pt}\ subst{\isacharunderscore}{\kern0pt}lang\ P\ {\isacharparenleft}{\kern0pt}Lang{\isacharunderscore}{\kern0pt}lfp\ P{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ lfp{\isacharunderscore}{\kern0pt}fixpoint{\isacharbrackleft}{\kern0pt}OF\ mono{\isacharunderscore}{\kern0pt}if{\isacharunderscore}{\kern0pt}omega{\isacharunderscore}{\kern0pt}cont{\isacharbrackleft}{\kern0pt}OF\ omega{\isacharunderscore}{\kern0pt}cont{\isacharunderscore}{\kern0pt}Lang{\isacharunderscore}{\kern0pt}lfp{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ sol\ {\isacharequal}{\kern0pt}\ Lang{\isacharunderscore}{\kern0pt}lfp\ P\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ Lang{\isacharunderscore}{\kern0pt}lfp{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ {\isacartoucheopen}i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymgamma}\ i\ {\isasymin}\ Nts\ P{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{using}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}betwE\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{with}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Lang{\isacharunderscore}{\kern0pt}lfp\ P\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ sol\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ sol\ i{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacartoucheopen}i\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ sol\ {\isasymsubseteq}\ sol\ i{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ {\isadigit{1}}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}aux{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}CFG{\isacharunderscore}{\kern0pt}sys\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}Lang{\isacharunderscore}{\kern0pt}lfp\ P\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}A{\isachardot}{\kern0pt}\ sol{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeywordTWO{is}\ {\isachardoublequoteopen}{\isacharunderscore}{\kern0pt}\ {\isasymle}\ {\isacharquery}{\kern0pt}L{\isacharprime}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}subst{\isacharunderscore}{\kern0pt}lang\ P\ {\isacharquery}{\kern0pt}L{\isacharprime}{\kern0pt}\ A\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}L{\isacharprime}{\kern0pt}\ A{\isachardoublequoteclose}\ \isakeywordTWO{for}\ A\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}A\ {\isasymin}\ Nts\ P{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymgamma}{\isacharprime}{\kern0pt}\ A\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ True\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}subst{\isacharunderscore}{\kern0pt}lang\ P\ {\isacharquery}{\kern0pt}L{\isacharprime}{\kern0pt}\ A\ {\isacharequal}{\kern0pt}\ eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ {\isasymgamma}{\isacharprime}{\kern0pt}\ A{\isacharparenright}{\kern0pt}\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ True\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isacartoucheopen}{\isasymgamma}{\isacharprime}{\kern0pt}\ A\ {\isacharless}{\kern0pt}\ length\ sys{\isacartoucheclose}\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}L{\isacharprime}{\kern0pt}\ A{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Rhss\ P\ A\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ Nts{\isacharunderscore}{\kern0pt}def\ Rhss{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ False\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{unfolding}\isamarkupfalse%
\ subst{\isacharunderscore}{\kern0pt}lang{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}subst{\isacharunderscore}{\kern0pt}lang\ P\ {\isacharquery}{\kern0pt}L{\isacharprime}{\kern0pt}\ {\isasymle}\ {\isacharquery}{\kern0pt}L{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}funI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ lfp{\isacharunderscore}{\kern0pt}lowerbound{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}subst{\isacharunderscore}{\kern0pt}lang\ P{\isachardoublequoteclose}{\isacharcomma}{\kern0pt}\ OF\ this{\isacharbrackright}{\kern0pt}\ Lang{\isacharunderscore}{\kern0pt}lfp{\isacharunderscore}{\kern0pt}def\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordONE{lemma}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}CFG{\isacharunderscore}{\kern0pt}sys\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}sol\ x\ {\isasymsubseteq}\ sol{\isacharprime}{\kern0pt}\ x{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ True\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sol\ x\ {\isacharequal}{\kern0pt}\ Lang{\isacharunderscore}{\kern0pt}lfp\ P\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ argo\isanewline
\ \ \isakeywordONE{also}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}aux{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharbrackright}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymsubseteq}\ sol{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymgamma}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}fun{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{finally}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{using}\isamarkupfalse%
\ True\ bij{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharunderscore}{\kern0pt}{\isasymgamma}{\isacharprime}{\kern0pt}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ bij{\isacharunderscore}{\kern0pt}Nt{\isacharunderscore}{\kern0pt}Var{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{next}\isamarkupfalse%
\isanewline
\ \ \isakeywordTHREE{case}\isamarkupfalse%
\ False\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Lastly we combine all of the previous lemmas into the desired result of this section, namely
that each CFG induces a system of \isa{\isaconst{reg{\isacharunderscore}{\kern0pt}eval}} equations such that the CFG's language is a
minimal solution of the system:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymexists}sys{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymand}\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}as{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}sys\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ sys\ \isakeywordTWO{where}\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}CFG{\isacharunderscore}{\kern0pt}sys\ sys{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}length\ sys\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ reg{\isacharunderscore}{\kern0pt}eval\ eq{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ all{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}nth{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\ {\isacartoucheopen}length\ sys\ {\isacharequal}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}Nts\ P{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}eq\ {\isasymin}\ set\ sys{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isasymin}\ vars\ eq{\isachardot}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ all{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}conv{\isacharunderscore}{\kern0pt}all{\isacharunderscore}{\kern0pt}nth{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ CFG{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharbrackleft}{\kern0pt}OF\ {\isacharasterisk}{\kern0pt}{\isacharbrackright}{\kern0pt}\ CFG{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}CFL{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharbrackleft}{\kern0pt}OF\ {\isacharasterisk}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isakeywordTWO{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Relation between the two types of systems of equations%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
\label{sec:eqns_sys_relations}%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
One can simply convert a system \isa{sys} of equations of the second type (i.e.\ with Parikh
images) into a system of equations of the first type by dropping the Parikh images on both sides of
each equation. The following lemmas describe how the two systems are related to each other.

First of all, to any solution \isa{sol} of \isa{sys} exists a valuation whose Parikh image is
identical to that of \isa{sol} and which is a solution of the other system (i.e.\ the system obtained
by dropping all Parikh images in \isa{sys}). The following proof explicitly gives such a solution,
namely \isa{{\isasymlambda}\isabound{x}{\isachardot}{\kern0pt}\ {\isasymUnion}\ {\isacharparenleft}{\kern0pt}\isaconst{parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class}\ {\isacharparenleft}{\kern0pt}\isafree{sol}\ \isabound{x}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}}, benefiting from the results of section \ref{sec:parikh_eq_class}:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}comm{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isachardoublequoteclose}\isanewline
\ \ \isakeywordTWO{shows}\ \ \ {\isachardoublequoteopen}{\isasymexists}sol{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}x{\isachardot}{\kern0pt}\ {\isasymUnion}{\isacharparenleft}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}class\ {\isacharparenleft}{\kern0pt}sol\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{have}\isamarkupfalse%
\ sol{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}Union{\isacharunderscore}{\kern0pt}class\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ {\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ i\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}i\ {\isacharless}{\kern0pt}\ length\ sys{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}comm\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ sol{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ sol{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ sol{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ rlexp{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}parikh{\isacharunderscore}{\kern0pt}eq\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\ \ \ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \ \ \isakeywordONE{then}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}eval\ {\isacharparenleft}{\kern0pt}sys\ {\isacharbang}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}\ i{\isachardoublequoteclose}\ \isakeywordONE{using}\isamarkupfalse%
\ subseteq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}subseteq\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ {\isacharquery}{\kern0pt}sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The converse works similarly: Given a minimal solution \isa{sol} of the system \isa{sys} of the first type,
then \isa{sol} is also a minimal solution to the system obtained by converting \isa{sys} into a system of the second
type (which can be achieved by applying the Parikh image on both sides of each equation):%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}comm{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{proof}\isamarkupfalse%
\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ assms\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}\ {\isasymforall}sol{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isacharprime}{\kern0pt}\ {\isasymlongrightarrow}\ {\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeywordONE{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ allI{\isacharcomma}{\kern0pt}\ rule\ impI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{fix}\isamarkupfalse%
\ sol{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \isakeywordTHREE{assume}\isamarkupfalse%
\ {\isachardoublequoteopen}solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ sol{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}sol\ \isakeywordTHREE{obtain}\isamarkupfalse%
\ sol{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ \isakeywordTWO{where}\ sol{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro{\isacharcolon}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymforall}x{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ solves{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys\ sys\ sol{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\ \isakeywordONE{by}\isamarkupfalse%
\ meson\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ assms\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}{\kern0pt}\ sol\ x\ {\isasymsubseteq}\ sol{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}\ x{\isachardoublequoteclose}\ \isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isakeywordONE{with}\isamarkupfalse%
\ sol{\isacharprime}{\kern0pt}{\isacharprime}{\kern0pt}{\isacharunderscore}{\kern0pt}intro\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}x{\isachardot}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isacharprime}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordONE{using}\isamarkupfalse%
\ parikh{\isacharunderscore}{\kern0pt}img{\isacharunderscore}{\kern0pt}mono\ \isakeywordONE{by}\isamarkupfalse%
\ metis\isanewline
\ \ \isakeywordONE{qed}\isamarkupfalse%
\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
All minimal solutions of a system of the second type have the same Parikh image:%
\end{isamarkuptext}\isamarkuptrue%
\isakeywordONE{lemma}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeywordTWO{assumes}\ sol{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isakeywordTWO{and}\ sol{\isadigit{2}}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm\ sys\ sol{\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordTWO{shows}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isadigit{1}}\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isakeywordONE{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isakeywordONE{from}\isamarkupfalse%
\ sol{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol\ sol{\isadigit{2}}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isadigit{1}}\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{moreover}\isamarkupfalse%
\ \isakeywordONE{from}\isamarkupfalse%
\ sol{\isadigit{1}}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol\ sol{\isadigit{2}}{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}min{\isacharunderscore}{\kern0pt}sol\ \isakeywordONE{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isadigit{2}}\ x{\isacharparenright}{\kern0pt}\ {\isasymsubseteq}\ {\isasymPsi}\ {\isacharparenleft}{\kern0pt}sol{\isadigit{1}}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeywordONE{unfolding}\isamarkupfalse%
\ min{\isacharunderscore}{\kern0pt}sol{\isacharunderscore}{\kern0pt}ineq{\isacharunderscore}{\kern0pt}sys{\isacharunderscore}{\kern0pt}comm{\isacharunderscore}{\kern0pt}def\ \isakeywordONE{by}\isamarkupfalse%
\ simp\isanewline
\ \ \isakeywordONE{ultimately}\isamarkupfalse%
\ \isakeywordTHREE{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isakeywordONE{by}\isamarkupfalse%
\ blast\isanewline
\isakeywordONE{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isakeywordTWO{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=~/studium/semester_7/semantik/homeworks/AIST/Parikh/Reg_Lang_Exp_Eqns.thy%:%
%:%11=3%:%
%:%27=5%:%
%:%28=5%:%
%:%29=6%:%
%:%30=7%:%
%:%31=8%:%
%:%32=9%:%
%:%41=11%:%
%:%42=12%:%
%:%43=13%:%
%:%44=14%:%
%:%53=17%:%
%:%65=19%:%
%:%66=20%:%
%:%67=21%:%
%:%68=22%:%
%:%69=23%:%
%:%70=24%:%
%:%71=25%:%
%:%72=26%:%
%:%74=28%:%
%:%75=28%:%
%:%77=31%:%
%:%78=32%:%
%:%79=33%:%
%:%81=34%:%
%:%82=34%:%
%:%83=35%:%
%:%84=36%:%
%:%85=37%:%
%:%86=37%:%
%:%87=38%:%
%:%90=42%:%
%:%91=43%:%
%:%93=44%:%
%:%94=44%:%
%:%95=45%:%
%:%96=46%:%
%:%97=47%:%
%:%98=47%:%
%:%99=48%:%
%:%100=49%:%
%:%101=50%:%
%:%102=50%:%
%:%103=51%:%
%:%107=55%:%
%:%109=56%:%
%:%110=56%:%
%:%111=57%:%
%:%112=58%:%
%:%113=59%:%
%:%114=59%:%
%:%115=60%:%
%:%116=61%:%
%:%119=62%:%
%:%123=62%:%
%:%124=62%:%
%:%125=62%:%
%:%139=65%:%
%:%151=67%:%
%:%152=68%:%
%:%153=69%:%
%:%154=70%:%
%:%156=71%:%
%:%157=71%:%
%:%158=72%:%
%:%160=74%:%
%:%161=75%:%
%:%162=76%:%
%:%163=77%:%
%:%165=78%:%
%:%166=78%:%
%:%167=79%:%
%:%169=81%:%
%:%170=82%:%
%:%171=83%:%
%:%172=84%:%
%:%173=85%:%
%:%174=86%:%
%:%175=87%:%
%:%176=88%:%
%:%178=90%:%
%:%179=90%:%
%:%180=91%:%
%:%186=97%:%
%:%187=98%:%
%:%188=99%:%
%:%189=100%:%
%:%190=101%:%
%:%192=102%:%
%:%193=102%:%
%:%194=103%:%
%:%202=112%:%
%:%203=113%:%
%:%205=114%:%
%:%206=114%:%
%:%207=115%:%
%:%208=116%:%
%:%209=117%:%
%:%210=118%:%
%:%217=119%:%
%:%218=119%:%
%:%219=120%:%
%:%220=120%:%
%:%221=120%:%
%:%222=121%:%
%:%223=121%:%
%:%224=121%:%
%:%225=121%:%
%:%226=122%:%
%:%227=122%:%
%:%228=122%:%
%:%229=122%:%
%:%230=123%:%
%:%231=123%:%
%:%232=123%:%
%:%233=124%:%
%:%234=124%:%
%:%235=124%:%
%:%236=124%:%
%:%237=125%:%
%:%238=126%:%
%:%239=126%:%
%:%240=126%:%
%:%241=127%:%
%:%242=127%:%
%:%243=127%:%
%:%244=127%:%
%:%245=127%:%
%:%246=128%:%
%:%261=132%:%
%:%273=134%:%
%:%277=135%:%
%:%278=136%:%
%:%279=137%:%
%:%280=138%:%
%:%282=140%:%
%:%283=140%:%
%:%284=141%:%
%:%285=142%:%
%:%286=143%:%
%:%287=144%:%
%:%288=144%:%
%:%289=145%:%
%:%290=146%:%
%:%297=147%:%
%:%298=147%:%
%:%299=148%:%
%:%300=148%:%
%:%301=148%:%
%:%302=148%:%
%:%303=149%:%
%:%304=149%:%
%:%305=149%:%
%:%306=149%:%
%:%307=150%:%
%:%308=150%:%
%:%309=151%:%
%:%310=151%:%
%:%311=151%:%
%:%312=151%:%
%:%313=151%:%
%:%314=152%:%
%:%315=152%:%
%:%316=152%:%
%:%317=152%:%
%:%318=153%:%
%:%319=153%:%
%:%320=153%:%
%:%321=153%:%
%:%322=154%:%
%:%323=154%:%
%:%324=154%:%
%:%325=154%:%
%:%326=154%:%
%:%327=155%:%
%:%333=155%:%
%:%336=156%:%
%:%337=157%:%
%:%338=158%:%
%:%339=158%:%
%:%340=159%:%
%:%341=160%:%
%:%342=161%:%
%:%343=162%:%
%:%344=163%:%
%:%345=164%:%
%:%346=165%:%
%:%348=167%:%
%:%349=168%:%
%:%350=169%:%
%:%351=170%:%
%:%353=172%:%
%:%354=172%:%
%:%355=173%:%
%:%356=174%:%
%:%357=175%:%
%:%358=175%:%
%:%359=176%:%
%:%360=177%:%
%:%361=178%:%
%:%362=178%:%
%:%363=179%:%
%:%365=182%:%
%:%366=183%:%
%:%368=185%:%
%:%369=185%:%
%:%376=186%:%
%:%377=186%:%
%:%378=186%:%
%:%379=187%:%
%:%380=187%:%
%:%381=188%:%
%:%382=188%:%
%:%383=188%:%
%:%384=189%:%
%:%385=189%:%
%:%386=189%:%
%:%387=189%:%
%:%388=190%:%
%:%389=190%:%
%:%394=190%:%
%:%397=191%:%
%:%398=192%:%
%:%399=192%:%
%:%400=193%:%
%:%401=194%:%
%:%404=195%:%
%:%408=195%:%
%:%409=195%:%
%:%410=195%:%
%:%411=195%:%
%:%416=195%:%
%:%419=196%:%
%:%420=197%:%
%:%421=197%:%
%:%428=198%:%
%:%429=198%:%
%:%430=199%:%
%:%431=199%:%
%:%432=199%:%
%:%433=199%:%
%:%434=200%:%
%:%435=200%:%
%:%436=200%:%
%:%437=200%:%
%:%438=201%:%
%:%439=201%:%
%:%440=202%:%
%:%450=205%:%
%:%451=206%:%
%:%453=208%:%
%:%454=208%:%
%:%455=209%:%
%:%456=210%:%
%:%459=211%:%
%:%463=211%:%
%:%464=211%:%
%:%465=211%:%
%:%466=211%:%
%:%471=211%:%
%:%474=212%:%
%:%475=213%:%
%:%476=213%:%
%:%479=214%:%
%:%483=214%:%
%:%484=214%:%
%:%485=214%:%
%:%490=214%:%
%:%493=215%:%
%:%494=216%:%
%:%495=216%:%
%:%498=217%:%
%:%502=217%:%
%:%503=217%:%
%:%504=217%:%
%:%509=217%:%
%:%512=218%:%
%:%513=219%:%
%:%514=220%:%
%:%515=220%:%
%:%522=221%:%
%:%523=221%:%
%:%524=222%:%
%:%525=222%:%
%:%526=223%:%
%:%527=223%:%
%:%528=224%:%
%:%529=224%:%
%:%530=224%:%
%:%531=225%:%
%:%532=225%:%
%:%533=225%:%
%:%534=226%:%
%:%535=226%:%
%:%536=226%:%
%:%537=226%:%
%:%538=227%:%
%:%539=227%:%
%:%540=227%:%
%:%541=227%:%
%:%542=228%:%
%:%543=228%:%
%:%544=228%:%
%:%545=228%:%
%:%546=229%:%
%:%547=229%:%
%:%548=229%:%
%:%549=229%:%
%:%550=229%:%
%:%551=230%:%
%:%552=230%:%
%:%553=230%:%
%:%554=230%:%
%:%555=231%:%
%:%556=231%:%
%:%557=231%:%
%:%558=231%:%
%:%559=232%:%
%:%569=235%:%
%:%570=236%:%
%:%572=238%:%
%:%573=238%:%
%:%574=239%:%
%:%575=240%:%
%:%578=241%:%
%:%582=241%:%
%:%583=241%:%
%:%584=241%:%
%:%585=241%:%
%:%590=241%:%
%:%593=242%:%
%:%594=243%:%
%:%595=243%:%
%:%598=244%:%
%:%602=244%:%
%:%603=244%:%
%:%604=244%:%
%:%609=244%:%
%:%612=245%:%
%:%613=246%:%
%:%614=246%:%
%:%615=247%:%
%:%616=248%:%
%:%617=249%:%
%:%624=250%:%
%:%625=250%:%
%:%626=250%:%
%:%627=251%:%
%:%628=251%:%
%:%629=252%:%
%:%630=252%:%
%:%631=252%:%
%:%632=252%:%
%:%633=252%:%
%:%634=253%:%
%:%635=253%:%
%:%636=254%:%
%:%637=254%:%
%:%638=255%:%
%:%639=255%:%
%:%640=255%:%
%:%641=255%:%
%:%642=256%:%
%:%643=256%:%
%:%644=256%:%
%:%645=256%:%
%:%646=257%:%
%:%647=257%:%
%:%648=257%:%
%:%649=257%:%
%:%650=257%:%
%:%651=258%:%
%:%652=258%:%
%:%653=258%:%
%:%654=258%:%
%:%655=258%:%
%:%656=259%:%
%:%662=259%:%
%:%665=260%:%
%:%666=261%:%
%:%667=261%:%
%:%668=262%:%
%:%669=263%:%
%:%676=264%:%
%:%677=264%:%
%:%678=265%:%
%:%679=265%:%
%:%680=266%:%
%:%681=266%:%
%:%682=267%:%
%:%683=267%:%
%:%684=268%:%
%:%685=268%:%
%:%686=269%:%
%:%687=269%:%
%:%688=269%:%
%:%689=270%:%
%:%690=270%:%
%:%691=271%:%
%:%692=271%:%
%:%693=272%:%
%:%694=272%:%
%:%695=272%:%
%:%696=272%:%
%:%697=272%:%
%:%698=273%:%
%:%699=273%:%
%:%700=273%:%
%:%701=273%:%
%:%702=274%:%
%:%703=274%:%
%:%704=275%:%
%:%705=275%:%
%:%706=276%:%
%:%707=276%:%
%:%708=276%:%
%:%709=276%:%
%:%710=277%:%
%:%711=277%:%
%:%712=278%:%
%:%713=278%:%
%:%714=279%:%
%:%715=279%:%
%:%716=279%:%
%:%717=279%:%
%:%718=279%:%
%:%719=280%:%
%:%720=280%:%
%:%721=281%:%
%:%731=284%:%
%:%732=285%:%
%:%734=286%:%
%:%735=286%:%
%:%736=287%:%
%:%737=288%:%
%:%744=289%:%
%:%745=289%:%
%:%746=290%:%
%:%747=290%:%
%:%748=291%:%
%:%749=291%:%
%:%750=291%:%
%:%751=291%:%
%:%752=292%:%
%:%753=292%:%
%:%754=292%:%
%:%755=292%:%
%:%756=292%:%
%:%757=293%:%
%:%758=293%:%
%:%759=293%:%
%:%760=294%:%
%:%761=295%:%
%:%762=295%:%
%:%763=295%:%
%:%764=296%:%
%:%765=296%:%
%:%766=296%:%
%:%767=297%:%
%:%768=297%:%
%:%769=298%:%
%:%770=298%:%
%:%771=299%:%
%:%772=299%:%
%:%773=300%:%
%:%774=300%:%
%:%775=300%:%
%:%776=300%:%
%:%777=301%:%
%:%778=301%:%
%:%779=301%:%
%:%780=301%:%
%:%781=302%:%
%:%782=302%:%
%:%783=302%:%
%:%784=302%:%
%:%785=303%:%
%:%786=303%:%
%:%787=303%:%
%:%788=303%:%
%:%789=303%:%
%:%790=304%:%
%:%791=304%:%
%:%792=305%:%
%:%793=305%:%
%:%794=305%:%
%:%795=306%:%
%:%796=306%:%
%:%797=307%:%
%:%798=307%:%
%:%799=308%:%
%:%800=308%:%
%:%801=309%:%
%:%802=309%:%
%:%803=310%:%
%:%804=310%:%
%:%805=311%:%
%:%806=311%:%
%:%807=312%:%
%:%808=312%:%
%:%809=313%:%
%:%810=313%:%
%:%811=313%:%
%:%812=313%:%
%:%813=314%:%
%:%814=314%:%
%:%815=314%:%
%:%816=314%:%
%:%817=315%:%
%:%818=315%:%
%:%819=316%:%
%:%820=316%:%
%:%821=316%:%
%:%822=316%:%
%:%823=316%:%
%:%824=317%:%
%:%825=317%:%
%:%826=317%:%
%:%827=317%:%
%:%828=318%:%
%:%829=318%:%
%:%830=319%:%
%:%831=319%:%
%:%832=319%:%
%:%833=319%:%
%:%834=320%:%
%:%844=323%:%
%:%845=324%:%
%:%847=326%:%
%:%848=326%:%
%:%852=330%:%
%:%853=331%:%
%:%854=332%:%
%:%855=332%:%
%:%862=333%:%
%:%863=333%:%
%:%864=334%:%
%:%865=334%:%
%:%866=334%:%
%:%867=335%:%
%:%868=335%:%
%:%869=335%:%
%:%870=336%:%
%:%871=336%:%
%:%872=336%:%
%:%873=337%:%
%:%874=338%:%
%:%875=338%:%
%:%876=339%:%
%:%877=339%:%
%:%878=339%:%
%:%879=340%:%
%:%880=341%:%
%:%881=341%:%
%:%882=341%:%
%:%883=342%:%
%:%884=342%:%
%:%885=343%:%
%:%886=344%:%
%:%887=344%:%
%:%888=344%:%
%:%889=345%:%
%:%899=348%:%
%:%900=349%:%
%:%901=350%:%
%:%903=352%:%
%:%904=352%:%
%:%905=353%:%
%:%906=354%:%
%:%907=354%:%
%:%908=355%:%
%:%909=356%:%
%:%916=357%:%
%:%917=357%:%
%:%918=357%:%
%:%919=358%:%
%:%920=358%:%
%:%921=359%:%
%:%922=359%:%
%:%923=360%:%
%:%924=360%:%
%:%925=360%:%
%:%926=360%:%
%:%927=361%:%
%:%928=361%:%
%:%929=361%:%
%:%930=362%:%
%:%931=362%:%
%:%932=362%:%
%:%933=363%:%
%:%934=363%:%
%:%935=363%:%
%:%936=364%:%
%:%937=364%:%
%:%938=365%:%
%:%939=365%:%
%:%940=365%:%
%:%941=366%:%
%:%942=366%:%
%:%943=366%:%
%:%944=367%:%
%:%945=367%:%
%:%946=367%:%
%:%947=368%:%
%:%948=368%:%
%:%949=368%:%
%:%950=368%:%
%:%951=369%:%
%:%952=369%:%
%:%953=369%:%
%:%954=369%:%
%:%955=370%:%
%:%956=370%:%
%:%957=370%:%
%:%958=370%:%
%:%959=370%:%
%:%960=370%:%
%:%961=371%:%
%:%962=371%:%
%:%963=371%:%
%:%964=371%:%
%:%965=371%:%
%:%966=372%:%
%:%972=372%:%
%:%975=373%:%
%:%976=374%:%
%:%977=374%:%
%:%978=375%:%
%:%979=376%:%
%:%980=377%:%
%:%987=378%:%
%:%988=378%:%
%:%989=379%:%
%:%990=379%:%
%:%991=380%:%
%:%992=380%:%
%:%993=381%:%
%:%994=381%:%
%:%995=382%:%
%:%996=382%:%
%:%997=382%:%
%:%998=383%:%
%:%999=383%:%
%:%1000=383%:%
%:%1001=384%:%
%:%1002=384%:%
%:%1003=384%:%
%:%1004=385%:%
%:%1005=385%:%
%:%1006=385%:%
%:%1007=386%:%
%:%1008=386%:%
%:%1009=386%:%
%:%1010=386%:%
%:%1011=387%:%
%:%1012=387%:%
%:%1013=387%:%
%:%1014=388%:%
%:%1015=388%:%
%:%1016=388%:%
%:%1017=388%:%
%:%1018=389%:%
%:%1019=389%:%
%:%1020=390%:%
%:%1021=390%:%
%:%1022=391%:%
%:%1023=391%:%
%:%1024=391%:%
%:%1025=391%:%
%:%1026=391%:%
%:%1027=392%:%
%:%1028=392%:%
%:%1029=392%:%
%:%1030=392%:%
%:%1031=392%:%
%:%1032=393%:%
%:%1033=393%:%
%:%1034=394%:%
%:%1035=394%:%
%:%1036=394%:%
%:%1037=394%:%
%:%1038=395%:%
%:%1039=395%:%
%:%1040=395%:%
%:%1041=395%:%
%:%1042=396%:%
%:%1048=396%:%
%:%1051=397%:%
%:%1052=398%:%
%:%1053=398%:%
%:%1054=399%:%
%:%1055=400%:%
%:%1056=401%:%
%:%1063=402%:%
%:%1064=402%:%
%:%1065=403%:%
%:%1066=403%:%
%:%1067=404%:%
%:%1068=404%:%
%:%1069=404%:%
%:%1070=404%:%
%:%1071=405%:%
%:%1072=405%:%
%:%1073=405%:%
%:%1074=405%:%
%:%1075=405%:%
%:%1076=406%:%
%:%1077=406%:%
%:%1078=406%:%
%:%1079=406%:%
%:%1080=406%:%
%:%1081=406%:%
%:%1082=407%:%
%:%1083=407%:%
%:%1084=408%:%
%:%1085=408%:%
%:%1086=409%:%
%:%1087=409%:%
%:%1088=409%:%
%:%1089=409%:%
%:%1090=410%:%
%:%1100=413%:%
%:%1101=414%:%
%:%1102=415%:%
%:%1104=416%:%
%:%1105=416%:%
%:%1106=417%:%
%:%1107=418%:%
%:%1114=419%:%
%:%1115=419%:%
%:%1116=420%:%
%:%1117=420%:%
%:%1118=420%:%
%:%1119=420%:%
%:%1120=421%:%
%:%1121=421%:%
%:%1122=421%:%
%:%1123=421%:%
%:%1124=422%:%
%:%1125=422%:%
%:%1126=422%:%
%:%1127=422%:%
%:%1128=422%:%
%:%1129=423%:%
%:%1130=423%:%
%:%1131=423%:%
%:%1132=423%:%
%:%1133=424%:%
%:%1134=424%:%
%:%1135=425%:%
%:%1136=425%:%
%:%1137=425%:%
%:%1138=426%:%
%:%1139=426%:%
%:%1140=426%:%
%:%1141=426%:%
%:%1142=427%:%
%:%1143=427%:%
%:%1144=427%:%
%:%1145=427%:%
%:%1146=428%:%
%:%1152=428%:%
%:%1155=429%:%
%:%1156=430%:%
%:%1164=433%:%
%:%1176=435%:%
%:%1180=436%:%
%:%1181=437%:%
%:%1182=438%:%
%:%1183=439%:%
%:%1184=440%:%
%:%1185=441%:%
%:%1186=442%:%
%:%1187=443%:%
%:%1189=444%:%
%:%1190=444%:%
%:%1191=445%:%
%:%1192=446%:%
%:%1199=447%:%
%:%1200=447%:%
%:%1201=448%:%
%:%1202=448%:%
%:%1203=449%:%
%:%1204=449%:%
%:%1205=450%:%
%:%1206=450%:%
%:%1207=450%:%
%:%1208=451%:%
%:%1209=451%:%
%:%1210=451%:%
%:%1211=452%:%
%:%1212=452%:%
%:%1213=452%:%
%:%1214=453%:%
%:%1215=453%:%
%:%1216=454%:%
%:%1217=454%:%
%:%1218=455%:%
%:%1219=455%:%
%:%1220=455%:%
%:%1221=456%:%
%:%1222=456%:%
%:%1223=456%:%
%:%1224=457%:%
%:%1225=457%:%
%:%1226=457%:%
%:%1227=457%:%
%:%1228=458%:%
%:%1229=458%:%
%:%1230=458%:%
%:%1231=459%:%
%:%1232=459%:%
%:%1233=459%:%
%:%1234=459%:%
%:%1235=460%:%
%:%1236=460%:%
%:%1237=460%:%
%:%1238=460%:%
%:%1239=460%:%
%:%1240=461%:%
%:%1241=461%:%
%:%1242=462%:%
%:%1243=462%:%
%:%1244=462%:%
%:%1245=463%:%
%:%1246=463%:%
%:%1247=464%:%
%:%1257=466%:%
%:%1258=467%:%
%:%1259=468%:%
%:%1261=469%:%
%:%1262=469%:%
%:%1263=470%:%
%:%1264=471%:%
%:%1271=472%:%
%:%1272=472%:%
%:%1273=472%:%
%:%1274=473%:%
%:%1275=473%:%
%:%1276=473%:%
%:%1277=474%:%
%:%1278=474%:%
%:%1279=475%:%
%:%1280=475%:%
%:%1281=476%:%
%:%1282=476%:%
%:%1283=477%:%
%:%1284=477%:%
%:%1285=478%:%
%:%1286=478%:%
%:%1287=479%:%
%:%1288=479%:%
%:%1289=480%:%
%:%1290=480%:%
%:%1291=480%:%
%:%1292=481%:%
%:%1293=481%:%
%:%1294=482%:%
%:%1295=482%:%
%:%1296=482%:%
%:%1297=482%:%
%:%1298=482%:%
%:%1299=483%:%
%:%1300=483%:%
%:%1301=483%:%
%:%1302=484%:%
%:%1303=484%:%
%:%1304=484%:%
%:%1305=485%:%
%:%1306=485%:%
%:%1307=486%:%
%:%1317=488%:%
%:%1319=489%:%
%:%1320=489%:%
%:%1321=490%:%
%:%1322=491%:%
%:%1323=492%:%
%:%1330=493%:%
%:%1331=493%:%
%:%1332=494%:%
%:%1333=494%:%
%:%1334=494%:%
%:%1335=495%:%
%:%1336=495%:%
%:%1337=495%:%
%:%1338=496%:%
%:%1339=496%:%
%:%1340=496%:%
%:%1341=496%:%
%:%1342=497%:%
%:%1343=497%:%
%:%1344=497%:%
%:%1345=498%:%
%:%1346=498%:%
%:%1347=498%:%
%:%1348=498%:%
%:%1349=499%:%
%:%1355=499%:%
%:%1360=500%:%
%:%1365=501%:%
